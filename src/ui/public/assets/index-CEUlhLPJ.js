import{d as Ts,r as c,o as $t,a as Vs,E as o,l as fa,c as de,b as pt,w as Ye,e as $,f,n as dt,g as A,h as e,t as B,i as t,u as l,j as pa,k as a,m as Y,p as Mt,F as be,q as Be,s as ge,v as bt,x as rs,y as Ht,z as ma,A as ks,B as Ge,C as w,D as Jt,G as Xe,H as xs,I as is,J as Ls,K as zs,L as Bs,M as ft,N as nt,O as va,P as cs,Q as Dt,R as Fs,S as _t,T as $s,U as ga,V as Pt,W as Me,X as qe,Y as wt,Z as us,_ as xt,$ as ha,a0 as bs,a1 as ds,a2 as ya,a3 as as,a4 as ls,a5 as It,a6 as Nt,a7 as fs,a8 as Ds,a9 as _a,aa as wa,ab as Rs,ac as ka,ad as js,ae as Gs,af as $a,ag as ba,ah as Ca,ai as Os,aj as zt,ak as ut,al as Sa,am as Ta,an as Va,ao as xa,ap as La,aq as za,ar as Ba,as as Fa,at as Da,au as Ra,av as ja,aw as Bt,ax as Ga,ay as Oa,az as Ua,aA as Cs,aB as Ss,aC as Aa,aD as Ae,aE as Pa,aF as Ea}from"./vendor-BHXhVXkb.js";(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const y of document.querySelectorAll('link[rel="modulepreload"]'))p(y);new MutationObserver(y=>{for(const G of y)if(G.type==="childList")for(const R of G.addedNodes)R.tagName==="LINK"&&R.rel==="modulepreload"&&p(R)}).observe(document,{childList:!0,subtree:!0});function m(y){const G={};return y.integrity&&(G.integrity=y.integrity),y.referrerPolicy&&(G.referrerPolicy=y.referrerPolicy),y.crossOrigin==="use-credentials"?G.credentials="include":y.crossOrigin==="anonymous"?G.credentials="omit":G.credentials="same-origin",G}function p(y){if(y.ep)return;y.ep=!0;const G=m(y);fetch(y.href,G)}})();const os=800;function Ma(){const te="3001";return console.log(`ä»ç¯å¢ƒå˜é‡è¯»å–åç«¯ç«¯å£: ${te}`),parseInt(te,10)}const Ia=Ma(),kt=Ts("git",()=>{const te=c(""),i=c([]),m=c(""),p=c(""),y=c(!1),G=c(!1),R=c(!1),P=c(0),E=c(""),M=c(!1),U=c(!1),I=c(!1),ie=c(!1),O=c(!1),ne=c(0),ue=c(0),ce=c(!1),S=c(""),D=c(0),F=c(0),X=c(!0),j=c(null),Z=c(""),he=c(""),fe=c([]),V=c({staged:[],unstaged:[],untracked:[]}),T=c([]),se=c(!1),K=c(!1),Q=c(!1),le=c(!1),ye=c(!1),Te=c([]),h=c(!1),g=c(!1),ae=c(!1),W=c(!1);function oe(){te.value="",i.value=[],m.value="",p.value="",y.value=!1,G.value=!1,R.value=!1,P.value=0,ne.value=0,ue.value=0,ce.value=!1,S.value="",D.value=0,F.value=0,U.value=!1,I.value=!1,ie.value=!1,O.value=!1,E.value="",M.value=!1,fe.value=[],V.value={staged:[],unstaged:[],untracked:[]},T.value=[],se.value=!1,K.value=!1,Q.value=!1,le.value=!1,ye.value=!1}async function ee(u=!1,d=!1){if(!R.value)return;const z=Date.now();if(!u&&!d&&z-D.value<3e4){console.log("ä½¿ç”¨ç¼“å­˜çš„åˆ†æ”¯çŠ¶æ€");return}try{console.log("è·å–åˆ†æ”¯çŠ¶æ€...");let C="/api/branch-status";const ve=[];u&&ve.push("force=true"),d&&ve.push("countOnly=true"),ve.length>0&&(C+="?"+ve.join("&"));const Je=await(await fetch(C)).json();Je&&(ne.value=Je.ahead||0,ue.value=Je.behind||0,ce.value=Je.hasUpstream||!1,S.value=Je.upstreamBranch||"",D.value=z,console.log(`åˆ†æ”¯çŠ¶æ€æ›´æ–°ï¼šé¢†å…ˆ ${ne.value} ä¸ªæäº¤ï¼Œè½å ${ue.value} ä¸ªæäº¤ï¼Œä¸Šæ¸¸åˆ†æ”¯ï¼š${ce.value?S.value:"æ— "}`))}catch(C){console.error("è·å–åˆ†æ”¯çŠ¶æ€å¤±è´¥:",C),ne.value=0,ue.value=0,ce.value=!1,S.value=""}}async function Ce(){const u=Date.now();if(u-P.value<1e3)return console.log("ä½¿ç”¨ç¼“å­˜çš„Gitä»“åº“çŠ¶æ€:",R.value?"æ˜¯":"ä¸æ˜¯"),R.value;try{const z=await(await fetch("/api/current_directory")).json();return R.value=z.isGitRepo===!0,P.value=u,console.log(`å½“å‰ç›®å½•${R.value?"æ˜¯":"ä¸æ˜¯"}Gitä»“åº“`),R.value}catch(d){return console.error("æ£€æŸ¥Gitä»“åº“çŠ¶æ€å¤±è´¥:",d),R.value=!1,P.value=u,!1}}async function Fe(u=!1){try{const C=await(await fetch(u?"/api/branch?force=true":"/api/branch")).json();C.branch&&(te.value=C.branch,console.log(`å½“å‰åˆ†æ”¯æ›´æ–°ä¸º: ${C.branch}${u?" (å¼ºåˆ¶åˆ·æ–°)":""}`))}catch(d){console.error("è·å–åˆ†æ”¯ä¿¡æ¯å¤±è´¥:",d)}}async function De(){if(R.value)try{console.log("è·å–æ‰€æœ‰åˆ†æ”¯...");const d=await(await fetch("/api/branches")).json();d.branches&&Array.isArray(d.branches)&&(i.value=d.branches,F.value=Date.now(),console.log(`è·å–åˆ°${d.branches.length}ä¸ªåˆ†æ”¯`))}catch(u){console.error("è·å–æ‰€æœ‰åˆ†æ”¯ä¿¡æ¯å¤±è´¥:",u)}}async function _(u){console.log("åˆ‡æ¢åˆ°åˆ†æ”¯:",u);try{y.value=!0;const z=await(await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch:u})})).json();return z.success?(o({message:`å·²åˆ‡æ¢åˆ°åˆ†æ”¯: ${u}`,type:"success"}),await Fe(!0),await ee(!0),!0):(o({message:`åˆ‡æ¢åˆ†æ”¯å¤±è´¥: ${z.error}`,type:"error"}),!1)}catch(d){return o({message:`åˆ‡æ¢åˆ†æ”¯å¤±è´¥: ${d.message}`,type:"error"}),!1}finally{y.value=!1}}async function pe(){try{const d=await(await fetch("/api/user-info")).json();d.name&&d.email&&(m.value=d.name,p.value=d.email)}catch(u){console.error("è·å–ç”¨æˆ·ä¿¡æ¯å¤±è´¥:",u)}}async function Se(u,d){if(!u.trim())return o({message:"åˆ†æ”¯åç§°ä¸èƒ½ä¸ºç©º",type:"warning"}),!1;try{G.value=!0;const C=await(await fetch("/api/create-branch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newBranchName:u,baseBranch:d||te.value})})).json();return C.success?(o({message:`å·²åˆ›å»ºå¹¶åˆ‡æ¢åˆ°åˆ†æ”¯: ${u}`,type:"success"}),await Fe(!0),await ee(!0),await De(),!0):(o({message:`åˆ›å»ºåˆ†æ”¯å¤±è´¥: ${C.error}`,type:"error"}),!1)}catch(z){return o({message:`åˆ›å»ºåˆ†æ”¯å¤±è´¥: ${z.message}`,type:"error"}),!1}finally{G.value=!1}}async function Le(){try{const d=await(await fetch("/api/clear-user-config",{method:"POST"})).json();return d.success?(m.value="",p.value="",o({message:"å·²æ¸…é™¤Gitç”¨æˆ·é…ç½®",type:"success"}),!0):(o({message:`æ¸…é™¤é…ç½®å¤±è´¥: ${d.error}`,type:"error"}),!1)}catch(u){return o({message:`æ¸…é™¤é…ç½®å¤±è´¥: ${u.message}`,type:"error"}),!1}}async function ze(u,d){try{const C=await(await fetch("/api/restore-user-config",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:u,email:d})})).json();return C.success?(m.value=u,p.value=d,o({message:"å·²æ¢å¤Gitç”¨æˆ·é…ç½®",type:"success"}),!0):(o({message:`æ¢å¤é…ç½®å¤±è´¥: ${C.error}`,type:"error"}),!1)}catch(z){return o({message:`æ¢å¤é…ç½®å¤±è´¥: ${z.message}`,type:"error"}),!1}}async function Ke(){if(!R.value)return o({message:"å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“",type:"warning"}),!1;try{I.value=!0;const d=await(await fetch("/api/pull",{method:"POST"})).json();return d.success?(o({message:"æ‹‰å–æˆåŠŸ",type:"success"}),await ee(),!0):(d.needsMerge?o({message:`éœ€è¦åˆå¹¶æ›´æ”¹: ${d.pullOutput||"å­˜åœ¨å†²çªéœ€è¦æ‰‹åŠ¨è§£å†³"}`,type:"warning",duration:5e3}):o({message:`æ‹‰å–å¤±è´¥: ${d.error}`,type:"error"}),!1)}catch(u){return o({message:`æ‹‰å–å¤±è´¥: ${u.message}`,type:"error"}),!1}finally{I.value=!1}}async function Ze(){if(!R.value)return o({message:"å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“",type:"warning"}),!1;try{ie.value=!0;const d=await(await fetch("/api/fetch-all",{method:"POST"})).json();return d.success?(o({message:"è·å–æ‰€æœ‰è¿œç¨‹åˆ†æ”¯ä¿¡æ¯æˆåŠŸ",type:"success"}),await ee(),!0):(o({message:`è·å–è¿œç¨‹åˆ†æ”¯ä¿¡æ¯å¤±è´¥: ${d.error}`,type:"error"}),!1)}catch(u){return o({message:`è·å–è¿œç¨‹åˆ†æ”¯ä¿¡æ¯å¤±è´¥: ${u.message}`,type:"error"}),!1}finally{ie.value=!1}}function Pe(){j.value&&j.value.disconnect();try{const u=`http://localhost:${Ia}`;if(console.log("å°è¯•è¿æ¥Socket.IOæœåŠ¡å™¨:",u),j.value=fa(u,{reconnectionDelayMax:1e4,reconnection:!0,reconnectionAttempts:10,reconnectionDelay:1e3,timeout:2e4,autoConnect:!0,forceNew:!0,transports:["websocket","polling"]}),!j.value){console.error("Socket.IOåˆå§‹åŒ–å¤±è´¥: socketä¸ºnull");return}console.log("Socket.IOåˆå§‹åŒ–æˆåŠŸï¼Œsocket ID:",j.value.id||"æœªè¿æ¥"),j.value.on("connect",()=>{console.log("æˆåŠŸè¿æ¥åˆ°Socket.IOæœåŠ¡å™¨"),X.value&&j.value&&j.value.emit("start_monitoring")}),j.value.on("project_info",d=>{Z.value=d.projectPath,he.value=d.projectRoomId,console.log(`å½“å‰é¡¹ç›®: ${d.projectPath}`),console.log(`æˆ¿é—´ID: ${d.projectRoomId}`)}),j.value.on("project_changed",d=>{console.log(`é¡¹ç›®å·²åˆ‡æ¢: ${d.oldProjectPath} -> ${d.newProjectPath}`),Z.value=d.newProjectPath,he.value=d.newProjectRoomId,j.value&&j.value.emit("join_room",d.newProjectRoomId),console.log(`å·²åŠ å…¥æ–°é¡¹ç›®æˆ¿é—´: ${d.newProjectRoomId}`)}),j.value.on("disconnect",d=>{console.log("ä¸Socket.IOæœåŠ¡å™¨æ–­å¼€è¿æ¥:",d)}),j.value.on("git_status_update",d=>{if(X.value){if(d.projectPath&&Z.value&&d.projectPath!==Z.value){console.log(`å¿½ç•¥ä¸åŒé¡¹ç›®çš„çŠ¶æ€æ›´æ–°: ${d.projectPath}`);return}console.log("æ”¶åˆ°GitçŠ¶æ€æ›´æ–°é€šçŸ¥:",new Date().toLocaleTimeString()),d.porcelain!==void 0&&L(d.porcelain)}}),j.value.on("monitoring_status",d=>{console.log("æ–‡ä»¶ç›‘æ§çŠ¶æ€:",d.active?"å·²å¯åŠ¨":"å·²åœæ­¢")}),j.value.on("connect_error",d=>{console.error("Socketè¿æ¥é”™è¯¯:",d.message)}),j.value.on("connect_timeout",()=>{console.error("Socketè¿æ¥è¶…æ—¶")}),j.value.on("reconnect",d=>{var z;console.log(`Socketé‡è¿æˆåŠŸï¼Œå°è¯•æ¬¡æ•°: ${d}`),X.value&&(console.log("é‡è¿åé‡æ–°å‘é€start_monitoringè¯·æ±‚"),(z=j.value)==null||z.emit("start_monitoring"))}),j.value.on("reconnect_attempt",d=>{console.log(`Socketå°è¯•é‡è¿ï¼Œç¬¬ ${d} æ¬¡å°è¯•`)}),j.value.on("reconnect_error",d=>{console.error("Socketé‡è¿é”™è¯¯:",d.message)}),j.value.on("reconnect_failed",()=>{console.error("Socketé‡è¿å¤±è´¥ï¼Œå·²è¾¾åˆ°æœ€å¤§é‡è¯•æ¬¡æ•°")}),j.value&&!j.value.connected&&(console.log("Socketæœªè¿æ¥ï¼Œå°è¯•æ‰‹åŠ¨è¿æ¥..."),j.value.connect())}catch(u){console.error("Socket.IOè¿æ¥åˆå§‹åŒ–å¤±è´¥:",u)}}function Qe(){if(console.log("toggleAutoUpdateè°ƒç”¨ï¼Œå½“å‰å€¼:",X.value),!j.value){console.error("æ— æ³•åˆ‡æ¢è‡ªåŠ¨æ›´æ–°çŠ¶æ€: socketè¿æ¥ä¸å­˜åœ¨"),o.error("æ— æ³•è¿æ¥åˆ°æœåŠ¡å™¨ï¼Œè‡ªåŠ¨æ›´æ–°å¯èƒ½ä¸ä¼šç”Ÿæ•ˆ"),console.log("å°è¯•é‡æ–°å»ºç«‹socketè¿æ¥..."),Pe(),localStorage.setItem("zen-gitsync-auto-update",X.value.toString());return}try{X.value?(console.log("å‘é€start_monitoringå‘½ä»¤..."),j.value.emit("start_monitoring"),o.success("è‡ªåŠ¨æ›´æ–°å·²å¯ç”¨")):(console.log("å‘é€stop_monitoringå‘½ä»¤..."),j.value.emit("stop_monitoring"),o.info("è‡ªåŠ¨æ›´æ–°å·²ç¦ç”¨")),localStorage.setItem("zen-gitsync-auto-update",X.value.toString()),console.log("å·²ä¿å­˜è‡ªåŠ¨æ›´æ–°è®¾ç½®åˆ°æœ¬åœ°å­˜å‚¨:",X.value)}catch(u){console.error("åˆ‡æ¢è‡ªåŠ¨æ›´æ–°çŠ¶æ€æ—¶å‡ºé”™:",u),o.error(`åˆ‡æ¢è‡ªåŠ¨æ›´æ–°å¤±è´¥: ${u.message}`)}}function L(u){if(u===void 0||u===""){T.value=[];return}const d=u.split(`
`),z=[];for(const C of d){const ve=C.match(/^([ MADRCU\?]{2})\s+(.+)$/);if(ve){let Ee="";const Je=ve[1],tt=Je.charAt(0),Rt=Je.charAt(1);tt==="A"||tt==="M"||tt==="D"||tt==="R"?Ee="added":tt===" "&&Rt==="M"?Ee="modified":tt===" "&&Rt==="D"?Ee="deleted":Je==="??"?Ee="untracked":Ee="other",z.push({path:ve[2],type:Ee})}}T.value=z}async function r(u=!0){if(!R.value){console.log("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“ï¼Œè·³è¿‡åŠ è½½æäº¤å†å²");return}try{se.value=!0,console.log("å¼€å§‹åŠ è½½æäº¤å†å²...");const d=new Date().getTime(),C=await(await fetch(`/api/log?page=1&_t=${d}`)).json();C&&C.data&&Array.isArray(C.data)?(fe.value=[...C.data],console.log(`æäº¤å†å²åŠ è½½å®Œæˆï¼Œå…± ${fe.value.length} æ¡è®°å½•`)):(console.warn("APIè¿”å›çš„æäº¤å†å²æ ¼å¼ä¸æ­£ç¡®:",C),fe.value=[])}catch(d){console.error("è·å–æäº¤å†å²å¤±è´¥:",d),u&&o({message:`è·å–æäº¤å†å²å¤±è´¥: ${d.message}`,type:"error"})}finally{se.value=!1}}async function N(){if(!R.value){console.log("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“ï¼Œè·³è¿‡åŠ è½½GitçŠ¶æ€");return}try{K.value=!0,await H()}catch(u){console.error("è·å–GitçŠ¶æ€å¤±è´¥:",u),o({message:`è·å–GitçŠ¶æ€å¤±è´¥: ${u.message}`,type:"error"})}finally{K.value=!1}}async function H(){if(console.log("å¼€å§‹è·å–GitçŠ¶æ€(porcelainæ ¼å¼)..."),!R.value){console.log("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“ï¼Œè·³è¿‡åŠ è½½GitçŠ¶æ€");return}try{const d=await(await fetch("/api/status_porcelain")).json();d.status!==void 0?L(d.status):T.value=[]}catch(u){console.error("è·å–GitçŠ¶æ€(porcelain)å¤±è´¥:",u),o({message:`è·å–GitçŠ¶æ€(porcelain)å¤±è´¥: ${u.message}`,type:"error"}),T.value=[]}}async function $e(){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{Q.value=!0;const d=await(await fetch("/api/add",{method:"POST"})).json();return d.success?(o({message:"æ–‡ä»¶å·²æ·»åŠ åˆ°æš‚å­˜åŒº",type:"success"}),!0):(o({message:`æ·»åŠ æ–‡ä»¶å¤±è´¥: ${d.error}`,type:"error"}),!1)}catch(u){return o({message:`æ·»åŠ æ–‡ä»¶å¤±è´¥: ${u.message}`,type:"error"}),!1}finally{Q.value=!1}}async function Re(u){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{Q.value=!0;const z=await(await fetch("/api/add-file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:u})})).json();return z.success?(o({message:"æ–‡ä»¶å·²æš‚å­˜",type:"success"}),N(),!0):(o({message:`æš‚å­˜æ–‡ä»¶å¤±è´¥: ${z.error}`,type:"error"}),!1)}catch(d){return o({message:`æš‚å­˜æ–‡ä»¶å¤±è´¥: ${d.message}`,type:"error"}),!1}finally{Q.value=!1}}async function ke(u){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{ye.value=!0;const z=await(await fetch("/api/unstage-file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:u})})).json();return z.success?(o({message:"å·²å–æ¶ˆæš‚å­˜æ–‡ä»¶",type:"success"}),N(),!0):(o({message:`å–æ¶ˆæš‚å­˜å¤±è´¥: ${z.error}`,type:"error"}),!1)}catch(d){return o({message:`å–æ¶ˆæš‚å­˜å¤±è´¥: ${d.message}`,type:"error"}),!1}finally{ye.value=!1}}function _e(u){return new Promise(d=>setTimeout(d,u))}async function je(u,d=!1){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{le.value=!0;const C=await(await fetch("/api/commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:u,hasNewlines:u.includes(`
`),noVerify:d})})).json();return C.success?(o({message:"æäº¤æˆåŠŸ",type:"success"}),!0):(o({message:`commitChanges æäº¤å¤±è´¥: ${C.error}`,type:"error"}),!1)}catch(z){return o({message:`æäº¤å¤±è´¥: ${z.message}`,type:"error"}),!1}finally{le.value=!1}}async function re(){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{U.value=!0;const d=await(await fetch("/api/push",{method:"POST"})).json();return d.success?(o({message:"æ¨é€æˆåŠŸ",type:"success"}),ne.value=0,ue.value=0,await Promise.all([N(),r()]),console.log("æ¨é€æˆåŠŸï¼Œåˆ†æ”¯çŠ¶æ€å·²è®¾ç½®ä¸ºåŒæ­¥ (ahead=0, behind=0)"),!0):(o({message:`æ¨é€å¤±è´¥: ${d.error}`,type:"error"}),!1)}catch(u){return o({message:`æ¨é€å¤±è´¥: ${u.message}`,type:"error"}),!1}finally{U.value=!1}}async function me(u,d={}){if(!R.value)return o({message:"å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“",type:"warning"}),!1;if(!u)return o({message:"è¯·é€‰æ‹©è¦åˆå¹¶çš„åˆ†æ”¯",type:"warning"}),!1;if(u===te.value)return o({message:"ä¸èƒ½åˆå¹¶å½“å‰åˆ†æ”¯åˆ°è‡ªèº«",type:"warning"}),!1;try{O.value=!0;const z=await fetch("/api/merge",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch:u,...d})}),C=await z.json();return z.status===409?(o({message:"åˆå¹¶åˆ†æ”¯æ—¶å‘ç”Ÿå†²çªï¼Œè¯·æ‰‹åŠ¨è§£å†³",type:"warning",duration:5e3}),!1):C.success?(o({message:`æˆåŠŸåˆå¹¶åˆ†æ”¯ ${u} åˆ° ${te.value}`,type:"success"}),await N(),await ee(),!0):(o({message:`åˆå¹¶åˆ†æ”¯å¤±è´¥: ${C.error}`,type:"error"}),!1)}catch(z){return o({message:`åˆå¹¶åˆ†æ”¯å¤±è´¥: ${z.message}`,type:"error"}),!1}finally{O.value=!1}}async function Ne(u,d=!1){if(console.log("å¼€å§‹æš‚å­˜å¹¶æäº¤æ“ä½œ..."),!await $e())return!1;console.log("æš‚å­˜å®Œæˆï¼Œç­‰å¾…Gitæ“ä½œå®Œæˆ..."),await _e(os),console.log("å¼€å§‹æäº¤æ›´æ”¹...");const C=await je(u,d);return console.log("æš‚å­˜å¹¶æäº¤æ“ä½œå®Œæˆ"),C}async function He(u,d=!1){try{if(console.log("å¼€å§‹æš‚å­˜æ–‡ä»¶..."),!await $e()||(console.log("æš‚å­˜å®Œæˆï¼Œç­‰å¾…Gitæ“ä½œå®Œæˆ..."),await _e(os),console.log("å¼€å§‹æäº¤æ›´æ”¹..."),!await je(u,d)))return!1;console.log("æäº¤å®Œæˆï¼Œç­‰å¾…Gitæ“ä½œå®Œæˆ..."),await _e(os),console.log("å¼€å§‹æ¨é€åˆ°è¿œç¨‹...");const ve=await re();return console.log("ä¸€é”®æ¨é€æ“ä½œå®Œæˆï¼ŒçŠ¶æ€å·²ç»Ÿä¸€åˆ·æ–°"),ve}catch(z){console.error("ä¸€é”®æ¨é€æ“ä½œå¤±è´¥:",z);try{(await(await fetch("/api/remove-lock",{method:"POST"})).json()).success&&o({message:"æ£€æµ‹åˆ°Gité”å®šæ–‡ä»¶å†²çªï¼Œå·²è‡ªåŠ¨æ¸…ç†ï¼Œè¯·é‡è¯•æ“ä½œ",type:"warning"})}catch(C){console.error("æ¸…ç†é”å®šæ–‡ä»¶å¤±è´¥:",C)}o({message:`æ“ä½œå¤±è´¥: ${z.message}`,type:"error"});try{await Promise.all([N(),r(),ee()])}catch(C){console.error("åˆ·æ–°çŠ¶æ€å¤±è´¥:",C)}return!1}}async function q(){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{ye.value=!0;const d=await(await fetch("/api/reset-head",{method:"POST"})).json();return d.success?(o({message:"å·²é‡ç½®æš‚å­˜åŒº",type:"success"}),N(),!0):(o({message:`é‡ç½®æš‚å­˜åŒºå¤±è´¥: ${d.error}`,type:"error"}),!1)}catch(u){return o({message:`é‡ç½®æš‚å­˜åŒºå¤±è´¥: ${u.message}`,type:"error"}),!1}finally{ye.value=!1}}async function Oe(u){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{ye.value=!0;const z=await(await fetch("/api/reset-to-remote",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch:u})})).json();return z.success?(o({message:`å·²é‡ç½®åˆ†æ”¯ ${u} åˆ°è¿œç¨‹çŠ¶æ€`,type:"success"}),N(),r(),!0):(o({message:`é‡ç½®åˆ†æ”¯å¤±è´¥: ${z.error}`,type:"error"}),!1)}catch(d){return o({message:`é‡ç½®åˆ†æ”¯å¤±è´¥: ${d.message}`,type:"error"}),!1}finally{ye.value=!1}}async function vt(){if(R.value)try{M.value=!0,console.log("è·å–è¿œç¨‹ä»“åº“åœ°å€...");const d=await(await fetch("/api/remote-url")).json();d.success?(E.value=d.url||"",console.log(`è·å–åˆ°è¿œç¨‹ä»“åº“åœ°å€: ${E.value}`)):(console.warn("è·å–è¿œç¨‹ä»“åº“åœ°å€å¤±è´¥:",d.error),E.value="")}catch(u){console.error("è·å–è¿œç¨‹ä»“åº“åœ°å€å¤±è´¥:",u),E.value=""}finally{M.value=!1}}async function Ct(){if(!E.value)return o({message:"æ²¡æœ‰å¯å¤åˆ¶çš„è¿œç¨‹ä»“åº“åœ°å€",type:"warning"}),!1;try{return await navigator.clipboard.writeText(E.value),o({message:"å·²å¤åˆ¶è¿œç¨‹ä»“åº“åœ°å€",type:"success"}),!0}catch(u){return console.error("å¤åˆ¶è¿œç¨‹ä»“åº“åœ°å€å¤±è´¥:",u),o({message:`å¤åˆ¶å¤±è´¥: ${u.message}`,type:"error"}),!1}}$t(()=>{const u=localStorage.getItem("zen-gitsync-auto-update");u!==null&&(X.value=u==="true"),Pe()});function et(){j.value&&(j.value.disconnect(),j.value=null)}Vs(()=>{et()});async function Ue(){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),[];try{h.value=!0;const d=await(await fetch("/api/stash-list")).json();return d.success?(Te.value=d.stashes,d.stashes):(o.error(`è·å–stashåˆ—è¡¨å¤±è´¥: ${d.error}`),[])}catch(u){return console.error("è·å–stashåˆ—è¡¨å¤±è´¥:",u),o.error(`è·å–stashåˆ—è¡¨å¤±è´¥: ${u.message}`),[]}finally{h.value=!1}}async function St(u,d=!1,z=!0){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{W.value=!0;const ve=await(await fetch("/api/stash-save",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:u,includeUntracked:d,excludeLocked:z})})).json();return ve.success?(o.success(ve.message),await Ue(),await N(),!0):(o.warning(ve.message),!1)}catch(C){return console.error("ä¿å­˜stashå¤±è´¥:",C),o.error(`ä¿å­˜stashå¤±è´¥: ${C.message}`),!1}finally{W.value=!1}}async function k(u,d=!1){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{g.value=!0;const z=await fetch("/api/stash-apply",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({stashId:u,pop:d})}),C=await z.json();return z.status===409?(o.warning("åº”ç”¨stashæ—¶å‘ç”Ÿå†²çªï¼Œè¯·æ‰‹åŠ¨è§£å†³"),!1):C.success?(o.success(C.message),await Ue(),await N(),!0):(o.error(`åº”ç”¨stashå¤±è´¥: ${C.error}`),!1)}catch(z){return console.error("åº”ç”¨stashå¤±è´¥:",z),o.error(`åº”ç”¨stashå¤±è´¥: ${z.message}`),!1}finally{g.value=!1}}async function v(u){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{ae.value=!0;const z=await(await fetch("/api/stash-drop",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({stashId:u})})).json();return z.success?(o.success(z.message),await Ue(),!0):(o.error(`åˆ é™¤stashå¤±è´¥: ${z.error}`),!1)}catch(d){return console.error("åˆ é™¤stashå¤±è´¥:",d),o.error(`åˆ é™¤stashå¤±è´¥: ${d.message}`),!1}finally{ae.value=!1}}async function J(){if(!R.value)return o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“"),!1;try{ae.value=!0;const d=await(await fetch("/api/stash-clear",{method:"POST"})).json();return d.success?(o.success(d.message),Te.value=[],!0):(o.error(`æ¸…ç©ºstashå¤±è´¥: ${d.error}`),!1)}catch(u){return console.error("æ¸…ç©ºstashå¤±è´¥:",u),o.error(`æ¸…ç©ºstashå¤±è´¥: ${u.message}`),!1}finally{ae.value=!1}}return{currentBranch:te,allBranches:i,userName:m,userEmail:p,isChangingBranch:y,isCreatingBranch:G,isGitRepo:R,lastCheckedTime:P,branchAhead:ne,branchBehind:ue,hasUpstream:ce,upstreamBranch:S,lastBranchStatusTime:D,lastBranchesTime:F,remoteUrl:E,isLoadingRemoteUrl:M,stashes:Te,isLoadingStashes:h,isApplyingStash:g,isDroppingStash:ae,isSavingStash:W,log:fe,status:V,fileList:T,isLoadingLog:se,isLoadingStatus:K,isAddingFiles:Q,isCommiting:le,isResetting:ye,autoUpdateEnabled:X,isPushing:U,isGitPulling:I,isGitFetching:ie,isGitMerging:O,$reset:oe,checkGitRepo:Ce,getCurrentBranch:Fe,getAllBranches:De,changeBranch:_,getUserInfo:pe,createBranch:Se,clearUserConfig:Le,restoreUserConfig:ze,getBranchStatus:ee,gitPull:Ke,gitFetchAll:Ze,initSocketConnection:Pe,toggleAutoUpdate:Qe,parseStatusPorcelain:L,fetchLog:r,fetchStatus:N,fetchStatusPorcelain:H,addToStage:$e,addFileToStage:Re,unstageFile:ke,commitChanges:je,pushToRemote:re,addAndCommit:Ne,addCommitAndPush:He,resetHead:q,resetToRemote:Oe,getRemoteUrl:vt,copyRemoteUrl:Ct,mergeBranch:me,getStashList:Ue,saveStash:St,applyStash:k,dropStash:v,clearAllStashes:J,socket:j,disconnectSocket:et}}),ps=Ts("config",()=>{const te=c(""),i=c([]),m=c([]),p=c([]),y=c([]),G=c(!1),R=c(!1),P=de(()=>({defaultCommitMessage:te.value,descriptionTemplates:i.value,scopeTemplates:m.value,messageTemplates:p.value,lockedFiles:y.value}));async function E(S=!1){if(!S&&R.value&&!G.value)return console.log("ä½¿ç”¨ç¼“å­˜çš„é…ç½®ä¿¡æ¯"),P.value;try{G.value=!0,console.log("åŠ è½½é…ç½®ä¿¡æ¯...");const F=await(await fetch("/api/config/getConfig")).json();return te.value=F.defaultCommitMessage||"",i.value=F.descriptionTemplates||[],m.value=F.scopeTemplates||[],p.value=F.messageTemplates||[],y.value=F.lockedFiles||[],R.value=!0,console.log("é…ç½®ä¿¡æ¯åŠ è½½å®Œæˆ"),P.value}catch(D){return console.error("åŠ è½½é…ç½®å¤±è´¥:",D),o.error(`åŠ è½½é…ç½®å¤±è´¥: ${D.message}`),null}finally{G.value=!1}}async function M(S){try{const F=await(await fetch("/api/config/saveDefaultMessage",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({defaultCommitMessage:S})})).json();return F.success?(te.value=S,o.success("é»˜è®¤æäº¤ä¿¡æ¯å·²ä¿å­˜"),!0):(o.error(`ä¿å­˜å¤±è´¥: ${F.error}`),!1)}catch(D){return o.error(`ä¿å­˜å¤±è´¥: ${D.message}`),!1}}async function U(S,D){try{const X=await(await fetch("/api/config/save-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:S,type:D})})).json();return X.success?(D==="description"?i.value.includes(S)||i.value.push(S):D==="scope"?m.value.includes(S)||m.value.push(S):D==="message"&&(p.value.includes(S)||p.value.push(S)),o.success("æ¨¡æ¿å·²ä¿å­˜"),!0):(o.error(`ä¿å­˜æ¨¡æ¿å¤±è´¥: ${X.error}`),!1)}catch(F){return o.error(`ä¿å­˜æ¨¡æ¿å¤±è´¥: ${F.message}`),!1}}async function I(S,D){try{const X=await(await fetch("/api/config/delete-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:S,type:D})})).json();return X.success?(D==="description"?i.value=i.value.filter(j=>j!==S):D==="scope"?m.value=m.value.filter(j=>j!==S):D==="message"&&(p.value=p.value.filter(j=>j!==S)),o.success("æ¨¡æ¿å·²åˆ é™¤"),!0):(o.error(`åˆ é™¤æ¨¡æ¿å¤±è´¥: ${X.error}`),!1)}catch(F){return o.error(`åˆ é™¤æ¨¡æ¿å¤±è´¥: ${F.message}`),!1}}async function ie(S,D,F){try{const j=await(await fetch("/api/config/update-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldTemplate:S,newTemplate:D,type:F})})).json();if(j.success){if(F==="description"){const Z=i.value.indexOf(S);Z!==-1&&(i.value[Z]=D)}else if(F==="scope"){const Z=m.value.indexOf(S);Z!==-1&&(m.value[Z]=D)}else if(F==="message"){const Z=p.value.indexOf(S);Z!==-1&&(p.value[Z]=D)}return o.success("æ¨¡æ¿å·²æ›´æ–°"),!0}else return o.error(`æ›´æ–°æ¨¡æ¿å¤±è´¥: ${j.error}`),!1}catch(X){return o.error(`æ›´æ–°æ¨¡æ¿å¤±è´¥: ${X.message}`),!1}}async function O(){try{const D=await(await fetch("/api/locked-files")).json();return D.success?(y.value=D.lockedFiles||[],D.lockedFiles):(o.error(`åŠ è½½é”å®šæ–‡ä»¶åˆ—è¡¨å¤±è´¥: ${D.error}`),[])}catch(S){return console.error("åŠ è½½é”å®šæ–‡ä»¶åˆ—è¡¨å¤±è´¥:",S),o.error(`åŠ è½½é”å®šæ–‡ä»¶åˆ—è¡¨å¤±è´¥: ${S.message}`),[]}}async function ne(S){try{const F=await(await fetch("/api/lock-file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:S})})).json();return F.success?(await O(),o.success(`æ–‡ä»¶å·²é”å®š: ${S}`),!0):(o.error(`é”å®šæ–‡ä»¶å¤±è´¥: ${F.error}`),!1)}catch(D){return console.error("é”å®šæ–‡ä»¶å¤±è´¥:",D),o.error(`é”å®šæ–‡ä»¶å¤±è´¥: ${D.message}`),!1}}async function ue(S){try{const F=await(await fetch("/api/unlock-file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:S})})).json();return F.success?(await O(),o.success(`æ–‡ä»¶å·²è§£é”: ${S}`),!0):(o.error(`è§£é”æ–‡ä»¶å¤±è´¥: ${F.error}`),!1)}catch(D){return console.error("è§£é”æ–‡ä»¶å¤±è´¥:",D),o.error(`è§£é”æ–‡ä»¶å¤±è´¥: ${D.message}`),!1}}async function ce(S){try{const F=await(await fetch("/api/check-file-lock",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:S})})).json();return F.success?F.isLocked:(console.error("æ£€æŸ¥æ–‡ä»¶é”å®šçŠ¶æ€å¤±è´¥:",F.error),!1)}catch(D){return console.error("æ£€æŸ¥æ–‡ä»¶é”å®šçŠ¶æ€å¤±è´¥:",D),!1}}return{defaultCommitMessage:te,descriptionTemplates:i,scopeTemplates:m,messageTemplates:p,lockedFiles:y,isLoading:G,isLoaded:R,config:P,loadConfig:E,saveDefaultMessage:M,saveTemplate:U,deleteTemplate:I,updateTemplate:ie,loadLockedFiles:O,lockFile:ne,unlockFile:ue,isFileLocked:ce}});function Na(te){return te.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function Ha(te){return te?te.split(`
`).map(m=>{const p=Na(m);return m.startsWith("diff --git")||m.startsWith("diff --cc")||m.startsWith("diff --combined")?`<div class="diff-header">${p}</div>`:m.startsWith("---")?`<div class="diff-old-file">${p}</div>`:m.startsWith("+++")?`<div class="diff-new-file">${p}</div>`:m.startsWith("@@")?`<div class="diff-hunk-header">${p}</div>`:m.startsWith("+")?`<div class="diff-added">${p}</div>`:m.startsWith("-")?`<div class="diff-removed">${p}</div>`:`<div class="diff-context">${p}</div>`}).join(""):""}function Ja(te){return te?te.trim():"(æ— æäº¤ä¿¡æ¯)"}function Wa(te){if(!te)return"";const i=/^(feat|fix|docs|style|refactor|perf|test|chore|build|ci|revert)(\([^)]+\))?\s*:\s*(.+)$/s,m=te.match(i);return m?m[3].trim():te.trim()}const qa={key:0,class:"files-panel"},Ya={class:"panel-header"},Xa={key:0,class:"file-count"},Ka={class:"files-list"},Za=["onClick"],Qa={class:"file-name"},el={class:"panel-header"},tl={key:0,class:"selected-file"},sl={class:"diff-content"},al=["innerHTML"],ll=pt({__name:"FileDiffViewer",props:{files:{},emptyText:{default:"æ²¡æœ‰æ‰¾åˆ°å˜æ›´æ–‡ä»¶"},diffContent:{default:""},selectedFile:{default:""},height:{default:"100%"},showFileList:{type:Boolean,default:!0}},emits:["file-select"],setup(te,{emit:i}){const m=te,p=i,y=c(""),G=de(()=>m.selectedFile||y.value),R=de(()=>m.files.map(M=>({...M,displayName:M.name||M.path.split("/").pop()||M.path}))),P=de(()=>m.diffContent&&m.diffContent.trim()!=="");function E(M){y.value=M,p("file-select",M)}return Ye(()=>m.selectedFile,M=>{M!==void 0&&(y.value=M)}),Ye(()=>m.files,M=>{if(M.length>0&&!G.value){const U=M[0];E(U.path)}},{immediate:!0}),(M,U)=>(f(),$("div",{class:"file-diff-viewer",style:dt({height:M.height})},[M.showFileList?(f(),$("div",qa,[e("div",Ya,[U[0]||(U[0]=e("h4",null,"å˜æ›´æ–‡ä»¶",-1)),M.files.length>0?(f(),$("span",Xa,"("+B(M.files.length)+")",1)):A("",!0)]),e("div",Ka,[t(l(pa),{height:"100%"},{default:a(()=>[M.files.length===0?(f(),Y(l(Mt),{key:0,description:M.emptyText,"image-size":60},null,8,["description"])):A("",!0),(f(!0),$(be,null,Be(R.value,I=>(f(),$("div",{key:I.path,class:ge(["file-item",{active:I.path===G.value,[`file-type-${I.type}`]:I.type}]),onClick:ie=>E(I.path)},[t(l(bt),{class:"file-icon"},{default:a(()=>[t(l(rs))]),_:1}),t(l(Ht),{content:I.path,placement:"top",disabled:I.displayName.length<=35,"hide-after":1e3,"show-after":200},{default:a(()=>[e("span",Qa,B(I.displayName),1)]),_:2},1032,["content","disabled"])],10,Za))),128))]),_:1})])])):A("",!0),e("div",{class:ge(["diff-panel",{"full-width":!M.showFileList}])},[e("div",el,[U[1]||(U[1]=e("h4",null,"æ–‡ä»¶å·®å¼‚",-1)),G.value?(f(),$("span",tl,B(G.value.split("/").pop()),1)):A("",!0)]),e("div",sl,[P.value?(f(),$("div",{key:1,class:"diff-text",innerHTML:l(Ha)(M.diffContent)},null,8,al)):(f(),Y(l(Mt),{key:0,description:G.value?"è¯¥æ–‡ä»¶æ²¡æœ‰å·®å¼‚å†…å®¹":"è¯·é€‰æ‹©æ–‡ä»¶æŸ¥çœ‹å·®å¼‚","image-size":80},null,8,["description"]))])],2)],4))}}),mt=(te,i)=>{const m=te.__vccOpts||te;for(const[p,y]of i)m[p]=y;return m},ms=mt(ll,[["__scopeId","data-v-a936d0d7"]]),ol={class:"common-dialog__footer"},nl=pt({__name:"CommonDialog",props:{modelValue:{type:Boolean},title:{},size:{default:"medium"},type:{default:"default"},width:{},height:{},top:{default:"8vh"},closeOnClickModal:{type:Boolean,default:!1},closeOnPressEscape:{type:Boolean,default:!0},destroyOnClose:{type:Boolean,default:!1},draggable:{type:Boolean,default:!1},customClass:{},appendToBody:{type:Boolean,default:!1},lockScroll:{type:Boolean,default:!0},showFooter:{type:Boolean,default:!1},confirmText:{default:"ç¡®å®š"},cancelText:{default:"å–æ¶ˆ"},showCancel:{type:Boolean,default:!0},confirmLoading:{type:Boolean,default:!1}},emits:["update:modelValue","confirm","cancel","close","opened","closed"],setup(te,{emit:i}){const m=te,p=i,y=de(()=>{if(m.width)return m.width;switch(m.size){case"small":return"30%";case"medium":return"50%";case"large":return"80%";case"extra-large":return"90%";default:return"50%"}}),G=de(()=>{if(m.height)return m.height;switch(m.type){case"full-height":return"calc(100vh - 100px)";case"flex":return"calc(100vh - 160px)";default:return"auto"}}),R=de(()=>{const O={};return(m.type==="full-height"||m.type==="flex")&&(O["--dialog-height"]=G.value),O}),P=de(()=>{const O=[];return m.customClass&&O.push(m.customClass),m.type==="flex"&&O.push("common-dialog--flex"),m.type==="full-height"&&O.push("common-dialog--full-height"),O.join(" ")});function E(){p("update:modelValue",!1),p("close")}function M(){p("confirm")}function U(){p("cancel"),E()}function I(){p("opened")}function ie(){p("closed")}return(O,ne)=>{const ue=Ge;return f(),Y(l(Jt),{"model-value":O.modelValue,title:O.title,width:y.value,top:O.top,style:dt(R.value),"close-on-click-modal":O.closeOnClickModal,"close-on-press-escape":O.closeOnPressEscape,"destroy-on-close":O.destroyOnClose,draggable:O.draggable,class:ge(P.value),"append-to-body":O.appendToBody,"lock-scroll":O.lockScroll,onClose:E,onOpened:I,onClosed:ie},ma({default:a(()=>[ks(O.$slots,"default",{},void 0,!0)]),_:2},[O.showFooter||O.$slots.footer?{name:"footer",fn:a(()=>[ks(O.$slots,"footer",{},()=>[e("div",ol,[O.showCancel?(f(),Y(ue,{key:0,onClick:U},{default:a(()=>[w(B(O.cancelText),1)]),_:1})):A("",!0),t(ue,{type:"primary",loading:O.confirmLoading,onClick:M},{default:a(()=>[w(B(O.confirmText),1)]),_:1},8,["loading"])])],!0)]),key:"0"}:void 0]),1032,["model-value","title","width","top","style","close-on-click-modal","close-on-press-escape","destroy-on-close","draggable","class","append-to-body","lock-scroll"])}}}),Ft=mt(nl,[["__scopeId","data-v-c1505473"]]),il={class:"card"},rl={class:"status-header"},cl={class:"header-actions"},ul=["element-loading-text"],dl={key:0,class:"status-box"},fl={key:1,class:"status-box-wrap"},pl={key:0,class:"branch-status-info"},ml={class:"branch-sync-status"},vl={class:"sync-status-content"},gl={class:"status-badges"},hl={class:"badge-content"},yl={class:"badge-content"},_l={key:1,class:"file-list-container"},wl={key:0,class:"file-group"},kl={class:"file-list"},$l=["onClick"],bl={class:"file-info"},Cl={class:"file-name-section"},Sl=["title"],Tl={class:"file-directory"},Vl={class:"file-actions"},xl={key:1,class:"file-group"},Ll={class:"file-list"},zl=["onClick"],Bl={class:"file-info"},Fl={class:"file-name-section"},Dl=["title"],Rl={class:"file-directory"},jl={class:"file-actions"},Gl={key:2,class:"file-group"},Ol={class:"file-list"},Ul=["onClick"],Al={class:"file-info"},Pl={class:"file-name-section"},El=["title"],Ml={class:"file-directory"},Il={class:"file-actions"},Nl={key:2,class:"empty-status"},Hl={class:"empty-icon"},Jl={class:"lock-feature-description"},Wl={class:"description-header"},ql={key:0,class:"empty-locked-files"},Yl={class:"empty-icon"},Xl={key:1,class:"locked-files-list"},Kl={class:"locked-files-header"},Zl={class:"locked-file-items"},Ql={class:"file-info"},eo={class:"file-path-container"},to={class:"file-name"},so={class:"file-directory"},ao={class:"file-actions"},lo={class:"dialog-footer"},oo=pt({__name:"GitStatus",props:{initialDirectory:{type:String,default:""}},setup(te,{expose:i}){const m=te,p=kt(),y=ps(),G=de(()=>p.isLoadingStatus),R=c(""),P=c(""),E=c(!1),M=c(!1),U=c(-1),I=de(()=>p.fileList.map(h=>({path:h.path,name:h.path.split("/").pop()||h.path,type:h.type})));async function ie(h){await F(h)}const O=c(!1),ne=c({staged:!1,unstaged:!1,untracked:!1}),ue=c(m.initialDirectory||"");async function ce(){try{if(!ue.value){const g=await(await fetch("/api/current_directory")).json();ue.value=g.directory||"æœªçŸ¥ç›®å½•"}if(!p.isGitRepo)return;await p.fetchStatus(),await p.getBranchStatus(),o({message:"Git çŠ¶æ€å·²åˆ·æ–°",type:"success"})}catch(h){o({message:"åˆ·æ–°å¤±è´¥: "+h.message,type:"error"})}}async function S(h){try{await Me.confirm(`ç¡®è®¤è§£é”è¯¥æ–‡ä»¶ï¼Ÿ
${h}`,"ç¡®è®¤è§£é”",{type:"warning",confirmButtonText:"è§£é”",cancelButtonText:"å–æ¶ˆ"}),await y.unlockFile(h)}catch{}}async function D(){if(y.lockedFiles.length)try{await Me.confirm(`ç¡®è®¤è§£é”æ‰€æœ‰å·²é”å®šæ–‡ä»¶ï¼Ÿå…± ${y.lockedFiles.length} ä¸ªã€‚`,"æ¸…ç©ºå…¨éƒ¨é”å®š",{type:"warning",confirmButtonText:"å…¨éƒ¨è§£é”",cancelButtonText:"å–æ¶ˆ"});const h=[...y.lockedFiles];await Promise.all(h.map(g=>y.unlockFile(g))),await y.loadLockedFiles(),o.success("å·²æ¸…ç©ºæ‰€æœ‰æ–‡ä»¶é”å®š")}catch{}}async function F(h){try{M.value=!0,R.value=h,U.value=p.fileList.findIndex(ae=>ae.path===h);const g=p.fileList[U.value];if(g&&g.type==="untracked")try{const W=await(await fetch(`/api/file-content?file=${encodeURIComponent(h)}`)).json();W.success&&W.content?P.value=`diff --git a/${h} b/${h}
æ–°æ–‡ä»¶: ${h}
--- /dev/null
+++ b/${h}
@@ -0,0 +1,${W.content.split(`
`).length} @@
`+W.content.split(`
`).map(oe=>`+${oe}`).join(`
`):P.value=`è¿™æ˜¯ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå°šæœªè¢«Gitè·Ÿè¸ªã€‚
æ·»åŠ åˆ°æš‚å­˜åŒºåå¯ä»¥æäº¤è¯¥æ–‡ä»¶ã€‚`}catch(ae){console.error("è·å–æœªè·Ÿè¸ªæ–‡ä»¶å†…å®¹å¤±è´¥:",ae),P.value=`è¿™æ˜¯ä¸€ä¸ªæ–°æ–‡ä»¶ï¼Œå°šæœªè¢«Gitè·Ÿè¸ªã€‚
æ·»åŠ åˆ°æš‚å­˜åŒºåå¯ä»¥æäº¤è¯¥æ–‡ä»¶ã€‚`}else if(g&&g.type==="added"){const W=await(await fetch(`/api/diff-cached?file=${encodeURIComponent(h)}`)).json();P.value=W.diff||"æ²¡æœ‰å˜æ›´"}else{const W=await(await fetch(`/api/diff?file=${encodeURIComponent(h)}`)).json();P.value=W.diff||"æ²¡æœ‰å˜æ›´"}}catch(g){o({message:"è·å–æ–‡ä»¶å·®å¼‚å¤±è´¥: "+g.message,type:"error"}),P.value="è·å–å·®å¼‚å¤±è´¥: "+g.message}finally{M.value=!1}}function X(h){if(E.value=!0,p.fileList.length>0){const g=p.fileList.find(ae=>ae.path===h.path)||p.fileList[0];F(g.path)}}async function j(h){await p.addFileToStage(h)}async function Z(h){await p.unstageFile(h)}async function he(){await fe()}async function fe(){try{if(!p.isGitRepo)return;await p.fetchStatus(),o({message:"Git æ–‡ä»¶çŠ¶æ€å·²åˆ·æ–°",type:"success"})}catch(h){o({message:"åˆ·æ–°å¤±è´¥: "+h.message,type:"error"})}}async function V(){try{await p.gitPull(),await ce()}catch(h){console.error("æ‹‰å–æ“ä½œå‘ç”Ÿé”™è¯¯:",h)}}async function T(){try{await p.gitFetchAll(),await ce()}catch(h){console.error("è·å–è¿œç¨‹åˆ†æ”¯ä¿¡æ¯æ“ä½œå‘ç”Ÿé”™è¯¯:",h)}}async function se(h){try{await Me.confirm(`ç¡®å®šè¦æ’¤å›æ–‡ä»¶ "${h}" çš„æ‰€æœ‰ä¿®æ”¹å—ï¼Ÿæ­¤æ“ä½œæ— æ³•æ’¤é”€ã€‚`,"æ’¤å›ä¿®æ”¹",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"});const ae=await(await fetch("/api/revert_file",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filePath:h})})).json();ae.success?(o.success("å·²æ’¤å›æ–‡ä»¶ä¿®æ”¹"),await ce()):o.error(ae.error?`æ’¤å›å¤±è´¥: ${ae.error}`:"æ’¤å›æ–‡ä»¶ä¿®æ”¹å¤±è´¥ï¼Œè¯·é‡è¯•")}catch(g){if(g==="cancel"||g.message==="cancel")return;const ae=g.message||"æœªçŸ¥é”™è¯¯";ae!=="undefined"?o.error(`æ’¤å›æ–‡ä»¶ä¿®æ”¹å¤±è´¥: ${ae}`):o.error("æ’¤å›æ–‡ä»¶ä¿®æ”¹å¤±è´¥ï¼Œè¯·é‡è¯•")}}function K(h){const g=h.split("/");return g[g.length-1]}function Q(h){const g=h.split("/");return g.length<=1?"":g.slice(0,-1).join("/")}function le(h){const g=h.replace(/\\/g,"/"),ae=y.lockedFiles.some(W=>{const oe=W.replace(/\\/g,"/");return g===oe});return(h==="test/2.txt"||h==="2.txt")&&console.log("æ£€æŸ¥æ–‡ä»¶é”å®šçŠ¶æ€:",{filePath:h,normalizedPath:g,lockedFiles:y.lockedFiles,normalizedLockedFiles:y.lockedFiles.map(W=>W.replace(/\\/g,"/")),isLocked:ae}),ae}function ye(h){le(h)?y.unlockFile(h):y.lockFile(h)}function Te(h){ne.value[h]=!ne.value[h]}return $t(()=>{ce(),y.loadConfig(),y.loadLockedFiles()}),Ye(()=>p.autoUpdateEnabled,(h,g)=>{console.log(`è‡ªåŠ¨æ›´æ–°çŠ¶æ€å˜æ›´: ${g} -> ${h}`),p.toggleAutoUpdate()},{immediate:!1}),i({refreshStatus:he}),(h,g)=>{const ae=xs,W=Ht,oe=Ge,ee=bt,Ce=Dt,Fe=ga,De=cs;return f(),$(be,null,[e("div",il,[e("div",rl,[g[8]||(g[8]=e("h2",null,"Git çŠ¶æ€",-1)),e("div",cl,[t(W,{content:l(p).autoUpdateEnabled?"ç¦ç”¨è‡ªåŠ¨æ›´æ–°æ–‡ä»¶çŠ¶æ€":"å¯ç”¨è‡ªåŠ¨æ›´æ–°æ–‡ä»¶çŠ¶æ€",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(ae,{modelValue:l(p).autoUpdateEnabled,"onUpdate:modelValue":g[0]||(g[0]=_=>l(p).autoUpdateEnabled=_),style:{"--el-switch-on-color":"#67C23A","--el-switch-off-color":"#909399","margin-right":"10px"},"inline-prompt":"","active-icon":l(Ls),"inactive-icon":l(is),class:"auto-update-switch"},null,8,["modelValue","active-icon","inactive-icon"])]),_:1},8,["content"]),t(W,{content:"Git Pull (æ‹‰å–è¿œç¨‹æ›´æ–°)",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:"primary",icon:l(zs),circle:"",size:"small",onClick:V,loading:l(p).isGitPulling,disabled:!l(p).hasUpstream},null,8,["icon","loading","disabled"])]),_:1}),t(W,{content:"Git Fetch All (è·å–æ‰€æœ‰è¿œç¨‹åˆ†æ”¯)",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[Xe(t(oe,{type:"primary",icon:l(Bs),circle:"",size:"small",onClick:T,loading:l(p).isGitFetching},null,8,["icon","loading"]),[[ft,!1]])]),_:1}),l(y).lockedFiles.length>0?(f(),Y(W,{key:0,content:"ç®¡ç†é”å®šæ–‡ä»¶",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:"warning",circle:"",size:"small",onClick:g[1]||(g[1]=_=>O.value=!0)},{default:a(()=>[t(ee,null,{default:a(()=>[t(l(nt))]),_:1})]),_:1})]),_:1})):A("",!0),t(W,{content:"åˆ·æ–°çŠ¶æ€",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:"primary",icon:l(va),circle:"",size:"small",onClick:he,loading:G.value},null,8,["icon","loading"])]),_:1})])]),Xe((f(),$("div",{class:"card-content","element-loading-text":l(p).isGitPulling?"æ­£åœ¨æ‹‰å–ä»£ç ...":"æ­£åœ¨è·å–è¿œç¨‹åˆ†æ”¯ä¿¡æ¯..."},[l(p).isGitRepo?(f(),$("div",fl,[l(p).hasUpstream&&(l(p).branchAhead>0||l(p).branchBehind>0)?(f(),$("div",pl,[e("div",ml,[e("div",vl,[t(W,{content:"æœ¬åœ°åˆ†æ”¯ä¸è¿œç¨‹åˆ†æ”¯çš„çŠ¶æ€å¯¹æ¯”",placement:"top","show-after":200},{default:a(()=>[e("div",gl,[l(p).branchAhead>0?(f(),Y(Ce,{key:0,size:"small",type:"warning",class:"status-badge"},{default:a(()=>[e("span",hl,[t(ee,null,{default:a(()=>[t(l(Fs))]),_:1}),w(" ä½ çš„åˆ†æ”¯é¢†å…ˆ 'origin/"+B(l(p).currentBranch)+"' "+B(l(p).branchAhead)+" ä¸ªæäº¤ ",1)])]),_:1})):A("",!0),l(p).branchBehind>0?(f(),Y(Ce,{key:1,size:"small",type:"info",class:"status-badge"},{default:a(()=>[e("span",yl,[t(ee,null,{default:a(()=>[t(l(_t))]),_:1}),w(" ä½ çš„åˆ†æ”¯è½å 'origin/"+B(l(p).currentBranch)+"' "+B(l(p).branchBehind)+" ä¸ªæäº¤ ",1)])]),_:1})):A("",!0)])]),_:1})])])])):A("",!0),l(p).fileList.length?(f(),$("div",_l,[l(p).fileList.some(_=>_.type==="added")?(f(),$("div",wl,[e("div",{class:"file-group-header",onClick:g[2]||(g[2]=_=>Te("staged"))},[t(ee,{class:ge(["collapse-icon",{collapsed:ne.value.staged}])},{default:a(()=>[t(l(_t))]),_:1},8,["class"]),g[10]||(g[10]=e("span",null,"å·²æš‚å­˜çš„æ›´æ”¹",-1))]),Xe(e("div",kl,[(f(!0),$(be,null,Be(l(p).fileList.filter(_=>_.type==="added"),_=>(f(),$("div",{key:_.path,class:"file-item",onClick:pe=>X(_)},[e("div",bl,[e("div",{class:ge(["file-status-indicator",["added",{locked:le(_.path)}]])},null,2),e("div",Cl,[t(W,{content:K(_.path),placement:"top",disabled:K(_.path).length<=25,"hide-after":1e3,"show-after":200},{default:a(()=>[e("span",{class:ge(["file-name",{"locked-file-name":le(_.path)}])},[w(B(K(_.path))+" ",1),le(_.path)?(f(),Y(ee,{key:0,class:"lock-indicator"},{default:a(()=>[t(l(nt))]),_:1})):A("",!0)],2)]),_:2},1032,["content","disabled"])]),e("div",{class:"file-path-section",title:Q(_.path)},[t(W,{content:Q(_.path),placement:"top",disabled:Q(_.path).length<=30,"hide-after":1e3,"show-after":200},{default:a(()=>[e("span",Tl,B(Q(_.path)),1)]),_:2},1032,["content","disabled"])],8,Sl)]),e("div",Vl,[t(W,{content:le(_.path)?"è§£é”æ–‡ä»¶":"é”å®šæ–‡ä»¶",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:le(_.path)?"danger":"info",size:"small",circle:"",onClick:qe(pe=>ye(_.path),["stop"]),class:"file-action-btn"},{default:a(()=>[t(ee,{size:"12"},{default:a(()=>[(f(),Y(wt(le(_.path)?l(nt):l(Pt))))]),_:2},1024)]),_:2},1032,["type","onClick"])]),_:2},1032,["content"]),t(W,{content:"å–æ¶ˆæš‚å­˜",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:"warning",size:"small",circle:"",onClick:qe(pe=>Z(_.path),["stop"]),class:"file-action-btn"},{default:a(()=>g[11]||(g[11]=[w("-")])),_:2},1032,["onClick"])]),_:2},1024)])],8,$l))),128))],512),[[ft,!ne.value.staged]])])):A("",!0),l(p).fileList.some(_=>_.type==="modified"||_.type==="deleted")?(f(),$("div",xl,[e("div",{class:"file-group-header",onClick:g[3]||(g[3]=_=>Te("unstaged"))},[t(ee,{class:ge(["collapse-icon",{collapsed:ne.value.unstaged}])},{default:a(()=>[t(l(_t))]),_:1},8,["class"]),g[12]||(g[12]=e("span",null,"æœªæš‚å­˜çš„æ›´æ”¹",-1))]),Xe(e("div",Ll,[(f(!0),$(be,null,Be(l(p).fileList.filter(_=>_.type==="modified"||_.type==="deleted"),_=>(f(),$("div",{key:_.path,class:"file-item",onClick:pe=>X(_)},[e("div",Bl,[e("div",{class:ge(["file-status-indicator",[_.type,{locked:le(_.path)}]])},null,2),e("div",Fl,[t(W,{content:K(_.path),placement:"top",disabled:K(_.path).length<=25,"hide-after":1e3,"show-after":200},{default:a(()=>[e("span",{class:ge(["file-name",{"locked-file-name":le(_.path)}])},[w(B(K(_.path))+" ",1),le(_.path)?(f(),Y(ee,{key:0,class:"lock-indicator"},{default:a(()=>[t(l(nt))]),_:1})):A("",!0)],2)]),_:2},1032,["content","disabled"])]),e("div",{class:"file-path-section",title:Q(_.path)},[t(W,{content:Q(_.path),placement:"top",disabled:Q(_.path).length<=30,"hide-after":1e3,"show-after":200},{default:a(()=>[e("span",Rl,B(Q(_.path)),1)]),_:2},1032,["content","disabled"])],8,Dl)]),e("div",jl,[t(W,{content:le(_.path)?"è§£é”æ–‡ä»¶":"é”å®šæ–‡ä»¶",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:le(_.path)?"danger":"info",size:"small",circle:"",onClick:qe(pe=>ye(_.path),["stop"]),class:"file-action-btn"},{default:a(()=>[t(ee,{size:"12"},{default:a(()=>[(f(),Y(wt(le(_.path)?l(nt):l(Pt))))]),_:2},1024)]),_:2},1032,["type","onClick"])]),_:2},1032,["content"]),t(W,{content:"æ·»åŠ åˆ°æš‚å­˜åŒº",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:"success",size:"small",circle:"",onClick:qe(pe=>j(_.path),["stop"]),class:"file-action-btn"},{default:a(()=>g[13]||(g[13]=[w("+")])),_:2},1032,["onClick"])]),_:2},1024),t(W,{content:"æ’¤å›ä¿®æ”¹",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:"danger",size:"small",icon:l(us),circle:"",onClick:qe(pe=>se(_.path),["stop"]),class:"file-action-btn"},null,8,["icon","onClick"])]),_:2},1024)])],8,zl))),128))],512),[[ft,!ne.value.unstaged]])])):A("",!0),l(p).fileList.some(_=>_.type==="untracked")?(f(),$("div",Gl,[e("div",{class:"file-group-header",onClick:g[4]||(g[4]=_=>Te("untracked"))},[t(ee,{class:ge(["collapse-icon",{collapsed:ne.value.untracked}])},{default:a(()=>[t(l(_t))]),_:1},8,["class"]),g[14]||(g[14]=e("span",null,"æœªè·Ÿè¸ªçš„æ–‡ä»¶",-1))]),Xe(e("div",Ol,[(f(!0),$(be,null,Be(l(p).fileList.filter(_=>_.type==="untracked"),_=>(f(),$("div",{key:_.path,class:"file-item",onClick:pe=>X(_)},[e("div",Al,[e("div",{class:ge(["file-status-indicator",["untracked",{locked:le(_.path)}]])},null,2),e("div",Pl,[t(W,{content:K(_.path),placement:"top",disabled:K(_.path).length<=25,"hide-after":1e3,"show-after":200},{default:a(()=>[e("span",{class:ge(["file-name",{"locked-file-name":le(_.path)}])},[w(B(K(_.path))+" ",1),le(_.path)?(f(),Y(ee,{key:0,class:"lock-indicator"},{default:a(()=>[t(l(nt))]),_:1})):A("",!0)],2)]),_:2},1032,["content","disabled"])]),e("div",{class:"file-path-section",title:Q(_.path)},[t(W,{content:Q(_.path),placement:"top",disabled:Q(_.path).length<=30,"hide-after":1e3,"show-after":200},{default:a(()=>[e("span",Ml,B(Q(_.path)),1)]),_:2},1032,["content","disabled"])],8,El)]),e("div",Il,[t(W,{content:le(_.path)?"è§£é”æ–‡ä»¶":"é”å®šæ–‡ä»¶",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:le(_.path)?"danger":"info",size:"small",circle:"",onClick:qe(pe=>ye(_.path),["stop"]),class:"file-action-btn"},{default:a(()=>[t(ee,{size:"12"},{default:a(()=>[(f(),Y(wt(le(_.path)?l(nt):l(Pt))))]),_:2},1024)]),_:2},1032,["type","onClick"])]),_:2},1032,["content"]),t(W,{content:"æ·»åŠ åˆ°æš‚å­˜åŒº",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:"success",size:"small",circle:"",onClick:qe(pe=>j(_.path),["stop"]),class:"file-action-btn"},{default:a(()=>g[15]||(g[15]=[w("+")])),_:2},1032,["onClick"])]),_:2},1024),t(W,{content:"åˆ é™¤æ–‡ä»¶",placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[t(oe,{type:"danger",size:"small",icon:l(is),circle:"",onClick:qe(pe=>se(_.path),["stop"]),class:"file-action-btn"},null,8,["icon","onClick"])]),_:2},1024)])],8,Ul))),128))],512),[[ft,!ne.value.untracked]])])):A("",!0)])):l(p).isGitRepo?(f(),$("div",Nl,[e("div",Hl,[t(ee,null,{default:a(()=>[t(l(rs))]),_:1})]),g[16]||(g[16]=e("div",{class:"empty-text"},"æ²¡æœ‰æ£€æµ‹åˆ°ä»»ä½•æ›´æ”¹",-1)),g[17]||(g[17]=e("div",{class:"empty-subtext"},"å·¥ä½œåŒºæ˜¯å¹²å‡€çš„",-1))])):A("",!0)])):(f(),$("div",dl,g[9]||(g[9]=[e("div",{class:"empty-status"},[e("p",null,"å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“")],-1)])))],8,ul)),[[De,l(p).isGitPulling||l(p).isGitFetching]])]),t(Ft,{modelValue:E.value,"onUpdate:modelValue":g[5]||(g[5]=_=>E.value=_),title:"æ–‡ä»¶å·®å¼‚","custom-class":"file-diff-dialog",size:"extra-large",type:"flex","destroy-on-close":""},{default:a(()=>[t(ms,{files:I.value,diffContent:P.value,selectedFile:R.value,emptyText:"é€‰æ‹©æ–‡ä»¶æŸ¥çœ‹å·®å¼‚",onFileSelect:ie},null,8,["files","diffContent","selectedFile"])]),_:1},8,["modelValue"]),t(Ft,{modelValue:O.value,"onUpdate:modelValue":g[7]||(g[7]=_=>O.value=_),title:"é”å®šæ–‡ä»¶ç®¡ç†",size:"large","destroy-on-close":""},{footer:a(()=>[e("span",lo,[t(oe,{onClick:g[6]||(g[6]=_=>O.value=!1)},{default:a(()=>g[25]||(g[25]=[w("å…³é—­")])),_:1})])]),default:a(()=>[e("div",Jl,[e("div",Wl,[t(ee,{class:"description-icon"},{default:a(()=>[t(l($s))]),_:1}),g[18]||(g[18]=e("span",{class:"description-title"},"æ–‡ä»¶é”å®šåŠŸèƒ½è¯´æ˜",-1))]),g[19]||(g[19]=e("div",{class:"description-content"},[e("p",null,[e("strong",null,"ğŸ”’ é”å®šæ–‡ä»¶çš„ä½œç”¨ï¼š")]),e("ul",null,[e("li",null,"é”å®šçš„æ–‡ä»¶åœ¨æ‰§è¡Œ Git æäº¤æ—¶ä¼šè¢«è‡ªåŠ¨è·³è¿‡ï¼Œä¸ä¼šè¢«æ·»åŠ åˆ°æš‚å­˜åŒº"),e("li",null,"é€‚ç”¨äºä¸´æ—¶æ–‡ä»¶ã€é…ç½®æ–‡ä»¶ã€æˆ–ä¸æƒ³æäº¤çš„å¼€å‘ä¸­æ–‡ä»¶"),e("li",null,"é”å®šçŠ¶æ€ä¼šæŒä¹…ä¿å­˜ï¼Œç›´åˆ°æ‰‹åŠ¨è§£é”")]),e("p",null,[e("strong",null,"ğŸ’¡ ä½¿ç”¨åœºæ™¯ï¼š")]),e("ul",null,[e("li",null,"å¼€å‘è¿‡ç¨‹ä¸­çš„ä¸´æ—¶æµ‹è¯•æ–‡ä»¶"),e("li",null,"æœ¬åœ°é…ç½®æ–‡ä»¶ï¼ˆå¦‚æ•°æ®åº“è¿æ¥ã€APIå¯†é’¥ç­‰ï¼‰"),e("li",null,"æ­£åœ¨å¼€å‘ä½†è¿˜ä¸æƒ³æäº¤çš„åŠŸèƒ½æ–‡ä»¶")])],-1))]),t(Fe),l(y).lockedFiles.length===0?(f(),$("div",ql,[e("div",Yl,[t(ee,null,{default:a(()=>[t(l(nt))]),_:1})]),g[20]||(g[20]=e("p",null,"å½“å‰æ²¡æœ‰é”å®šçš„æ–‡ä»¶",-1)),g[21]||(g[21]=e("p",{class:"empty-tip"},"æ‚¨å¯ä»¥åœ¨æ–‡ä»¶åˆ—è¡¨ä¸­ç‚¹å‡»é”å®šæŒ‰é’®æ¥é”å®šæ–‡ä»¶",-1))])):(f(),$("div",Xl,[e("div",Kl,[e("span",null,"ğŸ”’ å·²é”å®š "+B(l(y).lockedFiles.length)+" ä¸ªæ–‡ä»¶",1),t(W,{content:"è¿™äº›æ–‡ä»¶åœ¨æäº¤æ—¶ä¼šè¢«è‡ªåŠ¨è·³è¿‡",placement:"top"},{default:a(()=>[t(ee,{class:"info-icon"},{default:a(()=>[t(l($s))]),_:1})]),_:1}),g[23]||(g[23]=e("div",{style:{flex:"1"}},null,-1)),t(oe,{type:"danger",size:"small",plain:"",disabled:!l(y).lockedFiles.length,onClick:D},{default:a(()=>g[22]||(g[22]=[w(" æ¸…ç©ºå…¨éƒ¨é”å®š ")])),_:1},8,["disabled"])]),e("div",Zl,[(f(!0),$(be,null,Be(l(y).lockedFiles,_=>(f(),$("div",{key:_,class:"locked-file-item"},[e("div",Ql,[g[24]||(g[24]=e("div",{class:"file-status-indicator locked"},null,-1)),e("div",eo,[e("span",to,B(K(_)),1),e("span",so,B(Q(_)),1)])]),e("div",ao,[t(W,{content:"è§£é”æ–‡ä»¶",placement:"top","hide-after":1e3},{default:a(()=>[t(oe,{type:"danger",size:"small",circle:"",class:"file-action-btn",icon:l(Pt),"aria-label":"è§£é”",onClick:pe=>S(_)},null,8,["icon","onClick"])]),_:2},1024)])]))),128))])]))]),_:1},8,["modelValue"])],64)}}}),no=mt(oo,[["__scopeId","data-v-0548a5fd"]]),io={class:"card-header"},ro={class:"header-actions"},co={key:0,class:"pushing-indicator"},uo={class:"pushing-text"},fo={key:0,class:"push-success-indicator"},po={class:"card-content"},mo={class:"layout-container"},vo={key:0,class:"git-config-warning"},go={key:1,class:"commit-section"},ho={class:"commit-options"},yo={class:"options-row"},_o={class:"commit-mode-toggle"},wo={class:"no-verify-toggle"},ko={key:0,class:"commit-form"},$o={class:"description-container"},bo={class:"preview-section"},Co={class:"preview-content code-command"},So={class:"form-bottom-actions"},To={class:"actions-flex-container"},Vo={class:"left-actions"},xo={class:"button-grid"},Lo={key:0},zo={key:0},Bo={key:0},Fo={class:"right-actions"},Do={class:"one-push-content"},Ro={key:1,class:"standard-commit-form"},jo={class:"standard-commit-header"},Go={class:"type-scope-container"},Oo={class:"scope-wrapper"},Uo={class:"description-container"},Ao={class:"advanced-fields"},Po={class:"preview-section"},Eo={class:"preview-content code-command"},Mo={class:"form-bottom-actions"},Io={class:"actions-flex-container"},No={class:"left-actions"},Ho={class:"button-grid"},Jo={key:0},Wo={key:0},qo={key:0},Yo={class:"right-actions"},Xo={class:"one-push-content"},Ko={class:"actions-section"},Zo={class:"action-groups"},Qo={class:"operations-wrapper"},en={class:"action-group"},tn={class:"group-buttons"},sn={key:0},an={key:0},ln={key:0},on={key:0},nn={class:"action-group"},rn={class:"group-buttons"},cn={class:"action-group reset-group"},un={class:"group-buttons"},dn={key:0},fn={class:"action-group branch-group"},pn={class:"group-buttons"},mn={class:"action-group"},vn={class:"group-buttons"},gn={class:"dialog-footer"},hn={class:"template-container"},yn={class:"template-form"},_n={class:"template-form-buttons"},wn={class:"template-list"},kn={class:"template-content"},$n={class:"template-actions"},bn={class:"template-container"},Cn={class:"template-form"},Sn={class:"template-form-buttons"},Tn={class:"template-list"},Vn={class:"template-content"},xn={class:"template-actions"},Ln={class:"template-container message-template-container"},zn={class:"template-form"},Bn={class:"template-form-buttons"},Fn={class:"templates-container"},Dn={class:"message-templates-list"},Rn={class:"templates-scroll-area"},jn={class:"template-content"},Gn={class:"template-actions"},On={class:"current-default-message"},Un={class:"default-message-content"},An={class:"message-help-text"},Pn={class:"stash-dialog-content"},En={class:"merge-dialog-content"},Mn={class:"merge-intro"},In={class:"merge-options"},Nn={class:"dialog-footer"},Hn={class:"stash-list-content"},Jn={class:"stash-action-buttons"},Wn={key:0,class:"stash-list-actions"},qn={class:"stash-content"},Yn={key:0,class:"stash-info-row"},Xn={class:"stash-id"},Kn={class:"stash-id-value"},Zn={class:"stash-description"},Qn={class:"stash-description-value"},ei={class:"stash-main-content"},ti=pt({__name:"CommitForm",setup(te){const i=kt(),m=ps(),p=c(""),y=c(!1),G=c(!1),R=c("è¾“å…¥æäº¤ä¿¡æ¯..."),P=c(""),E=c(!1),M=c("feat"),U=c(""),I=c(""),ie=c(""),O=c(""),ne=c(!1),ue=c(""),ce=c(!1),S=c([]),D=c(!1),F=c(""),X=c(!1),j=c(""),Z=c(-1),he=c(!1),fe=c(""),V=c({noFf:!1,squash:!1,noCommit:!1,message:""}),T=c([]),se=c(!1),K=c(""),Q=c(!1),le=c(""),ye=c(-1),Te=c(!1),h=c(""),g=c(!1),ae=c(!1),W=[{value:"feat",label:"feat: æ–°åŠŸèƒ½"},{value:"fix",label:"fix: ä¿®å¤bug"},{value:"docs",label:"docs: æ–‡æ¡£ä¿®æ”¹"},{value:"style",label:"style: æ ·å¼ä¿®æ”¹"},{value:"refactor",label:"refactor: ä»£ç é‡æ„"},{value:"test",label:"test: æµ‹è¯•ä»£ç "},{value:"chore",label:"chore: æ„å»º/å·¥å…·ä¿®æ”¹"}],oe=c(!1),ee=c(!1),Ce=c(""),Fe=c(!1),De=c(!0),_=c(!1),pe=c(null),Se=c([]),Le=c(""),ze=c(!1),Ke=c("");function Ze(){Ce.value="",Fe.value=!1,De.value=!0,oe.value=!0}function Pe(){try{const n=m.config;ue.value=JSON.stringify(n,null,2),ne.value=!0}catch{o.error("åŠ è½½é…ç½®å¤±è´¥")}}async function Qe(){try{ce.value=!0;let n;try{n=JSON.parse(ue.value)}catch(we){o.error(`JSON è§£æå¤±è´¥: ${we.message||we}`);return}const x=await(await fetch("/api/config/saveAll",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({config:n})})).json();if(!x.success)throw new Error(x.error||"ä¿å­˜å¤±è´¥");await m.loadConfig(!0);try{await m.loadLockedFiles()}catch{}try{Array.isArray(m.descriptionTemplates)&&(S.value=[...m.descriptionTemplates])}catch{}try{Array.isArray(m.scopeTemplates)&&(T.value=[...m.scopeTemplates])}catch{}try{Array.isArray(m.messageTemplates)&&(re.value=[...m.messageTemplates])}catch{}o.success("é…ç½®å·²ä¿å­˜"),ne.value=!1}catch(n){o.error(`ä¿å­˜é…ç½®å¤±è´¥: ${n.message||n}`)}finally{ce.value=!1}}async function L(){try{const n=await fetch("/api/config/open-file",{method:"POST"}),s=await n.json();if(!n.ok||!(s!=null&&s.success))throw new Error((s==null?void 0:s.error)||"æ‰“å¼€å¤±è´¥");o.success("å·²ç”¨ç³»ç»Ÿç¨‹åºæ‰“å¼€é…ç½®æ–‡ä»¶")}catch(n){o.error(`æ‰“å¼€é…ç½®æ–‡ä»¶å¤±è´¥: ${(n==null?void 0:n.message)||n}`)}}function r(){i.getStashList(),ee.value=!0}async function N(){try{await i.saveStash(Ce.value,Fe.value,De.value),oe.value=!1}catch(n){console.error("å‚¨è—å¤±è´¥:",n)}}async function H(n,s=!1){try{await i.applyStash(n,s),s&&await i.getStashList()}catch(x){console.error("åº”ç”¨å‚¨è—å¤±è´¥:",x)}}async function $e(n){Me.confirm("ç¡®å®šè¦åˆ é™¤æ­¤å‚¨è—å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚","åˆ é™¤å‚¨è—",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(async()=>{await i.dropStash(n),await i.getStashList()}).catch(()=>{})}async function Re(){Me.confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å‚¨è—å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚","æ¸…ç©ºæ‰€æœ‰å‚¨è—",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}).then(async()=>{await i.clearAllStashes(),await i.getStashList()}).catch(()=>{})}async function ke(n){if(n){pe.value=n,_.value=!0,ze.value=!0,Se.value=[],Le.value="",Ke.value="";try{if(!n.id||n.id.length<7){Le.value="æ— æ•ˆçš„stash ID",ze.value=!1;return}const x=await(await fetch(`/api/stash-files?stashId=${encodeURIComponent(n.id)}`)).json();x.success&&Array.isArray(x.files)?(Se.value=x.files,Se.value.length>0?await _e(n.id,Se.value[0]):Le.value="è¯¥stashæ²¡æœ‰å˜æ›´æ–‡ä»¶"):Le.value=`è·å–æ–‡ä»¶åˆ—è¡¨å¤±è´¥: ${x.error||"æœªçŸ¥é”™è¯¯"}`}catch(s){Le.value=`è·å–stashè¯¦æƒ…å¤±è´¥: ${s.message}`}finally{ze.value=!1}}}async function _e(n,s){ze.value=!0,Ke.value=s;try{const we=await(await fetch(`/api/stash-file-diff?stashId=${encodeURIComponent(n)}&file=${encodeURIComponent(s)}`)).json();we.success?Le.value=we.diff||"æ²¡æœ‰å˜æ›´å†…å®¹":Le.value=`è·å–å·®å¼‚å¤±è´¥: ${we.error||"æœªçŸ¥é”™è¯¯"}`}catch(x){Le.value=`è·å–å·®å¼‚å¤±è´¥: ${x.message}`}finally{ze.value=!1}}function je(n){pe.value&&_e(pe.value.id,n)}const re=c([]),me=c(!1),Ne=c(""),He=c(-1);Ye(E,n=>{localStorage.setItem("zen-gitsync-standard-commit",n.toString())}),Ye(g,n=>{localStorage.setItem("zen-gitsync-skip-hooks",n.toString())});const q=de(()=>{if(!E.value)return p.value||P.value;let n=`${M.value||""}`;return U.value&&(n+=`(${U.value})`),n+=`: ${I.value}`,ie.value&&(n+=`

${ie.value}`),O.value&&(n+=`

${O.value}`),n}),Oe=de(()=>E.value?M.value.trim()!==""&&I.value.trim()!=="":p.value.trim()!==""),vt=de(()=>Se.value.map(n=>({path:n,name:n.split("/").pop()||n}))),Ct=de(()=>{let n=`git commit -m "${q.value}"`;return g.value&&(n+=" --no-verify"),n});function et(){const n=m.config;n&&(R.value=`è¾“å…¥æäº¤ä¿¡æ¯ (é»˜è®¤: ${n.defaultCommitMessage})`,P.value=n.defaultCommitMessage||"",n.descriptionTemplates&&Array.isArray(n.descriptionTemplates)&&(S.value=n.descriptionTemplates),n.scopeTemplates&&Array.isArray(n.scopeTemplates)&&(T.value=n.scopeTemplates),n.messageTemplates&&Array.isArray(n.messageTemplates)&&(re.value=n.messageTemplates))}async function Ue(){if(!F.value.trim()){o({message:"è¯·è¾“å…¥æ¨¡æ¿å†…å®¹",type:"warning"});return}try{if(X.value)await St();else{if(S.value.includes(F.value)){o({message:"è¯¥æ¨¡æ¿å·²å­˜åœ¨",type:"warning"});return}await m.saveTemplate(F.value,"description")&&(S.value.includes(F.value)||S.value.push(F.value),S.value=[...S.value],F.value="")}}catch(n){o({message:`ä¿å­˜æ¨¡æ¿å¤±è´¥: ${n.message}`,type:"error"})}}async function St(){if(!F.value.trim()){o({message:"è¯·è¾“å…¥æ¨¡æ¿å†…å®¹",type:"warning"});return}try{if(await m.updateTemplate(j.value,F.value,"description")){const s=S.value.indexOf(j.value);s!==-1&&(S.value[s]=F.value),S.value=[...S.value],X.value=!1,j.value="",Z.value=-1,F.value=""}}catch(n){o({message:`æ›´æ–°æ¨¡æ¿å¤±è´¥: ${n.message}`,type:"error"})}}function k(n,s){X.value=!0,j.value=n,Z.value=s,F.value=n}function v(){X.value=!1,j.value="",Z.value=-1,F.value=""}async function J(){if(!K.value.trim()){o({message:"è¯·è¾“å…¥æ¨¡æ¿å†…å®¹",type:"warning"});return}try{if(Q.value)await u();else{if(T.value.includes(K.value)){o({message:"è¯¥æ¨¡æ¿å·²å­˜åœ¨",type:"warning"});return}await m.saveTemplate(K.value,"scope")&&(T.value.includes(K.value)||T.value.push(K.value),T.value=[...T.value],K.value="")}}catch(n){o({message:`ä¿å­˜æ¨¡æ¿å¤±è´¥: ${n.message}`,type:"error"})}}async function u(){if(!K.value.trim()){o({message:"è¯·è¾“å…¥æ¨¡æ¿å†…å®¹",type:"warning"});return}try{if(await m.updateTemplate(le.value,K.value,"scope")){const s=T.value.indexOf(le.value);s!==-1&&(T.value[s]=K.value),T.value=[...T.value],Q.value=!1,le.value="",ye.value=-1,K.value=""}}catch(n){o({message:`æ›´æ–°æ¨¡æ¿å¤±è´¥: ${n.message}`,type:"error"})}}function d(n,s){Q.value=!0,le.value=n,ye.value=s,K.value=n}function z(){Q.value=!1,le.value="",ye.value=-1,K.value=""}async function C(n){try{if(await Me.confirm(`ç¡®å®šè¦åˆ é™¤æè¿°æ¨¡æ¿ "${n}" å—ï¼Ÿ`,"åˆ é™¤ç¡®è®¤",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await m.deleteTemplate(n,"description")){const x=S.value.indexOf(n);x!==-1&&S.value.splice(x,1),S.value=[...S.value]}}catch(s){if(s==="cancel")return;o({message:`åˆ é™¤æ¨¡æ¿å¤±è´¥: ${s.message}`,type:"error"})}}async function ve(n){try{if(await Me.confirm(`ç¡®å®šè¦åˆ é™¤ä½œç”¨åŸŸæ¨¡æ¿ "${n}" å—ï¼Ÿ`,"åˆ é™¤ç¡®è®¤",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await m.deleteTemplate(n,"scope")){const x=T.value.indexOf(n);x!==-1&&T.value.splice(x,1),T.value=[...T.value]}}catch(s){if(s==="cancel")return;o({message:`åˆ é™¤æ¨¡æ¿å¤±è´¥: ${s.message}`,type:"error"})}}function Ee(n){I.value=n,D.value=!1}function Je(n){U.value=n,se.value=!1}function tt(){D.value=!0}function Rt(){se.value=!0}async function Wt(){try{await i.addToStage()&&i.fetchStatus()}catch(n){o({message:`æ·»åŠ æ–‡ä»¶å¤±è´¥: ${n.message}`,type:"error"})}}async function qt(){if(!q.value.trim()){o({message:"æäº¤ä¿¡æ¯ä¸èƒ½ä¸ºç©º",type:"warning"});return}try{await i.commitChanges(q.value,g.value)&&(Kt(),i.fetchStatus(),i.fetchLog(),i.getBranchStatus(!0))}catch(n){o({message:`æäº¤å¤±è´¥: ${n.message}`,type:"error"})}}function jt(){y.value=!0,setTimeout(()=>{y.value=!1},2e3)}async function Yt(){try{await i.pushToRemote(),G.value=!0;try{await new Promise(n=>setTimeout(n,200)),jt()}catch(n){console.error("æ¨é€åå¤„ç†å¤±è´¥:",n),jt()}finally{G.value=!1}}catch(n){G.value=!1,o({message:`æ¨é€å¤±è´¥: ${n.message}`,type:"error"})}}async function As(){try{await i.gitPull(),await i.fetchStatus(),await i.fetchLog(!1)}catch(n){console.error("æ‹‰å–æ“ä½œå‘ç”Ÿé”™è¯¯:",n)}}async function Ps(){try{await i.gitFetchAll(),await i.fetchStatus(),await i.fetchLog(!1)}catch(n){console.error("è·å–è¿œç¨‹åˆ†æ”¯ä¿¡æ¯æ“ä½œå‘ç”Ÿé”™è¯¯:",n)}}async function Es(){if(!q.value.trim()){o({message:"æäº¤ä¿¡æ¯ä¸èƒ½ä¸ºç©º",type:"warning"});return}try{await i.addAndCommit(q.value,g.value),Kt(),i.fetchStatus(),i.fetchLog()}catch(n){o({message:`æš‚å­˜å¹¶æäº¤å¤±è´¥: ${n.message}`,type:"error"})}}async function Xt(){if(!q.value.trim()){o({message:"æäº¤ä¿¡æ¯ä¸èƒ½ä¸ºç©º",type:"warning"});return}try{if(await i.addCommitAndPush(q.value,g.value)){Kt(),G.value=!0;try{await new Promise(s=>setTimeout(s,1e3)),console.log("ä¸€é”®æ¨é€å®Œæˆï¼ŒçŠ¶æ€å·²åœ¨pushToRemoteä¸­åˆ·æ–°"),jt()}catch(s){console.error("ä¸€é”®æ¨é€åå¤„ç†å¤±è´¥:",s),jt()}finally{G.value=!1}}}catch(n){o({message:`æš‚å­˜ã€æäº¤å¹¶æ¨é€å¤±è´¥: ${n.message}`,type:"error"})}}async function Ms(){try{await Me.confirm(`ç¡®å®šè¦é‡ç½®å½“å‰åˆ†æ”¯ "${i.currentBranch}" åˆ°è¿œç¨‹çŠ¶æ€å—ï¼Ÿè¿™å°†ä¸¢å¤±æ‰€æœ‰æœªæ¨é€çš„æäº¤å’Œæœ¬åœ°æ›´æ”¹ã€‚`,"é‡ç½®åˆ°è¿œç¨‹åˆ†æ”¯",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),await i.resetToRemote(i.currentBranch)&&(i.fetchStatus(),i.fetchLog())}catch(n){n!=="cancel"&&o({message:`é‡ç½®åˆ°è¿œç¨‹åˆ†æ”¯å¤±è´¥: ${n.message}`,type:"error"})}}function Kt(){p.value="",I.value="",ie.value="",O.value=""}function Is(){h.value=P.value,Te.value=!0}async function Ns(){if(!h.value.trim()){o({message:"è¯·è¾“å…¥é»˜è®¤æäº¤ä¿¡æ¯",type:"warning"});return}try{await m.saveDefaultMessage(h.value)&&(P.value=h.value,R.value=`è¾“å…¥æäº¤ä¿¡æ¯ (é»˜è®¤: ${h.value})`,Te.value=!1)}catch(n){o({message:`ä¿å­˜é»˜è®¤æäº¤ä¿¡æ¯å¤±è´¥: ${n.message}`,type:"error"})}}function Gt(n){const s=n.replace(/\\/g,"/");return m.lockedFiles.some(x=>{const we=x.replace(/\\/g,"/");return s===we})}const Tt=de(()=>i.fileList.some(n=>["modified","deleted","untracked"].includes(n.type)&&!Gt(n.path))),it=de(()=>i.fileList.filter(n=>["modified","deleted","untracked"].includes(n.type)&&!Gt(n.path)).length),We=de(()=>i.fileList.filter(n=>n.type==="added"&&!Gt(n.path)).length),gt=de(()=>We.value>0),rt=de(()=>i.fileList.some(n=>!Gt(n.path))),st=de(()=>i.branchAhead>0),Zt=de(()=>i.branchBehind>0),at=de(()=>i.hasUpstream&&st.value&&!gt.value),vs=de(()=>gt.value),Hs=de(()=>i.hasUpstream&&(st.value||Zt.value||rt.value));async function Js(){if(!h.value.trim()){o({message:"è¯·è¾“å…¥æ¨¡æ¿å†…å®¹",type:"warning"});return}try{if(me.value)await Ws();else{if(re.value.includes(h.value)){o({message:"è¯¥æ¨¡æ¿å·²å­˜åœ¨",type:"warning"});return}re.value.push(h.value);const s=await(await fetch("/api/config/save-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:h.value,type:"message"})})).json();s.success?(o({message:"æäº¤ä¿¡æ¯æ¨¡æ¿ä¿å­˜æˆåŠŸ!",type:"success"}),h.value=""):o({message:"æ¨¡æ¿ä¿å­˜å¤±è´¥: "+s.error,type:"error"})}}catch(n){o({message:"æ¨¡æ¿ä¿å­˜å¤±è´¥: "+n.message,type:"error"})}}async function Ws(){try{if(He.value>=0){const n=Ne.value,s=h.value;re.value[He.value]=s;const we=await(await fetch("/api/config/update-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({oldTemplate:n,newTemplate:s,type:"message"})})).json();we.success?(o({message:"æäº¤ä¿¡æ¯æ¨¡æ¿æ›´æ–°æˆåŠŸ!",type:"success"}),me.value=!1,Ne.value="",He.value=-1,h.value=""):o({message:"æ¨¡æ¿æ›´æ–°å¤±è´¥: "+we.error,type:"error"})}}catch(n){o({message:"æ¨¡æ¿æ›´æ–°å¤±è´¥: "+n.message,type:"error"})}}function qs(n,s){me.value=!0,Ne.value=n,He.value=s,h.value=n}function Ys(){me.value=!1,Ne.value="",He.value=-1,h.value=""}async function Xs(n){try{const s=re.value.indexOf(n);s!==-1&&re.value.splice(s,1);const we=await(await fetch("/api/config/delete-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:n,type:"message"})})).json();we.success?o({message:"æäº¤ä¿¡æ¯æ¨¡æ¿åˆ é™¤æˆåŠŸ!",type:"success"}):o({message:"æ¨¡æ¿åˆ é™¤å¤±è´¥: "+we.error,type:"error"})}catch(s){o({message:"æ¨¡æ¿åˆ é™¤å¤±è´¥: "+s.message,type:"error"})}}function Ks(n){p.value=n,h.value=n}$t(async()=>{const n=localStorage.getItem("zen-gitsync-standard-commit");n!==null&&(E.value=n==="true");const s=localStorage.getItem("zen-gitsync-skip-hooks");s!==null&&(g.value=s==="true"),Ye(()=>m.config,et,{immediate:!0}),m.config||await m.loadConfig()});function Zs(){fe.value="",V.value={noFf:!1,squash:!1,noCommit:!1,message:""},ht.value="all",he.value=!0,i.allBranches.length===0&&i.getAllBranches()}const ht=c("all"),Qs=de(()=>{const n=i.allBranches.filter(s=>s!==i.currentBranch);if(console.log("ç­›é€‰åˆ†æ”¯åˆ—è¡¨:",{allBranches:i.allBranches,currentBranch:i.currentBranch,branchTypeFilter:ht.value,filteredBranches:n}),ht.value==="local"){const s=n.filter(x=>!x.includes("origin/"));return console.log("æœ¬åœ°åˆ†æ”¯:",s),s}else if(ht.value==="remote"){const s=n.filter(x=>x.includes("origin/"));return console.log("è¿œç¨‹åˆ†æ”¯:",s),s}else return console.log("æ‰€æœ‰åˆ†æ”¯:",n),n});async function ea(){if(!fe.value){o({message:"è¯·é€‰æ‹©è¦åˆå¹¶çš„åˆ†æ”¯",type:"warning"});return}try{await i.mergeBranch(fe.value,V.value)&&(he.value=!1,await i.fetchStatus(),await i.fetchLog(!1))}catch(n){console.error("åˆå¹¶åˆ†æ”¯æ“ä½œå‘ç”Ÿé”™è¯¯:",n)}}const Ot=c(!1);function ta(){Ot.value=!Ot.value}function sa(n,s){const we=[...n?S.value.filter(Ve=>Ve.toLowerCase().includes(n.toLowerCase())).map(Ve=>({value:Ve})):S.value.map(Ve=>({value:Ve})),{value:"âš™ï¸ ç®¡ç†æ¨¡æ¿...",isSettings:!0}];s(we)}function aa(n,s){const we=[...n?T.value.filter(Ve=>Ve.toLowerCase().includes(n.toLowerCase())).map(Ve=>({value:Ve})):T.value.map(Ve=>({value:Ve})),{value:"âš™ï¸ ç®¡ç†æ¨¡æ¿...",isSettings:!0}];s(we)}function la(n){n.isSettings?(tt(),I.value=""):I.value=n.value}function oa(n){n.isSettings?(Rt(),U.value=""):U.value=n.value}function na(n,s){const we=[...n?re.value.filter(Ve=>Ve.toLowerCase().includes(n.toLowerCase())).map(Ve=>({value:Ve})):re.value.map(Ve=>({value:Ve})),{value:"âš™ï¸ ç®¡ç†æ¨¡æ¿...",isSettings:!0}];s(we)}function ia(n){n.isSettings?(Is(),p.value=""):p.value=n.value}return(n,s)=>{const x=Ge,we=bt,Ve=ds,gs=xs,Qt=ya,xe=Ht,hs=It,ys=Nt,lt=fs,ra=wa,yt=Jt,Ut=Mt,es=ka,At=Rs,_s=Dt,ct=Gs,Vt=$a,ws=js,ts=Ca,ca=ba,ss=zt,ua=Os,da=cs;return f(),$(be,null,[e("div",{class:ge(["card",{"is-pushing":l(i).isPushing}])},[e("div",io,[s[34]||(s[34]=e("h2",null,"æäº¤æ›´æ”¹",-1)),e("div",ro,[t(x,{size:"small",type:"primary",icon:l(xt),onClick:Pe},{default:a(()=>s[33]||(s[33]=[w("é…ç½®")])),_:1},8,["icon"]),t(x,{type:"primary",icon:l(ha),size:"small",circle:"",onClick:ta,class:"git-tools-button"},null,8,["icon"])])]),t(bs,{name:"el-fade-in-linear"},{default:a(()=>[l(i).isPushing||G.value?(f(),$("div",co,[s[35]||(s[35]=e("div",{class:"pushing-spinner"},[e("svg",{viewBox:"0 0 50 50",class:"circular"},[e("circle",{class:"path",cx:"25",cy:"25",r:"20",fill:"none"})])],-1)),e("div",uo,B(l(i).isPushing?"æ­£åœ¨æ¨é€...":"æ›´æ–°çŠ¶æ€ä¸­..."),1)])):A("",!0)]),_:1}),t(bs,{name:"el-fade-in-linear"},{default:a(()=>[y.value?(f(),$("div",fo,[t(we,{class:"push-success-icon"},{default:a(()=>[t(l(Ls))]),_:1}),s[36]||(s[36]=e("div",{class:"push-success-text"},"å·²å®Œæˆ!",-1))])):A("",!0)]),_:1}),e("div",po,[e("div",mo,[l(i).userName===""||l(i).userEmail===""?(f(),$("div",vo,[t(Ve,{title:"Gitç”¨æˆ·ä¿¡æ¯æœªé…ç½®",type:"warning",closable:!1,"show-icon":""},{default:a(()=>s[37]||(s[37]=[e("p",null,"æ‚¨éœ€è¦é…ç½®Gitç”¨æˆ·åå’Œé‚®ç®±æ‰èƒ½æäº¤ä»£ç ã€‚è¯·ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤é…ç½®ï¼š",-1),e("pre",{class:"config-command"},`git config --global user.name "Your Name"
git config --global user.email "your.email@example.com"`,-1)])),_:1})])):(f(),$("div",go,[e("div",ho,[e("div",yo,[e("div",_o,[t(gs,{modelValue:E.value,"onUpdate:modelValue":s[0]||(s[0]=b=>E.value=b),"active-text":"æ ‡å‡†åŒ–æäº¤","inactive-text":"æ™®é€šæäº¤"},null,8,["modelValue"])]),e("div",wo,[t(gs,{modelValue:g.value,"onUpdate:modelValue":s[1]||(s[1]=b=>g.value=b),"active-text":"è·³è¿‡ Git é’©å­æ£€æŸ¥ (--no-verify)"},null,8,["modelValue"])])])]),E.value?(f(),$("div",Ro,[e("div",jo,[e("div",Go,[t(ys,{modelValue:M.value,"onUpdate:modelValue":s[3]||(s[3]=b=>M.value=b),placeholder:"æäº¤ç±»å‹",class:"type-select",clearable:""},{default:a(()=>[(f(),$(be,null,Be(W,b=>t(hs,{key:b.value,label:b.label,value:b.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),e("div",Oo,[t(Qt,{modelValue:U.value,"onUpdate:modelValue":s[4]||(s[4]=b=>U.value=b),"fetch-suggestions":aa,placeholder:"ä½œç”¨åŸŸï¼ˆå¯é€‰ï¼‰",class:"scope-input",clearable:"",onSelect:oa},null,8,["modelValue"])])]),e("div",Uo,[t(Qt,{modelValue:I.value,"onUpdate:modelValue":s[5]||(s[5]=b=>I.value=b),"fetch-suggestions":sa,placeholder:"ç®€çŸ­æè¿°ï¼ˆå¿…å¡«ï¼‰",class:"description-input",clearable:"",onSelect:la},null,8,["modelValue"])])]),e("div",{class:"advanced-options-toggle",onClick:s[6]||(s[6]=b=>ae.value=!ae.value)},[e("span",null,B(ae.value?"æ”¶èµ·":"æ­£æ–‡åŠé¡µè„š"),1),t(we,{class:ge(["toggle-icon",{"is-active":ae.value}])},{default:a(()=>[t(l(_t))]),_:1},8,["class"])]),Xe(e("div",Ao,[t(lt,{modelValue:ie.value,"onUpdate:modelValue":s[7]||(s[7]=b=>ie.value=b),type:"textarea",rows:4,placeholder:"æ­£æ–‡ï¼ˆå¯é€‰ï¼‰ï¼šè¯¦ç»†æè¿°æœ¬æ¬¡æäº¤çš„å†…å®¹å’ŒåŸå› ",class:"body-input",clearable:""},null,8,["modelValue"]),t(lt,{modelValue:O.value,"onUpdate:modelValue":s[8]||(s[8]=b=>O.value=b),placeholder:"é¡µè„šï¼ˆå¯é€‰ï¼‰ï¼šå¦‚ Closes #123",class:"footer-input",clearable:""},null,8,["modelValue"])],512),[[ft,ae.value]]),e("div",Po,[s[43]||(s[43]=e("div",{class:"preview-title"},"Gitæäº¤å‘½ä»¤é¢„è§ˆï¼š",-1)),e("pre",Eo,B(Ct.value),1)]),e("div",Mo,[e("div",Io,[e("div",No,[e("div",Ho,[t(x,{type:"primary",onClick:Wt,loading:l(i).isAddingFiles,disabled:!Tt.value,class:"stage-button"},{default:a(()=>[s[44]||(s[44]=w(" æš‚å­˜æ›´æ”¹ ")),it.value>0?(f(),$("span",Jo,"("+B(it.value)+")",1)):A("",!0)]),_:1},8,["loading","disabled"]),t(x,{type:"primary",onClick:qt,loading:l(i).isLoadingStatus,disabled:!gt.value||!Oe.value},{default:a(()=>[s[45]||(s[45]=w(" æäº¤ ")),We.value>0?(f(),$("span",Wo,"("+B(We.value)+")",1)):A("",!0)]),_:1},8,["loading","disabled"]),t(xe,{content:at.value?"æ¨é€å·²æäº¤çš„æ›´æ”¹åˆ°è¿œç¨‹ä»“åº“":l(i).hasUpstream?st.value?"æœ‰æœªæäº¤çš„æš‚å­˜æ›´æ”¹ï¼Œè¯·å…ˆæäº¤":"æ²¡æœ‰éœ€è¦æ¨é€çš„æäº¤":"å½“å‰åˆ†æ”¯æ²¡æœ‰ä¸Šæ¸¸åˆ†æ”¯",placement:"top","show-after":200},{default:a(()=>[t(x,{type:"primary",icon:l(as),onClick:Yt,loading:l(i).isPushing,disabled:!at.value,style:dt(at.value?{backgroundColor:"#67c23a",borderColor:"#67c23a"}:{})},{default:a(()=>[s[46]||(s[46]=w(" æ¨é€ ")),st.value?(f(),$("span",qo,"("+B(l(i).branchAhead)+")",1)):A("",!0)]),_:1},8,["icon","loading","disabled","style"])]),_:1},8,["content"])])]),e("div",Yo,[t(xe,{content:rt.value?Oe.value?l(i).hasUpstream?"ä¸€é”®å®Œæˆï¼šæš‚å­˜æ‰€æœ‰æ›´æ”¹ â†’ æäº¤ â†’ æ¨é€åˆ°è¿œç¨‹ä»“åº“":"å½“å‰åˆ†æ”¯æ²¡æœ‰ä¸Šæ¸¸åˆ†æ”¯":"è¯·è¾“å…¥æäº¤ä¿¡æ¯":"æ²¡æœ‰éœ€è¦æäº¤çš„æ›´æ”¹",placement:"top","show-after":200},{default:a(()=>[t(x,{type:"success",onClick:Xt,loading:l(i).isAddingFiles||l(i).isCommiting||l(i).isPushing,disabled:!rt.value||!Oe.value||!l(i).hasUpstream,class:"one-push-button"},{default:a(()=>[e("div",Xo,[t(we,{class:"one-push-icon"},{default:a(()=>[t(l(ls))]),_:1}),s[47]||(s[47]=e("div",{class:"one-push-text"},[e("span",{class:"one-push-title"},"ä¸€é”®æ¨é€æ‰€æœ‰"),e("span",{class:"one-push-desc"},"æš‚å­˜ + æäº¤ + æ¨é€")],-1))])]),_:1},8,["loading","disabled"])]),_:1},8,["content"])])])])])):(f(),$("div",ko,[e("div",$o,[t(Qt,{modelValue:p.value,"onUpdate:modelValue":s[2]||(s[2]=b=>p.value=b),"fetch-suggestions":na,placeholder:R.value,type:"textarea",rows:6,resize:"none",class:"commit-message-input",onSelect:ia},null,8,["modelValue","placeholder"])]),e("div",bo,[s[38]||(s[38]=e("div",{class:"preview-title"},"Gitæäº¤å‘½ä»¤é¢„è§ˆï¼š",-1)),e("pre",Co,'git commit -m "'+B(q.value||"<æäº¤ä¿¡æ¯>")+'"'+B(g.value?" --no-verify":""),1)]),e("div",So,[e("div",To,[e("div",Vo,[e("div",xo,[t(x,{type:"primary",onClick:Wt,loading:l(i).isAddingFiles,disabled:!Tt.value,class:"stage-button"},{default:a(()=>[s[39]||(s[39]=w(" æš‚å­˜æ›´æ”¹ ")),it.value>0?(f(),$("span",Lo,"("+B(it.value)+")",1)):A("",!0)]),_:1},8,["loading","disabled"]),t(x,{type:"primary",onClick:qt,loading:l(i).isLoadingStatus,disabled:!gt.value||!Oe.value},{default:a(()=>[s[40]||(s[40]=w(" æäº¤ ")),We.value>0?(f(),$("span",zo,"("+B(We.value)+")",1)):A("",!0)]),_:1},8,["loading","disabled"]),t(xe,{content:at.value?"æ¨é€å·²æäº¤çš„æ›´æ”¹åˆ°è¿œç¨‹ä»“åº“":l(i).hasUpstream?st.value?"æœ‰æœªæäº¤çš„æš‚å­˜æ›´æ”¹ï¼Œè¯·å…ˆæäº¤":"æ²¡æœ‰éœ€è¦æ¨é€çš„æäº¤":"å½“å‰åˆ†æ”¯æ²¡æœ‰ä¸Šæ¸¸åˆ†æ”¯",placement:"top","show-after":200},{default:a(()=>[t(x,{type:"primary",icon:l(as),onClick:Yt,loading:l(i).isPushing,disabled:!at.value,style:dt(at.value?{backgroundColor:"#67c23a",borderColor:"#67c23a"}:{})},{default:a(()=>[s[41]||(s[41]=w(" æ¨é€ ")),st.value?(f(),$("span",Bo,"("+B(l(i).branchAhead)+")",1)):A("",!0)]),_:1},8,["icon","loading","disabled","style"])]),_:1},8,["content"])])]),e("div",Fo,[t(xe,{content:rt.value?Oe.value?l(i).hasUpstream?"ä¸€é”®å®Œæˆï¼šæš‚å­˜æ‰€æœ‰æ›´æ”¹ â†’ æäº¤ â†’ æ¨é€åˆ°è¿œç¨‹ä»“åº“":"å½“å‰åˆ†æ”¯æ²¡æœ‰ä¸Šæ¸¸åˆ†æ”¯":"è¯·è¾“å…¥æäº¤ä¿¡æ¯":"æ²¡æœ‰éœ€è¦æäº¤çš„æ›´æ”¹",placement:"top","show-after":200},{default:a(()=>[t(x,{type:"success",onClick:Xt,loading:l(i).isAddingFiles||l(i).isCommiting||l(i).isPushing,disabled:!rt.value||!Oe.value||!l(i).hasUpstream,class:"one-push-button"},{default:a(()=>[e("div",Do,[t(we,{class:"one-push-icon"},{default:a(()=>[t(l(ls))]),_:1}),s[42]||(s[42]=e("div",{class:"one-push-text"},[e("span",{class:"one-push-title"},"ä¸€é”®æ¨é€æ‰€æœ‰"),e("span",{class:"one-push-desc"},"æš‚å­˜ + æäº¤ + æ¨é€")],-1))])]),_:1},8,["loading","disabled"])]),_:1},8,["content"])])])])]))]))])])],2),t(ra,{modelValue:Ot.value,"onUpdate:modelValue":s[9]||(s[9]=b=>Ot.value=b),title:"Git æ“ä½œ",direction:"rtl",size:"340px","with-header":!0,"show-close":!0,"destroy-on-close":!1,class:"git-operations-drawer"},{default:a(()=>[e("div",Ko,[e("div",Zo,[e("div",Qo,[e("div",en,[s[53]||(s[53]=e("div",{class:"group-title"},"åŸºç¡€æ“ä½œ",-1)),e("div",tn,[t(xe,{content:Tt.value?`æš‚å­˜${it.value}ä¸ªå¾…æ›´æ”¹æ–‡ä»¶`:"git add .",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"primary",onClick:Wt,loading:l(i).isAddingFiles,disabled:!Tt.value,class:"action-button"},{default:a(()=>[s[48]||(s[48]=w(" æš‚å­˜æ›´æ”¹ ")),it.value>0?(f(),$("span",sn,"("+B(it.value)+")",1)):A("",!0)]),_:1},8,["loading","disabled"])]),_:1},8,["content"]),t(xe,{content:gt.value?`æäº¤${We.value}ä¸ªå·²æš‚å­˜æ–‡ä»¶`:"git commit",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"primary",onClick:qt,loading:l(i).isLoadingStatus,disabled:!gt.value||!Oe.value,class:"action-button"},{default:a(()=>[s[49]||(s[49]=w(" æäº¤ ")),We.value>0?(f(),$("span",an,"("+B(We.value)+")",1)):A("",!0)]),_:1},8,["loading","disabled"])]),_:1},8,["content"]),t(xe,{content:st.value?`æ¨é€${l(i).branchAhead}ä¸ªæœ¬åœ°æäº¤`:"git push",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"primary",icon:l(as),onClick:Yt,loading:l(i).isPushing,disabled:!at.value,class:ge(["action-button","push-button",{"is-loading":l(i).isPushing}]),style:dt(at.value?{backgroundColor:"#67c23a",borderColor:"#67c23a"}:{})},{default:a(()=>[s[50]||(s[50]=w(" æ¨é€ ")),st.value?(f(),$("span",ln,"("+B(l(i).branchAhead)+")",1)):A("",!0)]),_:1},8,["icon","loading","disabled","class","style"])]),_:1},8,["content"]),t(xe,{content:Zt.value?`æ‹‰å–${l(i).branchBehind}ä¸ªè¿œç¨‹æäº¤`:"git pull",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"primary",icon:l(zs),onClick:As,loading:l(i).isGitPulling,disabled:!l(i).hasUpstream,class:"action-button",style:dt(l(i).hasUpstream?{color:"white",backgroundColor:"#1e90ff",borderColor:"#1e90ff"}:{})},{default:a(()=>[s[51]||(s[51]=w(" æ‹‰å– ")),Zt.value?(f(),$("span",on,"("+B(l(i).branchBehind)+")",1)):A("",!0)]),_:1},8,["icon","loading","disabled","style"])]),_:1},8,["content"]),t(xe,{content:"git fetch --all",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"info",icon:l(Bs),onClick:Ps,loading:l(i).isGitFetching,class:"action-button",style:{color:"white","background-color":"#1e90ff","border-color":"#1e90ff"}},{default:a(()=>s[52]||(s[52]=[w(" è·å–æ‰€æœ‰è¿œç¨‹åˆ†æ”¯ ")])),_:1},8,["icon","loading"])]),_:1})])]),e("div",nn,[s[56]||(s[56]=e("div",{class:"group-title"},"ç»„åˆæ“ä½œ",-1)),e("div",rn,[t(xe,{content:"git add + git commit",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"primary",icon:l(xt),onClick:Es,loading:l(i).isAddingFiles||l(i).isCommiting,disabled:!Tt.value||!Oe.value,class:"action-button"},{default:a(()=>s[54]||(s[54]=[w(" æš‚å­˜å¹¶æäº¤ ")])),_:1},8,["icon","loading","disabled"])]),_:1}),t(xe,{content:"git add + git commit + git push",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"success",icon:l(ls),onClick:Xt,loading:l(i).isAddingFiles||l(i).isCommiting||l(i).isPushing,disabled:!rt.value||!Oe.value||!l(i).hasUpstream,class:ge(["action-button","one-click-push",{"is-loading":l(i).isAddingFiles||l(i).isCommiting||l(i).isPushing}])},{default:a(()=>s[55]||(s[55]=[w(" ä¸€é”®æ¨é€æ‰€æœ‰ ")])),_:1},8,["icon","loading","disabled","class"])]),_:1})])])]),e("div",cn,[s[59]||(s[59]=e("div",{class:"group-title"},"é‡ç½®æ“ä½œ",-1)),e("div",un,[t(xe,{content:vs.value?`æ’¤é”€${We.value}ä¸ªå·²æš‚å­˜æ–‡ä»¶`:"git reset HEAD",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"warning",icon:l(us),onClick:l(i).resetHead,loading:l(i).isResetting,disabled:!vs.value,class:"action-button reset-button"},{default:a(()=>[s[57]||(s[57]=w(" é‡ç½®æš‚å­˜åŒº ")),We.value>0?(f(),$("span",dn,"("+B(We.value)+")",1)):A("",!0)]),_:1},8,["icon","onClick","loading","disabled"])]),_:1},8,["content"]),t(xe,{content:"git reset --hard origin/branch",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"danger",icon:l(Ds),onClick:Ms,loading:l(i).isResetting,disabled:!Hs.value,class:"action-button danger-button"},{default:a(()=>s[58]||(s[58]=[w(" é‡ç½®åˆ°è¿œç¨‹ ")])),_:1},8,["icon","loading","disabled"])]),_:1})])]),e("div",fn,[s[61]||(s[61]=e("div",{class:"group-title"},"åˆ†æ”¯æ“ä½œ",-1)),e("div",pn,[t(xe,{content:"åˆå¹¶å…¶ä»–åˆ†æ”¯åˆ°å½“å‰åˆ†æ”¯",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"primary",icon:l(_a),onClick:Zs,loading:l(i).isGitMerging,class:"action-button merge-button"},{default:a(()=>s[60]||(s[60]=[w(" åˆå¹¶åˆ†æ”¯ ")])),_:1},8,["icon","loading"])]),_:1})])]),e("div",mn,[s[64]||(s[64]=e("div",{class:"group-title"},"å‚¨è—æ“ä½œ",-1)),e("div",vn,[t(xe,{content:"å°†å·¥ä½œåŒºæ›´æ”¹å‚¨è—èµ·æ¥",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"warning",onClick:Ze,loading:l(i).isSavingStash,disabled:!rt.value,class:"action-button"},{default:a(()=>s[62]||(s[62]=[w(" å‚¨è—æ›´æ”¹ ")])),_:1},8,["loading","disabled"])]),_:1}),t(xe,{content:"æŸ¥çœ‹å’Œç®¡ç†æ‰€æœ‰å‚¨è—è®°å½•",placement:"top",effect:"light","popper-class":"git-cmd-tooltip","open-delay":200},{default:a(()=>[t(x,{type:"info",onClick:r,class:"action-button"},{default:a(()=>s[63]||(s[63]=[w(" å‚¨è—åˆ—è¡¨ ")])),_:1})]),_:1})])])])])]),_:1},8,["modelValue"]),t(yt,{class:"config-editor-dialog",title:"ç¼–è¾‘é…ç½® JSON",modelValue:ne.value,"onUpdate:modelValue":s[12]||(s[12]=b=>ne.value=b),width:"60%"},{footer:a(()=>[e("span",gn,[t(x,{onClick:L},{default:a(()=>s[65]||(s[65]=[w("æ‰“å¼€ç³»ç»Ÿé…ç½®æ–‡ä»¶")])),_:1}),t(x,{onClick:s[11]||(s[11]=b=>ne.value=!1)},{default:a(()=>s[66]||(s[66]=[w("å–æ¶ˆ")])),_:1}),t(x,{type:"primary",loading:ce.value,onClick:Qe},{default:a(()=>s[67]||(s[67]=[w("ä¿å­˜")])),_:1},8,["loading"])])]),default:a(()=>[t(lt,{modelValue:ue.value,"onUpdate:modelValue":s[10]||(s[10]=b=>ue.value=b),type:"textarea",rows:18,spellcheck:"false",autocomplete:"off",placeholder:"åœ¨æ­¤ç¼–è¾‘å½“å‰é¡¹ç›®é…ç½®çš„ JSON"},null,8,["modelValue"])]),_:1},8,["modelValue"]),t(yt,{title:"ç®€çŸ­æè¿°æ¨¡æ¿è®¾ç½®",modelValue:D.value,"onUpdate:modelValue":s[14]||(s[14]=b=>D.value=b),width:"80vw",top:"70px",style:{height:"calc(100vh - 140px)"},"close-on-click-modal":!1,class:"template-dialog"},{default:a(()=>[e("div",hn,[e("div",yn,[t(lt,{modelValue:F.value,"onUpdate:modelValue":s[13]||(s[13]=b=>F.value=b),placeholder:X.value?"ç¼–è¾‘æ¨¡æ¿å†…å®¹":"è¾“å…¥æ–°æ¨¡æ¿å†…å®¹",class:"template-input",clearable:""},null,8,["modelValue","placeholder"]),e("div",_n,[X.value?(f(),Y(x,{key:0,onClick:v},{default:a(()=>s[68]||(s[68]=[w("å–æ¶ˆ")])),_:1})):A("",!0),t(x,{type:"primary",onClick:Ue,disabled:!F.value.trim()},{default:a(()=>[w(B(X.value?"æ›´æ–°æ¨¡æ¿":"æ·»åŠ æ¨¡æ¿"),1)]),_:1},8,["disabled"])])]),e("div",wn,[s[72]||(s[72]=e("h3",null,"å·²ä¿å­˜æ¨¡æ¿",-1)),S.value.length===0?(f(),Y(Ut,{key:0,description:"æš‚æ— ä¿å­˜çš„æ¨¡æ¿"})):A("",!0),(f(!0),$(be,null,Be(S.value,(b,Ie)=>(f(),Y(At,{key:Ie,class:"template-item"},{default:a(()=>[t(es,{justify:"space-between",align:"middle",style:{width:"100%"}},{default:a(()=>[e("div",kn,B(b),1),e("div",$n,[t(x,{type:"primary",size:"small",onClick:ot=>Ee(b)},{default:a(()=>s[69]||(s[69]=[w("ä½¿ç”¨")])),_:2},1032,["onClick"]),t(x,{type:"warning",size:"small",icon:l(xt),onClick:ot=>k(b,Ie)},{default:a(()=>s[70]||(s[70]=[w("ç¼–è¾‘")])),_:2},1032,["icon","onClick"]),t(x,{type:"danger",size:"small",onClick:ot=>C(b)},{default:a(()=>s[71]||(s[71]=[w("åˆ é™¤")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])])]),_:1},8,["modelValue"]),t(yt,{title:"ä½œç”¨åŸŸæ¨¡æ¿è®¾ç½®",modelValue:se.value,"onUpdate:modelValue":s[16]||(s[16]=b=>se.value=b),width:"80vw",top:"70px",style:{height:"calc(100vh - 140px)"},"close-on-click-modal":!1,class:"template-dialog"},{default:a(()=>[e("div",bn,[e("div",Cn,[t(lt,{modelValue:K.value,"onUpdate:modelValue":s[15]||(s[15]=b=>K.value=b),placeholder:Q.value?"ç¼–è¾‘ä½œç”¨åŸŸæ¨¡æ¿å†…å®¹":"è¾“å…¥æ–°ä½œç”¨åŸŸæ¨¡æ¿",class:"template-input",clearable:""},null,8,["modelValue","placeholder"]),e("div",Sn,[Q.value?(f(),Y(x,{key:0,onClick:z},{default:a(()=>s[73]||(s[73]=[w("å–æ¶ˆ")])),_:1})):A("",!0),t(x,{type:"primary",onClick:J,disabled:!K.value.trim()},{default:a(()=>[w(B(Q.value?"æ›´æ–°æ¨¡æ¿":"æ·»åŠ æ¨¡æ¿"),1)]),_:1},8,["disabled"])])]),e("div",Tn,[s[77]||(s[77]=e("h3",null,"å·²ä¿å­˜ä½œç”¨åŸŸ",-1)),T.value.length===0?(f(),Y(Ut,{key:0,description:"æš‚æ— ä¿å­˜çš„ä½œç”¨åŸŸ"})):A("",!0),(f(!0),$(be,null,Be(T.value,(b,Ie)=>(f(),Y(At,{key:Ie,class:"template-item"},{default:a(()=>[t(es,{justify:"space-between",align:"middle",style:{width:"100%"}},{default:a(()=>[e("div",Vn,B(b),1),e("div",xn,[t(x,{type:"primary",size:"small",onClick:ot=>Je(b)},{default:a(()=>s[74]||(s[74]=[w("ä½¿ç”¨")])),_:2},1032,["onClick"]),t(x,{type:"warning",size:"small",icon:l(xt),onClick:ot=>d(b,Ie)},{default:a(()=>s[75]||(s[75]=[w("ç¼–è¾‘")])),_:2},1032,["icon","onClick"]),t(x,{type:"danger",size:"small",onClick:ot=>ve(b)},{default:a(()=>s[76]||(s[76]=[w("åˆ é™¤")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])])]),_:1},8,["modelValue"]),t(yt,{title:"é»˜è®¤æäº¤ä¿¡æ¯è®¾ç½®",modelValue:Te.value,"onUpdate:modelValue":s[18]||(s[18]=b=>Te.value=b),width:"80vw",top:"70px",style:{height:"calc(100vh - 140px)"},"close-on-click-modal":!1,class:"message-template-dialog"},{default:a(()=>[e("div",Ln,[e("div",zn,[t(lt,{modelValue:h.value,"onUpdate:modelValue":s[17]||(s[17]=b=>h.value=b),placeholder:me.value?"ç¼–è¾‘æ¨¡æ¿å†…å®¹":"è¾“å…¥æ–°æ¨¡æ¿å†…å®¹",class:"template-input",clearable:""},null,8,["modelValue","placeholder"]),e("div",Bn,[me.value?(f(),Y(x,{key:0,onClick:Ys},{default:a(()=>s[78]||(s[78]=[w("å–æ¶ˆ")])),_:1})):A("",!0),t(x,{type:"primary",onClick:Js,disabled:!h.value.trim()},{default:a(()=>[w(B(me.value?"æ›´æ–°æ¨¡æ¿":"æ·»åŠ æ¨¡æ¿"),1)]),_:1},8,["disabled"]),t(x,{type:"success",onClick:Ns,disabled:!h.value.trim()},{default:a(()=>s[79]||(s[79]=[w(" è®¾ä¸ºé»˜è®¤æäº¤ä¿¡æ¯ ")])),_:1},8,["disabled"])])]),e("div",Fn,[e("div",Dn,[s[83]||(s[83]=e("h3",null,"å·²ä¿å­˜æ¨¡æ¿",-1)),e("div",Rn,[re.value.length===0?(f(),Y(Ut,{key:0,description:"æš‚æ— ä¿å­˜çš„æ¨¡æ¿"})):A("",!0),(f(!0),$(be,null,Be(re.value,(b,Ie)=>(f(),Y(At,{key:Ie,class:"template-item"},{default:a(()=>[t(es,{justify:"space-between",align:"middle",style:{width:"100%"}},{default:a(()=>[e("div",jn,B(b),1),e("div",Gn,[t(x,{type:"primary",size:"small",onClick:ot=>Ks(b)},{default:a(()=>s[80]||(s[80]=[w("ä½¿ç”¨")])),_:2},1032,["onClick"]),t(x,{type:"warning",size:"small",icon:l(xt),onClick:ot=>qs(b,Ie)},{default:a(()=>s[81]||(s[81]=[w("ç¼–è¾‘")])),_:2},1032,["icon","onClick"]),t(x,{type:"danger",size:"small",onClick:ot=>Xs(b)},{default:a(()=>s[82]||(s[82]=[w("åˆ é™¤")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])]),e("div",On,[s[91]||(s[91]=e("h3",null,"å½“å‰é»˜è®¤æäº¤ä¿¡æ¯",-1)),P.value?(f(),Y(At,{key:0,class:"default-message-card"},{default:a(()=>[e("div",Un,B(P.value),1)]),_:1})):(f(),Y(Ut,{key:1,description:"å°šæœªè®¾ç½®é»˜è®¤æäº¤ä¿¡æ¯","image-size":100})),e("div",An,[s[89]||(s[89]=e("h4",null,"å…³äºé»˜è®¤æäº¤ä¿¡æ¯",-1)),s[90]||(s[90]=e("p",null,"é»˜è®¤æäº¤ä¿¡æ¯å°†åœ¨æœªè¾“å…¥æäº¤ä¿¡æ¯æ—¶è‡ªåŠ¨ä½¿ç”¨ã€‚",-1)),e("p",null,[s[86]||(s[86]=w("ä½ å¯ä»¥é€šè¿‡ç‚¹å‡»å·¦ä¾§æ¨¡æ¿çš„")),t(_s,{size:"small",type:"primary"},{default:a(()=>s[84]||(s[84]=[w("ä½¿ç”¨")])),_:1}),s[87]||(s[87]=w("æŒ‰é’®å…ˆé€‰æ‹©å–œæ¬¢çš„æ¨¡æ¿ï¼Œç„¶åç‚¹å‡»ä¸Šæ–¹")),t(_s,{size:"small",type:"success"},{default:a(()=>s[85]||(s[85]=[w("è®¾ä¸ºé»˜è®¤æäº¤ä¿¡æ¯")])),_:1}),s[88]||(s[88]=w("æŒ‰é’®ä¿å­˜ã€‚"))])])])])])]),_:1},8,["modelValue"]),t(Ft,{modelValue:oe.value,"onUpdate:modelValue":s[22]||(s[22]=b=>oe.value=b),title:"å‚¨è—æ›´æ”¹ (Git Stash)",size:"medium","close-on-click-modal":!1,"show-footer":"","confirm-text":"å‚¨è—","confirm-loading":l(i).isSavingStash,onConfirm:N},{default:a(()=>[e("div",Pn,[s[94]||(s[94]=e("p",null,"å°†å½“å‰å·¥ä½œåŒºçš„æ›´æ”¹å‚¨è—èµ·æ¥ï¼Œç¨åå¯ä»¥å†æ¬¡åº”ç”¨ã€‚",-1)),t(ws,{"label-position":"top"},{default:a(()=>[t(ct,{label:"å‚¨è—è¯´æ˜ (å¯é€‰)"},{default:a(()=>[t(lt,{modelValue:Ce.value,"onUpdate:modelValue":s[19]||(s[19]=b=>Ce.value=b),placeholder:"è¾“å…¥å‚¨è—è¯´æ˜ï¼ˆå¯é€‰ï¼‰",clearable:""},null,8,["modelValue"])]),_:1}),t(ct,null,{default:a(()=>[t(Vt,{modelValue:Fe.value,"onUpdate:modelValue":s[20]||(s[20]=b=>Fe.value=b)},{default:a(()=>s[92]||(s[92]=[w(" åŒ…å«æœªè·Ÿè¸ªæ–‡ä»¶ (--include-untracked) ")])),_:1},8,["modelValue"])]),_:1}),t(ct,null,{default:a(()=>[t(Vt,{modelValue:De.value,"onUpdate:modelValue":s[21]||(s[21]=b=>De.value=b)},{default:a(()=>s[93]||(s[93]=[w(" æ’é™¤é”å®šæ–‡ä»¶ ")])),_:1},8,["modelValue"])]),_:1})]),_:1})])]),_:1},8,["modelValue","confirm-loading"]),t(yt,{title:"åˆå¹¶åˆ†æ”¯",modelValue:he.value,"onUpdate:modelValue":s[30]||(s[30]=b=>he.value=b),width:"500px","close-on-click-modal":!1,class:"merge-dialog"},{footer:a(()=>[e("div",Nn,[t(x,{onClick:s[29]||(s[29]=b=>he.value=!1)},{default:a(()=>s[101]||(s[101]=[w("å–æ¶ˆ")])),_:1}),t(x,{type:"primary",onClick:ea,loading:l(i).isGitMerging,disabled:!fe.value,class:"merge-confirm-btn"},{default:a(()=>s[102]||(s[102]=[w(" åˆå¹¶ ")])),_:1},8,["loading","disabled"])])]),default:a(()=>[e("div",En,[e("p",Mn,"é€‰æ‹©è¦åˆå¹¶åˆ°å½“å‰åˆ†æ”¯ ("+B(l(i).currentBranch)+") çš„åˆ†æ”¯:",1),t(ws,{"label-position":"top"},{default:a(()=>[t(ct,{label:"åˆ†æ”¯ç±»å‹"},{default:a(()=>[t(ca,{modelValue:ht.value,"onUpdate:modelValue":s[23]||(s[23]=b=>ht.value=b),size:"small"},{default:a(()=>[t(ts,{label:"all"},{default:a(()=>s[95]||(s[95]=[w("æ‰€æœ‰åˆ†æ”¯")])),_:1}),t(ts,{label:"local"},{default:a(()=>s[96]||(s[96]=[w("æœ¬åœ°åˆ†æ”¯")])),_:1}),t(ts,{label:"remote"},{default:a(()=>s[97]||(s[97]=[w("è¿œç¨‹åˆ†æ”¯")])),_:1})]),_:1},8,["modelValue"])]),_:1}),t(ct,{label:"é€‰æ‹©åˆ†æ”¯"},{default:a(()=>[t(ys,{modelValue:fe.value,"onUpdate:modelValue":s[24]||(s[24]=b=>fe.value=b),placeholder:"é€‰æ‹©è¦åˆå¹¶çš„åˆ†æ”¯",style:{width:"100%"},filterable:""},{default:a(()=>[(f(!0),$(be,null,Be(Qs.value,b=>(f(),Y(hs,{key:b,label:b,value:b},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),t(ct,{label:"åˆå¹¶é€‰é¡¹"},{default:a(()=>[e("div",In,[t(Vt,{modelValue:V.value.noFf,"onUpdate:modelValue":s[25]||(s[25]=b=>V.value.noFf=b)},{default:a(()=>[t(xe,{content:"åˆ›å»ºåˆå¹¶æäº¤ï¼Œå³ä½¿å¯ä»¥ä½¿ç”¨å¿«è¿›åˆå¹¶",placement:"top"},{default:a(()=>s[98]||(s[98]=[e("span",null,"ç¦ç”¨å¿«è¿›åˆå¹¶ (--no-ff)",-1)])),_:1})]),_:1},8,["modelValue"]),t(Vt,{modelValue:V.value.squash,"onUpdate:modelValue":s[26]||(s[26]=b=>V.value.squash=b)},{default:a(()=>[t(xe,{content:"å°†å¤šä¸ªæäº¤å‹ç¼©ä¸ºä¸€ä¸ªæäº¤",placement:"top"},{default:a(()=>s[99]||(s[99]=[e("span",null,"å‹ç¼©æäº¤ (--squash)",-1)])),_:1})]),_:1},8,["modelValue"]),t(Vt,{modelValue:V.value.noCommit,"onUpdate:modelValue":s[27]||(s[27]=b=>V.value.noCommit=b)},{default:a(()=>[t(xe,{content:"æ‰§è¡Œåˆå¹¶ä½†ä¸è‡ªåŠ¨åˆ›å»ºæäº¤",placement:"top"},{default:a(()=>s[100]||(s[100]=[e("span",null,"ä¸è‡ªåŠ¨æäº¤ (--no-commit)",-1)])),_:1})]),_:1},8,["modelValue"])])]),_:1}),V.value.noFf&&!V.value.noCommit?(f(),Y(ct,{key:0,label:"åˆå¹¶æäº¤ä¿¡æ¯ (å¯é€‰)"},{default:a(()=>[t(lt,{modelValue:V.value.message,"onUpdate:modelValue":s[28]||(s[28]=b=>V.value.message=b),type:"textarea",rows:3,placeholder:"è¾“å…¥è‡ªå®šä¹‰åˆå¹¶æäº¤ä¿¡æ¯"},null,8,["modelValue"])]),_:1})):A("",!0)]),_:1})])]),_:1},8,["modelValue"]),t(yt,{title:"å‚¨è—åˆ—è¡¨ (Git Stash)",modelValue:ee.value,"onUpdate:modelValue":s[31]||(s[31]=b=>ee.value=b),width:"600px","close-on-click-modal":!1},{default:a(()=>[e("div",Hn,[Xe((f(),Y(ua,{data:l(i).stashes,stripe:"",style:{width:"100%"},"empty-text":"æš‚æ— å‚¨è—è®°å½•"},{default:a(()=>[t(ss,{prop:"id",label:"ID",width:"100"}),t(ss,{prop:"description",label:"æè¿°"}),t(ss,{label:"æ“ä½œ",width:"280"},{default:a(b=>[e("div",Jn,[t(x,{size:"small",type:"info",onClick:Ie=>ke(b.row),loading:ze.value},{default:a(()=>s[103]||(s[103]=[w(" æŸ¥çœ‹ ")])),_:2},1032,["onClick","loading"]),t(x,{size:"small",onClick:Ie=>H(b.row.id,!1),loading:l(i).isApplyingStash},{default:a(()=>s[104]||(s[104]=[w(" åº”ç”¨ ")])),_:2},1032,["onClick","loading"]),t(x,{size:"small",type:"primary",onClick:Ie=>H(b.row.id,!0),loading:l(i).isApplyingStash},{default:a(()=>s[105]||(s[105]=[w(" åº”ç”¨å¹¶åˆ é™¤ ")])),_:2},1032,["onClick","loading"]),t(x,{size:"small",type:"danger",onClick:Ie=>$e(b.row.id),loading:l(i).isDroppingStash},{default:a(()=>s[106]||(s[106]=[w(" åˆ é™¤ ")])),_:2},1032,["onClick","loading"])])]),_:1})]),_:1},8,["data"])),[[da,l(i).isLoadingStashes]]),l(i).stashes.length>0?(f(),$("div",Wn,[t(x,{type:"danger",onClick:Re,loading:l(i).isDroppingStash},{default:a(()=>s[107]||(s[107]=[w(" æ¸…ç©ºæ‰€æœ‰å‚¨è— ")])),_:1},8,["loading"])])):A("",!0)])]),_:1},8,["modelValue"]),t(Ft,{modelValue:_.value,"onUpdate:modelValue":s[32]||(s[32]=b=>_.value=b),title:"å‚¨è—è¯¦æƒ…","custom-class":"stash-detail-dialog",size:"extra-large",type:"flex","close-on-click-modal":!1},{default:a(()=>[e("div",qn,[pe.value?(f(),$("div",Yn,[e("div",Xn,[s[108]||(s[108]=e("span",{class:"info-label"},"Stash ID:",-1)),e("code",Kn,B(pe.value.id),1)]),e("div",Zn,[s[109]||(s[109]=e("span",{class:"info-label"},"æè¿°:",-1)),e("span",Qn,B(pe.value.description),1)])])):A("",!0),e("div",ei,[t(ms,{files:vt.value,diffContent:Le.value,selectedFile:Ke.value,emptyText:"è¯¥stashæ²¡æœ‰å˜æ›´æ–‡ä»¶",onFileSelect:je},null,8,["files","diffContent","selectedFile"])])])]),_:1},8,["modelValue"])],64)}}}),si=mt(ti,[["__scopeId","data-v-acd75536"]]),ai={class:"log-header"},li={class:"log-actions"},oi={key:0,class:"filter-panel-header"},ni={class:"filter-form"},ii={class:"filter-item"},ri={class:"filter-item"},ci={class:"filter-item"},ui={class:"filter-item"},di={class:"filter-actions"},fi={key:0},pi={key:1,class:"content-area-content"},mi={key:0,class:"graph-view"},vi={key:0,class:"commit-count"},gi={class:"graph-controls"},hi={class:"zoom-controls"},yi={class:"scale-info"},_i={key:1,class:"table-view-container"},wi=["onClick"],ki={class:"commit-message-cell"},$i={class:"message-content"},bi={key:0,class:"branch-container"},Ci={class:"message-text"},Si={class:"author-name"};const Ti={class:"commit-detail-container"},Vi={key:0,class:"commit-info"},xi={class:"commit-info-header"},Li={class:"info-item"},zi={class:"item-value"},Bi={class:"info-item"},Fi={class:"item-value"},Di={class:"info-item"},Ri={class:"item-value"},ji={class:"commit-message-container"},Gi=["innerHTML"],Lt=.5,Et=1.5,ns=.1,Oi=pt({__name:"LogList",setup(te,{expose:i}){const m=kt();let p=[];const y=c(p),G=c(""),R=c(!1),P=de(()=>m.isLoadingLog||R.value),E=c(!1),M=c(0),U=c(!1),I=c(null),ie=c(1),O=c(!0),ne=c(!1),ue=c(null),ce=c(!1),S=c(null),D=c([]),F=c(""),X=c(!1),j=c(""),Z=c(1),he=c(!1),fe=c(!1),V=c([]),T=c(""),se=c(null),K=c([]),Q=c([]),le=c([]),ye=c(!1),Te=c(0),h=c(0),g=c(null),ae=de(()=>y.value),W=de(()=>D.value.map(k=>({path:k,name:k.split("/").pop()||k})));async function oe(k=!1,v=1){if(!kt().isGitRepo){G.value="å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“";return}try{v>1?ne.value=!0:R.value=!0;const u=new URLSearchParams;u.append("page",v.toString()),u.append("all",k.toString()),u.append("with_parents","true"),V.value.length>0&&u.append("author",V.value.join(",")),Q.value.length>0&&u.append("branch",Q.value.join(",")),T.value&&u.append("message",T.value),se.value&&Array.isArray(se.value)&&se.value.length===2&&(u.append("dateFrom",se.value[0]),u.append("dateTo",se.value[1])),u.append("_t",Date.now().toString());const z=await(await fetch(`/api/log?${u.toString()}`)).json();if(!z||!z.data||!Array.isArray(z.data)){G.value="åŠ è½½æäº¤å†å²å¤±è´¥: æœåŠ¡å™¨è¿”å›æ•°æ®æ ¼å¼ä¸æ­£ç¡®";return}const C=v>1;C?z.data.forEach(ve=>p.push(ve)):(p.length=0,z.data.forEach(ve=>p.push(ve))),y.value=[...p],ie.value=v,M.value=z.total||p.length,O.value=z.hasMore===!0,C||(he.value=!0,setTimeout(()=>{he.value=!1},2e3)),!C&&U.value?setTimeout(ee,0):!C&&!U.value&&!k&&ut(()=>{ze(),setTimeout(et,200)}),G.value=""}catch(u){G.value="åŠ è½½æäº¤å†å²å¤±è´¥: "+(u instanceof Error?u.message:String(u)),v>1&&(O.value=!1)}finally{v>1?ne.value=!1:R.value=!1}}async function ee(){if(I.value&&p.length!==0)try{I.value.innerHTML="";const k=Ga(I.value,{orientation:"vertical-reverse",template:"metro",author:"æäº¤è€… <committer@example.com>"}),v={},J=k.branch(m.currentBranch||"main");v[m.currentBranch||"main"]=J,p.forEach(u=>{let d=J;if(u.branch){const z=De(u.branch.split(",")[0]);v[z]||(v[z]=k.branch(z)),d=v[z]}d.commit({hash:u.hash,subject:u.message,author:`${u.author} <${u.email}>`})}),setTimeout(()=>{N()},100)}catch(k){G.value="æ¸²æŸ“å›¾è¡¨å¤±è´¥: "+(k instanceof Error?k.message:String(k))}}function Ce(){U.value=!U.value,U.value&&p.length>0&&setTimeout(ee,0)}function Fe(){E.value=!E.value,E.value||(O.value=!0),ie.value=1,oe(E.value),ut(()=>{setTimeout(()=>{!U.value&&!E.value&&(ze(),et())},300)})}function De(k){return k.includes("HEAD -> ")?k.replace("HEAD -> ",""):k.includes("origin/")?k:k.trim()}function _(k){return k.includes("HEAD")?"success":k.includes("origin/")?"warning":"info"}const pe=c(null),Se=c(null);function Le(k){if(U.value||!O.value||ne.value||P.value)return;const v=k.target,{scrollTop:J,scrollHeight:u,clientHeight:d}=v;u-J-d<=20&&_e()}function ze(){if(!pe.value)return;const k=pe.value.$el.querySelector(".el-table__body-wrapper");k&&(Se.value=k,Se.value&&(Se.value.removeEventListener("scroll",Le,!0),Se.value.addEventListener("scroll",Le,!0)))}function Ke(){Se.value&&(Se.value.removeEventListener("scroll",Le,!0),Se.value=null)}function Ze(k){k.key==="Escape"&&Ue.value&&(Ue.value=!1)}$t(()=>{m.isGitRepo?(m.log.length>0?(p.length=0,m.log.forEach(k=>p.push(k)),M.value=m.log.length,U.value&&setTimeout(()=>{ee()},100)):oe(),me()):G.value="å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“",ut(()=>{setTimeout(()=>{ze()},500)}),Ye(()=>pe.value,k=>{k&&!U.value&&!E.value&&ut(()=>{ze()})}),window.addEventListener("keydown",Ze)}),Ye(()=>m.allBranches,k=>{k&&k.length>0?le.value=[...k].sort():le.value=[]},{immediate:!0}),Sa(()=>{Ke(),ue.value!==null&&(window.clearInterval(ue.value),ue.value=null),window.removeEventListener("keydown",Ze)});async function Pe(){await m.fetchLog(!0),p.length=0,m.log.forEach(k=>p.push(k)),y.value=[...p],M.value=m.log.length,ie.value=1,O.value=!1,he.value=!0,setTimeout(()=>{he.value=!1},2e3),U.value&&(await ut(),ee())}Ye(()=>m.log,k=>{try{p.length=0,Array.isArray(k)&&k.forEach(v=>v&&p.push(v)),M.value=p.length,ie.value=1,y.value=[...p],he.value=!0,setTimeout(()=>{he.value=!1},2e3),U.value&&p.length>0&&setTimeout(ee,0)}catch{}},{immediate:!0}),i({refreshLog:Pe});function Qe(){Z.value<Et&&(Z.value=Math.min(Et,Z.value+ns),r())}function L(){Z.value>Lt&&(Z.value=Math.max(Lt,Z.value-ns),r())}function r(){if(!I.value)return;const k=I.value.querySelector("svg");k&&(k.style.transform=`scale(${Z.value})`,k.style.transformOrigin="top left")}function N(){if(!I.value)return;const k=I.value.querySelector("svg");if(!k)return;const v=k.getBoundingClientRect().width/Z.value,J=I.value.clientWidth;v>J?Z.value=Math.max(Lt,J/v):Z.value=1,r()}async function H(k){if(k){S.value=k,ce.value=!0,X.value=!0,D.value=[],F.value="",j.value="";try{if(!k.hash||k.hash.length<7){F.value="æ— æ•ˆçš„æäº¤å“ˆå¸Œå€¼",X.value=!1;return}const J=await(await fetch(`/api/commit-files?hash=${k.hash}`)).json();J.success&&Array.isArray(J.files)?(D.value=J.files,D.value.length>0?await $e(k.hash,D.value[0]):F.value="è¯¥æäº¤æ²¡æœ‰å˜æ›´æ–‡ä»¶"):F.value=`è·å–æ–‡ä»¶åˆ—è¡¨å¤±è´¥: ${J.error||"æœªçŸ¥é”™è¯¯"}`}catch(v){F.value=`è·å–æäº¤è¯¦æƒ…å¤±è´¥: ${v.message}`}finally{X.value=!1}}}async function $e(k,v){X.value=!0,j.value=v;try{const u=await(await fetch(`/api/commit-file-diff?hash=${k}&file=${encodeURIComponent(v)}`)).json();u.success?F.value=u.diff||"æ²¡æœ‰å˜æ›´å†…å®¹":F.value=`è·å–å·®å¼‚å¤±è´¥: ${u.error||"æœªçŸ¥é”™è¯¯"}`}catch(J){F.value=`è·å–å·®å¼‚å¤±è´¥: ${J.message}`}finally{X.value=!1}}function Re(k){S.value&&$e(S.value.hash,k)}async function ke(k){try{const v=Wa(k);await navigator.clipboard.writeText(v),o.success("æäº¤ä¿¡æ¯å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch{o.error("å¤åˆ¶å¤±è´¥")}}function _e(){!O.value||ne.value||P.value||oe(E.value,ie.value+1)}function je(){V.value=[],Q.value=[],T.value="",se.value=null,ie.value=1,oe(E.value,1)}function re(){ie.value=1,oe(E.value,1)}async function me(){try{const v=await(await fetch("/api/authors")).json();v.success&&Array.isArray(v.authors)?K.value=v.authors.sort():Ne()}catch{Ne()}}function Ne(){const k=new Set;y.value.forEach(v=>{v.author&&k.add(v.author)}),K.value=Array.from(k).sort()}Ye(()=>y.value,()=>{},{deep:!0});function He(k,v,J){J.preventDefault(),Te.value=J.clientY,h.value=J.clientX,g.value=k,ye.value=!0;const u=()=>{ye.value=!1,document.removeEventListener("click",u)};setTimeout(()=>{document.addEventListener("click",u)},0)}async function q(k){if(k)try{await Me.confirm(`ç¡®å®šè¦æ’¤é”€æäº¤ ${k.hash.substring(0,7)} å—ï¼Ÿè¿™å°†åˆ›å»ºä¸€ä¸ªæ–°çš„æäº¤æ¥æ’¤é”€è¿™æ¬¡æäº¤çš„æ›´æ”¹ã€‚`,"æ’¤é”€æäº¤ç¡®è®¤",{confirmButtonText:"ç¡®è®¤",cancelButtonText:"å–æ¶ˆ",type:"warning"});const J=await(await fetch("/api/revert-commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hash:k.hash})})).json();J.success?(o.success(J.message||"å·²æˆåŠŸæ’¤é”€æäº¤"),Pe(),m.fetchStatus(),m.getBranchStatus()):o.error(J.error||"æ’¤é”€æäº¤å¤±è´¥")}catch(v){v!=="cancel"&&o.error("æ’¤é”€æäº¤å¤±è´¥: "+(v.message||v))}}async function Oe(k){if(k)try{await Me.confirm(`ç¡®å®šè¦å°†æäº¤ ${k.hash.substring(0,7)} Cherry-Pick åˆ°å½“å‰åˆ†æ”¯å—ï¼Ÿ`,"Cherry-Pickç¡®è®¤",{confirmButtonText:"ç¡®è®¤",cancelButtonText:"å–æ¶ˆ",type:"warning"});const J=await(await fetch("/api/cherry-pick-commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hash:k.hash})})).json();J.success?(o.success(J.message||"å·²æˆåŠŸCherry-Pickæäº¤"),Pe(),m.fetchStatus(),m.getBranchStatus()):o.error(J.error||"Cherry-Pickæäº¤å¤±è´¥")}catch(v){v!=="cancel"&&o.error("Cherry-Pickæäº¤å¤±è´¥: "+(v.message||v))}}async function vt(k){if(k)try{await navigator.clipboard.writeText(k.hash),o.success(`å·²å¤åˆ¶æäº¤å“ˆå¸Œ: ${k.hash.substring(0,7)}`)}catch(v){o.error(`å¤åˆ¶æäº¤å“ˆå¸Œå¤±è´¥: ${v.message}`)}}async function Ct(k){if(k)try{await Me.confirm(`ç¡®å®šè¦å°†å½“å‰åˆ†æ”¯é‡ç½®(hard)åˆ°æäº¤ ${k.hash.substring(0,7)} å—ï¼Ÿ
      
      è­¦å‘Šï¼šè¿™å°†ä¸¢å¤±è¯¥æäº¤ä¹‹åçš„æ‰€æœ‰æ›´æ”¹ï¼`,"é‡ç½®ç¡®è®¤",{confirmButtonText:"ç¡®è®¤é‡ç½®",cancelButtonText:"å–æ¶ˆ",type:"warning",dangerouslyUseHTMLString:!0});const J=await(await fetch("/api/reset-to-commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({hash:k.hash})})).json();J.success?(o.success(J.message||"å·²æˆåŠŸé‡ç½®åˆ°æŒ‡å®šæäº¤"),Pe(),m.fetchStatus(),m.getBranchStatus()):o.error(J.error||"é‡ç½®åˆ°æŒ‡å®šæäº¤å¤±è´¥")}catch(v){v!=="cancel"&&o.error("é‡ç½®åˆ°æŒ‡å®šæäº¤å¤±è´¥: "+(v.message||v))}}function et(){if(U.value||!O.value||ne.value||P.value||E.value)return;if(!Se.value){ze();return}const{scrollTop:k,scrollHeight:v,clientHeight:J}=Se.value;v-k-J<=50&&_e()}Ye(()=>U.value,k=>{!k&&!E.value&&ut(()=>{ze(),setTimeout(et,200)})});const Ue=c(!1);function St(){Ue.value=!Ue.value,ut(()=>{U.value&&I.value&&ee()})}return(k,v)=>{var z;const J=bt,u=Ht,d=cs;return f(),$(be,null,[e("div",{class:ge(["card",{"fullscreen-mode":Ue.value}])},[e("div",ai,[v[13]||(v[13]=e("div",{class:"header-left"},[e("h2",null,"æäº¤å†å²")],-1)),e("div",li,[U.value?A("",!0):(f(),Y(l(Ge),{key:0,type:fe.value?"primary":"default",size:"small",onClick:v[0]||(v[0]=C=>fe.value=!fe.value),class:ge(["action-button filter-button icon-only-button",{"active-filter":fe.value}])},{icon:a(()=>[t(J,null,{default:a(()=>[t(l(Ta))]),_:1})]),_:1},8,["type","class"])),t(l(Ge),{type:"primary",size:"small",onClick:Ce,class:ge(["action-button view-mode-button icon-only-button",{"active-view":U.value}])},{icon:a(()=>[t(J,null,{default:a(()=>[(f(),Y(wt(U.value?l(rs):l(Va))))]),_:1})]),_:1},8,["class"]),Xe(t(l(Ge),{type:"success",size:"small",onClick:Fe,loading:P.value,class:ge(["action-button commit-display-button",{"active-commits":E.value}])},{icon:a(()=>[t(J,null,{default:a(()=>[(f(),Y(wt(E.value?l(xa):l(La))))]),_:1})]),default:a(()=>[w(" "+B(E.value?"æ˜¾ç¤ºåˆ†é¡µåŠ è½½":"æ˜¾ç¤ºæ‰€æœ‰æäº¤"),1)]),_:1},8,["loading","class"]),[[ft,!1]]),t(l(Ge),{type:"info",size:"small",onClick:St,class:ge(["action-button fullscreen-button icon-only-button",{"active-fullscreen":Ue.value}])},{icon:a(()=>[t(J,null,{default:a(()=>[(f(),Y(wt(Ue.value?l(is):l(za))))]),_:1})]),_:1},8,["class"]),t(l(Ge),{circle:"",size:"small",onClick:v[1]||(v[1]=C=>Pe()),class:ge([{"refresh-button-animated":he.value},"action-button refresh-button"])},{default:a(()=>[P.value?(f(),Y(J,{key:1},{default:a(()=>[t(l(Ba))]),_:1})):(f(),Y(J,{key:0},{default:a(()=>[t(l(us))]),_:1}))]),_:1},8,["class"])])]),fe.value&&!U.value?(f(),$("div",oi,[e("div",ni,[e("div",ii,[t(l(Nt),{modelValue:V.value,"onUpdate:modelValue":v[2]||(v[2]=C=>V.value=C),placeholder:"é€‰æ‹©ä½œè€…",multiple:"",clearable:"",filterable:"",class:"filter-input",size:"small"},{prefix:a(()=>v[14]||(v[14]=[e("span",{class:"compact-label"},"ä½œè€…",-1)])),default:a(()=>[(f(!0),$(be,null,Be(K.value,C=>(f(),Y(l(It),{key:C,label:C,value:C},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e("div",ri,[t(l(Nt),{modelValue:Q.value,"onUpdate:modelValue":v[3]||(v[3]=C=>Q.value=C),placeholder:"é€‰æ‹©åˆ†æ”¯",multiple:"",clearable:"",filterable:"",class:"filter-input",size:"small"},{prefix:a(()=>v[15]||(v[15]=[e("span",{class:"compact-label"},"åˆ†æ”¯",-1)])),default:a(()=>[(f(!0),$(be,null,Be(le.value,C=>(f(),Y(l(It),{key:C,label:C,value:C},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),e("div",ci,[t(l(fs),{modelValue:T.value,"onUpdate:modelValue":v[4]||(v[4]=C=>T.value=C),placeholder:"æäº¤ä¿¡æ¯å…³é”®è¯",clearable:"",class:"filter-input",size:"small"},{prefix:a(()=>v[16]||(v[16]=[e("span",{class:"compact-label"},"ä¿¡æ¯",-1)])),_:1},8,["modelValue"])]),e("div",ui,[t(l(Fa),{modelValue:se.value,"onUpdate:modelValue":v[5]||(v[5]=C=>se.value=C),type:"daterange","range-separator":"è‡³","start-placeholder":"å¼€å§‹æ—¥æœŸ","end-placeholder":"ç»“æŸæ—¥æœŸ",format:"YYYY-MM-DD","value-format":"YYYY-MM-DD",class:"filter-input date-range",size:"small"},{prefix:a(()=>v[17]||(v[17]=[e("span",{class:"compact-label"},"æ—¥æœŸ",-1)])),_:1},8,["modelValue"])]),e("div",di,[t(l(Ge),{type:"primary",size:"small",onClick:re,class:"filter-action-button"},{default:a(()=>v[18]||(v[18]=[w("åº”ç”¨")])),_:1}),t(l(Ge),{type:"info",size:"small",onClick:je,class:"filter-action-button"},{default:a(()=>v[19]||(v[19]=[w("é‡ç½®")])),_:1})])])])):A("",!0),e("div",{class:ge(["content-area",{"with-filter":fe.value&&!U.value}])},[G.value?(f(),$("div",fi,B(G.value),1)):(f(),$("div",pi,[U.value?(f(),$("div",mi,[l(p).length>0?(f(),$("div",vi," æ˜¾ç¤º "+B(l(p).length)+" æ¡æäº¤è®°å½• "+B(E.value?"(å…¨éƒ¨)":"(åˆ†é¡µåŠ è½½ï¼Œæ¯é¡µ20æ¡)"),1)):A("",!0),e("div",gi,[e("div",hi,[t(l(Ge),{type:"primary",circle:"",size:"small",onClick:L,disabled:Z.value<=Lt},{default:a(()=>[t(J,null,{default:a(()=>[t(l(Da))]),_:1})]),_:1},8,["disabled"]),t(l(Ra),{modelValue:Z.value,"onUpdate:modelValue":v[6]||(v[6]=C=>Z.value=C),min:Lt,max:Et,step:ns,onChange:r,class:"zoom-slider"},null,8,["modelValue"]),t(l(Ge),{type:"primary",circle:"",size:"small",onClick:Qe,disabled:Z.value>=Et},{default:a(()=>[t(J,null,{default:a(()=>[t(l(ja))]),_:1})]),_:1},8,["disabled"]),t(l(Ge),{type:"primary",size:"small",onClick:N},{default:a(()=>v[20]||(v[20]=[w(" è‡ªé€‚åº”å¤§å° ")])),_:1})]),e("div",yi," ç¼©æ”¾: "+B(Math.round(Z.value*100))+"% ",1)]),e("div",{ref_key:"graphContainer",ref:I,class:"graph-container"},null,512)])):(f(),$("div",_i,[Xe((f(),Y(l(Os),{ref_key:"tableRef",ref:pe,data:ae.value,stripe:"",border:"",class:"log-table","empty-text":P.value?"åŠ è½½ä¸­...":"æ²¡æœ‰åŒ¹é…çš„æäº¤è®°å½•",height:"450",onRowContextmenu:He},{default:a(()=>[t(l(zt),{label:"å“ˆå¸Œ",width:"80",resizable:""},{default:a(C=>[e("span",{class:"commit-hash",onClick:ve=>H(C.row)},B(C.row.hash.substring(0,6)),9,wi)]),_:1}),t(l(zt),{label:"æäº¤ä¿¡æ¯","min-width":"300"},{default:a(C=>[e("div",ki,[e("div",$i,[C.row.branch?(f(),$("div",bi,[(f(!0),$(be,null,Be(C.row.branch.split(","),(ve,Ee)=>(f(),Y(l(Dt),{key:Ee,size:"small",type:_(ve),class:"branch-tag"},{default:a(()=>[w(B(De(ve)),1)]),_:2},1032,["type"]))),128))])):A("",!0),e("span",Ci,B(C.row.message),1),t(l(Ge),{type:"text",icon:l(Bt),size:"small",onClick:qe(ve=>ke(C.row.message),["stop"]),class:"copy-message-btn",title:"å¤åˆ¶çº¯å‡€æäº¤ä¿¡æ¯ï¼ˆä¸å«ç±»å‹å‰ç¼€ï¼‰"},null,8,["icon","onClick"])])])]),_:1}),t(l(zt),{prop:"date",label:"æ—¥æœŸ",width:"150",resizable:""}),t(l(zt),{label:"ä½œè€…",width:"100",resizable:""},{default:a(C=>[t(u,{content:C.row.email,placement:"top","hide-after":1e3,"show-after":200},{default:a(()=>[e("span",Si,B(C.row.author),1)]),_:2},1032,["content"])]),_:1})]),_:1},8,["data","empty-text"])),[[d,P.value]]),(E.value,A("",!0))]))]))],2),t(Ft,{modelValue:ce.value,"onUpdate:modelValue":v[7]||(v[7]=C=>ce.value=C),title:`æäº¤è¯¦æƒ…: ${(z=S.value)!=null&&z.hash?S.value.hash.substring(0,7):"æœªçŸ¥"}`,size:"extra-large",type:"flex","destroy-on-close":"","custom-class":"commit-detail-dialog"},{default:a(()=>[Xe((f(),$("div",Ti,[S.value?(f(),$("div",Vi,[e("div",xi,[e("div",Li,[v[24]||(v[24]=e("span",{class:"item-label"},"å“ˆå¸Œ:",-1)),e("span",zi,B(S.value.hash),1)]),e("div",Bi,[v[25]||(v[25]=e("span",{class:"item-label"},"ä½œè€…:",-1)),e("span",Fi,B(S.value.author)+" <"+B(S.value.email)+">",1)]),e("div",Di,[v[26]||(v[26]=e("span",{class:"item-label"},"æ—¥æœŸ:",-1)),e("span",Ri,B(S.value.date),1)])]),e("div",ji,[v[27]||(v[27]=e("div",{class:"message-label"},"æäº¤ä¿¡æ¯:",-1)),e("div",{class:"message-content",innerHTML:l(Ja)(S.value.message).replace(/\n/g,"<br>")},null,8,Gi)])])):A("",!0),t(ms,{files:W.value,loading:X.value,diffContent:F.value,selectedFile:j.value,emptyText:"æ²¡æœ‰æ‰¾åˆ°å˜æ›´æ–‡ä»¶",onFileSelect:Re},null,8,["files","loading","diffContent","selectedFile"])])),[[d,X.value]])]),_:1},8,["modelValue","title"])],2),Xe(e("div",{class:ge(["context-menu",{"fullscreen-context-menu":Ue.value}]),style:dt({top:Te.value+"px",left:h.value+"px"})},[e("div",{class:"context-menu-item",onClick:v[8]||(v[8]=C=>H(g.value))},v[28]||(v[28]=[e("i",{class:"el-icon-view"},null,-1),w(" æŸ¥çœ‹è¯¦æƒ… ")])),e("div",{class:"context-menu-item",onClick:v[9]||(v[9]=C=>vt(g.value))},v[29]||(v[29]=[e("i",{class:"el-icon-document-copy"},null,-1),w(" å¤åˆ¶æäº¤å“ˆå¸Œ ")])),e("div",{class:"context-menu-item",onClick:v[10]||(v[10]=C=>Ct(g.value))},v[30]||(v[30]=[e("i",{class:"el-icon-refresh-right"},null,-1),w(" é‡ç½®åˆ°è¯¥æäº¤(hard) ")])),e("div",{class:"context-menu-item",onClick:v[11]||(v[11]=C=>q(g.value))},v[31]||(v[31]=[e("i",{class:"el-icon-delete"},null,-1),w(" æ’¤é”€æäº¤ (Revert) ")])),e("div",{class:"context-menu-item",onClick:v[12]||(v[12]=C=>Oe(g.value))},v[32]||(v[32]=[e("i",{class:"el-icon-edit"},null,-1),w(" Cherry-Pick åˆ°å½“å‰åˆ†æ”¯ ")]))],6),[[ft,ye.value]])],64)}}}),Ui=mt(Oi,[["__scopeId","data-v-23fcbd9b"]]),Ai={class:"dialog-content"},Pi={class:"dialog-toolbar"},Ei={class:"history-scroll"},Mi={key:0,class:"loading-state"},Ii={key:2,class:"history-list"},Ni=["onClick"],Hi={class:"command-info"},Ji={class:"command-text"},Wi={class:"command-meta"},qi={class:"timestamp"},Yi={class:"duration"},Xi={class:"item-actions"},Ki={key:0,class:"item-details"},Zi={key:0,class:"output-section"},Qi={class:"output-header"},er={class:"output-content"},tr={key:0,class:"truncation-notice"},sr={class:"output-header"},ar={class:"output-content"},lr={key:0,class:"truncation-notice"},or={key:2,class:"output-section error"},nr={class:"output-content"},ir=pt({__name:"CommandHistory",setup(te){const i=kt(),m=c([]),p=c(!1),y=c(!1),G=c(!1),R=c(!1),P=c(new Set),E=c(!1),M=c(!1);function U(){M.value=!0,m.value.length===0&&I()}async function I(){try{if(p.value=!0,i.socket&&i.socket.connected)i.socket.emit("request_full_history");else{const T=await(await fetch("/api/command-history")).json();T.success?m.value=T.history:o.error(`åŠ è½½å‘½ä»¤å†å²å¤±è´¥: ${T.error}`)}}catch(V){o.error(`åŠ è½½å‘½ä»¤å†å²å¤±è´¥: ${V.message}`)}finally{p.value=!1}}async function ie(){if(m.value.length===0){o.warning("æ²¡æœ‰å¯å¤åˆ¶çš„å‘½ä»¤å†å²");return}try{G.value=!0;const V=m.value.map(T=>{let se=`# ${ue(T.timestamp)} (è€—æ—¶: ${ce(T.executionTime)}) - ${T.success?"æˆåŠŸ":"å¤±è´¥"}
`;if(se+=`${T.command}
`,T.stdout&&(se+=`
# è¾“å‡º:
${T.stdout}
`),T.stderr){const K=j(T.command)?"è¾“å‡ºä¿¡æ¯":"é”™è¯¯è¾“å‡º";se+=`
# ${K}:
${T.stderr}
`}return T.error&&(se+=`
# é”™è¯¯ä¿¡æ¯:
${T.error}
`),se}).join(`
---

`);await navigator.clipboard.writeText(V),o.success("å‘½ä»¤å†å²å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch(V){o.error(`å¤åˆ¶å¤±è´¥: ${V.message}`)}finally{G.value=!1}}async function O(){if(m.value.length===0){o.warning("æ²¡æœ‰å¯å¤åˆ¶çš„å‘½ä»¤");return}try{E.value=!0;const V=m.value.map(T=>T.command).join(`
`);await navigator.clipboard.writeText(V),o.success("å‘½ä»¤åˆ—è¡¨å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch(V){o.error(`å¤åˆ¶å¤±è´¥: ${V.message}`)}finally{E.value=!1}}async function ne(){try{if(await Me.confirm("ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å‘½ä»¤å†å²è®°å½•å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ¢å¤ã€‚","æ¸…ç©ºå‘½ä»¤å†å²",{confirmButtonText:"ç¡®å®š",cancelButtonText:"å–æ¶ˆ",type:"warning"}),y.value=!0,i.socket&&i.socket.connected)i.socket.emit("clear_command_history");else{const T=await(await fetch("/api/clear-command-history",{method:"POST",headers:{"Content-Type":"application/json"}})).json();T.success?(m.value=[],o.success("å‘½ä»¤å†å²å·²æ¸…ç©º")):o.error(`æ¸…ç©ºå‘½ä»¤å†å²å¤±è´¥: ${T.error}`)}}catch(V){V!=="cancel"&&V.toString()!=="Error: cancel"&&o.error(`æ¸…ç©ºå‘½ä»¤å†å²å¤±è´¥: ${V.message}`)}finally{y.value=!1}}function ue(V){return new Date(V).toLocaleString()}function ce(V){return V<1e3?`${V}ms`:`${(V/1e3).toFixed(2)}s`}function S(V){P.value.has(V)?P.value.delete(V):P.value.add(V)}function D(V){return P.value.has(V)}async function F(V){try{await navigator.clipboard.writeText(V),o.success("å‘½ä»¤å·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch(T){o.error(`å¤åˆ¶å¤±è´¥: ${T.message}`)}}function X(V){return V.includes("git push")||V.includes("git-push")}function j(V){return!!X(V)}async function Z(V){try{let T="";if(V.stdout&&(T+=`æ ‡å‡†è¾“å‡º:
${V.stdout}

`),V.stderr){const se=j(V.command)?"è¾“å‡ºä¿¡æ¯":"é”™è¯¯è¾“å‡º";T+=`${se}:
${V.stderr}

`}V.error&&(T+=`é”™è¯¯ä¿¡æ¯:
${V.error}`),await navigator.clipboard.writeText(T.trim()),o.success("è¾“å‡ºå·²å¤åˆ¶åˆ°å‰ªè´´æ¿")}catch(T){o.error(`å¤åˆ¶å¤±è´¥: ${T.message}`)}}function he(){if(!i.socket){console.error("Socketå®ä¾‹ä¸å¯ç”¨");return}i.socket.on("initial_command_history",V=>{m.value=V.history,R.value=!0}),i.socket.on("command_history_update",V=>{m.value.unshift(V.newCommand),m.value.length>100&&m.value.pop(),R.value=!0}),i.socket.on("full_command_history",V=>{m.value=V.history,p.value=!1,R.value=!0}),i.socket.on("command_history_cleared",V=>{V.success&&(m.value=[],o.success("å‘½ä»¤å†å²å·²æ¸…ç©º")),y.value=!1}),i.socket.on("connect",()=>{R.value=!0,o.success("å·²è¿æ¥åˆ°å®æ—¶å‘½ä»¤å†å²")}),i.socket.on("disconnect",()=>{R.value=!1,o.warning("å®æ—¶å‘½ä»¤å†å²è¿æ¥å·²æ–­å¼€")})}function fe(){i.socket&&(i.socket.off("initial_command_history"),i.socket.off("command_history_update"),i.socket.off("full_command_history"),i.socket.off("command_history_cleared"))}return $t(()=>{he(),i.socket||(console.log("å°è¯•åˆå§‹åŒ–Socketè¿æ¥"),i.initSocketConnection())}),Vs(()=>{fe()}),(V,T)=>{const se=Ge,K=Dt,Q=bt,le=Mt,ye=ds,Te=Jt;return f(),$(be,null,[t(se,{type:"primary",icon:l(Oa),onClick:U,class:"command-history-button",title:"æŸ¥çœ‹Gitå‘½ä»¤å†å²"},{default:a(()=>T[1]||(T[1]=[w(" å‘½ä»¤å†å² ")])),_:1},8,["icon"]),(f(),Y(Ua,{to:"body"},[t(Te,{modelValue:M.value,"onUpdate:modelValue":T[0]||(T[0]=h=>M.value=h),title:"Git å‘½ä»¤å†å²",width:"80%",top:"5vh","destroy-on-close":"",class:"command-history-dialog","z-index":99999,"append-to-body":"",modal:""},{default:a(()=>[e("div",Ai,[e("div",Pi,[t(K,{type:R.value?"success":"danger",size:"small",effect:"dark",class:"socket-status"},{default:a(()=>[w(B(R.value?"å®æ—¶æ›´æ–°":"æœªè¿æ¥"),1)]),_:1},8,["type"]),t(se,{type:"success",icon:l(Bt),circle:"",size:"small",onClick:O,loading:E.value,class:"copy-commands-button",title:"åªå¤åˆ¶å‘½ä»¤åˆ—è¡¨ï¼ˆä¸å«è¾“å‡ºï¼‰",disabled:m.value.length===0},null,8,["icon","loading","disabled"]),t(se,{type:"primary",icon:l(Bt),circle:"",size:"small",onClick:ie,loading:G.value,class:"copy-all-button",title:"å¤åˆ¶å®Œæ•´å‘½ä»¤å†å²ï¼ˆå«è¾“å‡ºï¼‰",disabled:m.value.length===0},null,8,["icon","loading","disabled"]),t(se,{type:"danger",icon:l(Ds),circle:"",size:"small",onClick:ne,loading:y.value,class:"clear-button",title:"æ¸…ç©ºå‘½ä»¤å†å²",disabled:m.value.length===0},null,8,["icon","loading","disabled"])]),e("div",Ei,[p.value&&m.value.length===0?(f(),$("div",Mi,[t(Q,{class:"loading-icon is-loading"},{default:a(()=>T[2]||(T[2]=[e("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})],-1)])),_:1}),T[3]||(T[3]=e("div",{class:"loading-text"},"åŠ è½½å‘½ä»¤å†å²...",-1))])):m.value.length===0?(f(),Y(le,{key:1,description:"æš‚æ— å‘½ä»¤å†å²"})):(f(),$("div",Ii,[(f(!0),$(be,null,Be(m.value,(h,g)=>(f(),$("div",{key:g,class:ge(["history-item",{"is-error":!h.success}])},[e("div",{class:"item-header",onClick:ae=>S(g)},[e("div",Hi,[e("div",Ji,[t(K,{size:"small",type:h.success?"success":"danger",effect:"dark",class:"status-tag"},{default:a(()=>[w(B(h.success?"æˆåŠŸ":"å¤±è´¥"),1)]),_:2},1032,["type"]),e("code",null,B(h.command),1)]),e("div",Wi,[e("span",qi,B(ue(h.timestamp)),1),e("span",Yi,"è€—æ—¶: "+B(ce(h.executionTime)),1)])]),e("div",Xi,[t(se,{type:"primary",icon:l(Bt),circle:"",size:"small",onClick:qe(ae=>F(h.command),["stop"]),title:"å¤åˆ¶å‘½ä»¤"},null,8,["icon","onClick"]),t(se,{type:D(g)?"primary":"default",icon:D(g)?l(Fs):l(_t),circle:"",size:"small",onClick:qe(ae=>S(g),["stop"]),title:"å±•å¼€/æ”¶èµ·"},null,8,["type","icon","onClick"])])],8,Ni),D(g)?(f(),$("div",Ki,[h.stdout?(f(),$("div",Zi,[e("div",Qi,[T[4]||(T[4]=e("h4",null,"æ ‡å‡†è¾“å‡º",-1)),t(se,{type:"primary",icon:l(Bt),circle:"",size:"small",onClick:ae=>Z(h),title:"å¤åˆ¶è¾“å‡º"},null,8,["icon","onClick"])]),e("pre",er,B(h.stdout),1),h.isStdoutTruncated?(f(),$("div",tr,[t(ye,{type:"info",closable:!1,"show-icon":""},{default:a(()=>T[5]||(T[5]=[w(" è¾“å‡ºå†…å®¹è¿‡é•¿å·²è¢«æˆªæ–­ï¼Œè¯·ç›´æ¥æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹å®Œæ•´è¾“å‡º ")])),_:1})])):A("",!0)])):A("",!0),h.stderr?(f(),$("div",{key:1,class:ge(["output-section",j(h.command)?"":"error"])},[e("div",sr,[e("h4",null,B(j(h.command)?"è¾“å‡ºä¿¡æ¯":"é”™è¯¯è¾“å‡º"),1)]),e("pre",ar,B(h.stderr),1),h.isStderrTruncated?(f(),$("div",lr,[t(ye,{type:"info",closable:!1,"show-icon":""},{default:a(()=>[w(B(j(h.command)?"è¾“å‡ºä¿¡æ¯":"é”™è¯¯è¾“å‡º")+"å†…å®¹è¿‡é•¿å·²è¢«æˆªæ–­ï¼Œè¯·ç›´æ¥æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹å®Œæ•´è¾“å‡º ",1)]),_:2},1024)])):A("",!0)],2)):A("",!0),h.error?(f(),$("div",or,[T[6]||(T[6]=e("div",{class:"output-header"},[e("h4",null,"é”™è¯¯ä¿¡æ¯")],-1)),e("pre",nr,B(h.error),1)])):A("",!0)])):A("",!0)],2))),128))]))])])]),_:1},8,["modelValue"])]))],64)}}}),rr=mt(ir,[["__scopeId","data-v-234c209d"]]),cr="data:image/svg+xml,%3csvg%20width='200'%20height='200'%20viewBox='0%200%20200%20200'%20xmlns='http://www.w3.org/2000/svg'%3e%3c!--%20ä¸»åˆ†æ”¯%20--%3e%3cline%20x1='40'%20y1='40'%20x2='40'%20y2='160'%20stroke='%2334495e'%20stroke-width='8'%20stroke-linecap='round'%20/%3e%3c!--%20ç‰¹æ€§åˆ†æ”¯%20--%3e%3cpath%20d='M40,70%20C60,70%2080,90%2080,110%20L80,130'%20stroke='%233498db'%20stroke-width='8'%20stroke-linecap='round'%20stroke-linejoin='round'%20fill='none'%20/%3e%3c!--%20å¼€å‘åˆ†æ”¯%20--%3e%3cpath%20d='M40,100%20C60,100%20100,110%20100,130%20L100,160'%20stroke='%232ecc71'%20stroke-width='8'%20stroke-linecap='round'%20stroke-linejoin='round'%20fill='none'%20/%3e%3c!--%20ä¿®å¤åˆ†æ”¯%20--%3e%3cpath%20d='M40,130%20C60,130%20120,140%20120,160'%20stroke='%23e74c3c'%20stroke-width='8'%20stroke-linecap='round'%20stroke-linejoin='round'%20fill='none'%20/%3e%3c!--%20åˆå¹¶ç‚¹%20--%3e%3cpath%20d='M80,130%20C80,145%2060,145%2040,145'%20stroke='%233498db'%20stroke-width='8'%20stroke-linecap='round'%20stroke-linejoin='round'%20fill='none'%20/%3e%3c!--%20èŠ‚ç‚¹%20--%3e%3ccircle%20cx='40'%20cy='40'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='70'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='100'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='130'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='145'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='160'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='80'%20cy='130'%20r='10'%20fill='%233498db'%20/%3e%3ccircle%20cx='100'%20cy='160'%20r='10'%20fill='%232ecc71'%20/%3e%3ccircle%20cx='120'%20cy='160'%20r='10'%20fill='%23e74c3c'%20/%3e%3c/svg%3e",ur={class:"main-header"},dr={class:"header-left"},fr=["src"],pr={class:"header-info"},mr={key:0,id:"user-info"},vr={class:"user-name"},gr={class:"user-email"},hr={key:1,id:"user-info"},yr={class:"directory-selector"},_r={class:"directory-display"},wr={class:"directory-icon"},kr=["title"],$r={class:"directory-actions"},br={key:2,class:"command-history-section"},Cr={class:"main-container"},Sr={key:0,class:"loading-container"},Tr={class:"loading-spinner"},Vr={key:1,class:"grid-layout"},xr={class:"git-status-panel"},Lr={key:0,class:"commit-form-panel"},zr={key:0,class:"card"},Br={class:"tips"},Fr={key:1,class:"commit-form-panel"},Dr={key:2,class:"log-list-panel"},Rr={class:"dialog-footer"},jr={class:"main-footer"},Gr={key:0,class:"branch-info"},Or={class:"branch-wrapper"},Ur={key:1,class:"footer-right"},Ar={class:"repo-url"},Pr={class:"dialog-footer"},Er={class:"directory-input-group"},Mr={class:"recent-directories"},Ir={class:"dialog-footer"},Nr=pt({__name:"App",setup(te){const i=c(""),m=c(null),p=c(null),y=kt(),G=ps(),R=c(!1),P=c("");function E(){G.config&&(i.value=`é»˜è®¤æäº¤ä¿¡æ¯: ${G.config.defaultCommitMessage}`)}async function M(){try{const r=await(await fetch("/api/current_directory")).json();return P.value=r.directory||"æœªçŸ¥ç›®å½•",r}catch(L){return console.error("è·å–å½“å‰ç›®å½•å¤±è´¥:",L),{directory:"æœªçŸ¥ç›®å½•",isGitRepo:!1}}}$t(async()=>{console.log("---------- é¡µé¢åˆå§‹åŒ–å¼€å§‹ ----------");try{const L=await M();G.isLoaded||await G.loadConfig(),E(),y.isGitRepo=L.isGitRepo===!0,y.lastCheckedTime=Date.now(),y.isGitRepo?await Promise.all([y.getCurrentBranch(!0),y.getAllBranches(),y.getUserInfo(),y.getRemoteUrl(),y.getBranchStatus(!0)]):o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“ï¼Œéƒ¨åˆ†åŠŸèƒ½å°†ä¸å¯ç”¨")}catch(L){console.error("åˆå§‹åŒ–å¤±è´¥:",L)}finally{R.value=!0,console.log("---------- é¡µé¢åˆå§‹åŒ–å®Œæˆ ----------"),setTimeout(()=>{ye()},100)}});const U=c(!1),I=c(""),ie=c("");async function O(){await y.createBranch(I.value,ie.value)&&(U.value=!1,I.value="",p.value&&p.value.refreshStatus(),m.value&&m.value.refreshLog())}function ne(){ie.value=y.currentBranch,U.value=!0}async function ue(L){await y.changeBranch(L)&&(p.value&&p.value.refreshStatus(),m.value&&m.value.refreshLog())}const ce=c(!1),S=c(""),D=c("");function F(){S.value=y.userName,D.value=y.userEmail,ce.value=!0}async function X(){if(!S.value||!D.value){o.warning("ç”¨æˆ·åå’Œé‚®ç®±ä¸èƒ½ä¸ºç©º");return}await y.restoreUserConfig(S.value,D.value)&&(ce.value=!1)}async function j(){await y.clearUserConfig()&&(S.value="",D.value="")}let Z=!1,he=!1,fe=!1,V=0,T=0,se="",K="",Q=null;function le(){const L=document.querySelector(".grid-layout");if(!L)return;const r=getComputedStyle(L).gridTemplateColumns.split(" "),N=getComputedStyle(L).gridTemplateRows.split(" ");if(r.length>=3&&N.length>=3){const H=parseFloat(r[0]),$e=parseFloat(r[2]),Re=H+$e,ke=H/Re,_e=parseFloat(N[0]),je=parseFloat(N[2]),re=_e+je,me=_e/re;localStorage.setItem("zen-gitsync-layout-left-ratio",ke.toString()),localStorage.setItem("zen-gitsync-layout-top-ratio",me.toString()),console.log(`å¸ƒå±€æ¯”ä¾‹å·²ä¿å­˜ - å·¦ä¾§: ${(ke*100).toFixed(0)}%, ä¸Šæ–¹: ${(me*100).toFixed(0)}%`),localStorage.setItem("zen-gitsync-layout-bottom-left-ratio",ke.toString()),console.log(`åº•éƒ¨å¸ƒå±€æ¯”ä¾‹å·²ä¿å­˜ - å·¦ä¾§: ${(ke*100).toFixed(0)}%`)}}function ye(){const L=document.querySelector(".grid-layout");if(!L)return;const r=localStorage.getItem("zen-gitsync-layout-left-ratio"),N=localStorage.getItem("zen-gitsync-layout-top-ratio");if(r){const H=parseFloat(r),$e=1-H;L.style.gridTemplateColumns=`${H}fr 8px ${$e}fr`,console.log(`å·²æ¢å¤å·¦ä¾§æ¯”ä¾‹: ${(H*100).toFixed(0)}%`)}else L.style.gridTemplateColumns="1fr 8px 3fr";if(N){const H=parseFloat(N),$e=1-H;L.style.gridTemplateRows=`${H}fr 8px ${$e}fr`,console.log(`å·²æ¢å¤ä¸Šæ–¹æ¯”ä¾‹: ${(H*100).toFixed(0)}%`)}}function Te(L){var H;const r=L.currentTarget;if(!r||!r.id)return;Q=r.id,Q==="v-resizer"?Z=!0:Q==="v-resizer-bottom"&&(he=!0),V=L.clientX;const N=document.querySelector(".grid-layout");se=getComputedStyle(N).gridTemplateColumns,(H=document.getElementById(Q))==null||H.classList.add("active"),document.addEventListener("mousemove",h),document.addEventListener("mouseup",g),L.preventDefault()}function h(L){if(!Z&&!he)return;const r=document.querySelector(".grid-layout"),N=L.clientX-V,H=se.split(" ");if(H.length>=3){const $e=parseFloat(H[0]),Re=parseFloat(H[2]),ke=$e+Re,_e=($e+N/r.clientWidth*ke)/ke,je=1-_e,re=.1,me=.5;_e<re?r.style.gridTemplateColumns=`${re}fr 8px ${1-re}fr`:_e>me?r.style.gridTemplateColumns=`${me}fr 8px ${1-me}fr`:r.style.gridTemplateColumns=`${_e}fr 8px ${je}fr`}}function g(){var L,r;Z=!1,he=!1,(L=document.getElementById("v-resizer"))==null||L.classList.remove("active"),(r=document.getElementById("v-resizer-bottom"))==null||r.classList.remove("active"),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",g),le()}function ae(L){var N;fe=!0,T=L.clientY;const r=document.querySelector(".grid-layout");K=getComputedStyle(r).gridTemplateRows,(N=document.getElementById("h-resizer"))==null||N.classList.add("active"),document.addEventListener("mousemove",W),document.addEventListener("mouseup",oe),L.preventDefault()}function W(L){if(!fe)return;const r=document.querySelector(".grid-layout"),N=L.clientY-T,H=K.split(" ");if(H.length>=3){const $e=parseFloat(H[0]),Re=parseFloat(H[2]),ke=$e+Re,_e=($e+N/r.clientHeight*ke)/ke,je=1-_e,re=.2,me=.8;_e<re?r.style.gridTemplateRows=`${re}fr 8px ${1-re}fr`:_e>me?r.style.gridTemplateRows=`${me}fr 8px ${1-me}fr`:r.style.gridTemplateRows=`${_e}fr 8px ${je}fr`}}function oe(){var L;fe=!1,(L=document.getElementById("h-resizer"))==null||L.classList.remove("active"),document.removeEventListener("mousemove",W),document.removeEventListener("mouseup",oe),le()}const ee=c(!1),Ce=c(""),Fe=c(!1),De=c([]);async function _(){if(!P.value){o.warning("å½“å‰ç›®å½•è·¯å¾„ä¸ºç©º");return}try{await navigator.clipboard.writeText(P.value),o.success("å·²å¤åˆ¶ç›®å½•è·¯å¾„")}catch(L){console.error("å¤åˆ¶ç›®å½•è·¯å¾„å¤±è´¥:",L),o.error(`å¤åˆ¶å¤±è´¥: ${L.message}`)}}function pe(){Ce.value=P.value,ee.value=!0,Se()}async function Se(){try{const r=await(await fetch("/api/recent_directories")).json();r.success&&Array.isArray(r.directories)&&(De.value=r.directories)}catch(L){console.error("è·å–æœ€è¿‘ç›®å½•å¤±è´¥:",L)}}async function Le(){if(!Ce.value){o.warning("ç›®å½•è·¯å¾„ä¸èƒ½ä¸ºç©º");return}try{Fe.value=!0;const r=await(await fetch("/api/change_directory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:Ce.value})})).json();r.success?(o.success("å·²åˆ‡æ¢å·¥ä½œç›®å½•"),P.value=r.directory,ee.value=!1,await ze(r.directory),await Se(),y.isGitRepo=r.isGitRepo,await G.loadConfig(!0),r.isGitRepo?(await Promise.all([y.getCurrentBranch(),y.getAllBranches(),y.getUserInfo(),y.getRemoteUrl()]),p.value&&p.value.refreshStatus(),m.value&&m.value.refreshLog()):(o.warning("å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“ï¼Œéƒ¨åˆ†åŠŸèƒ½å°†ä¸å¯ç”¨"),y.$reset())):o.error(r.error||"åˆ‡æ¢ç›®å½•å¤±è´¥")}catch(L){o.error(`åˆ‡æ¢ç›®å½•å¤±è´¥: ${L.message}`)}finally{Fe.value=!1}}async function ze(L){try{await fetch("/api/save_recent_directory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:L})})}catch(r){console.error("ä¿å­˜æœ€è¿‘ç›®å½•å¤±è´¥:",r)}}async function Ke(){try{if(!P.value){o.warning("å½“å‰ç›®å½•è·¯å¾„ä¸ºç©º");return}const r=await(await fetch("/api/open_directory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({path:P.value})})).json();r.success?o.success("å·²åœ¨æ–‡ä»¶ç®¡ç†å™¨ä¸­æ‰“å¼€ç›®å½•"):r.error&&o.error(r.error)}catch(L){console.error("æ‰“å¼€ç›®å½•å¤±è´¥:",L),o.error(`æ‰“å¼€ç›®å½•å¤±è´¥: ${L.message}`)}}async function Ze(){try{const r=await(await fetch("/api/browse_directory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPath:Ce.value||P.value})})).json();r.success?Pe(r):r.error&&o.error(r.error)}catch(L){console.error("æµè§ˆç›®å½•å¤±è´¥:",L),o.error(`æµè§ˆç›®å½•å¤±è´¥: ${L.message}`)}}function Pe(L){!L||!L.items||Me.alert(Ae("div",{class:"directory-browser"},[Ae("div",{class:"current-path"},[Ae("span",{class:"path-label"},"å½“å‰è·¯å¾„: "),Ae("span",{class:"path-value"},L.path)]),Ae("div",{class:"directory-list"},[L.parentPath?Ae("div",{class:"directory-item parent-dir",onClick:()=>{Qe(L.parentPath)}},[Ae("span",{class:"dir-icon"},Ae("svg",{class:"folder-icon",viewBox:"0 0 24 24",width:"20",height:"20",style:{fill:"#E6A23C"}},[Ae("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"})])),Ae("span",{class:"dir-name"},"è¿”å›ä¸Šçº§ç›®å½•")]):null,...L.items.map(r=>Ae("div",{class:"directory-item",onClick:()=>{Qe(r.path)}},[Ae("span",{class:"dir-icon"},Ae("svg",{class:"folder-icon",viewBox:"0 0 24 24",width:"20",height:"20",style:{fill:"#409EFF"}},[Ae("path",{d:"M10 4H4c-1.1 0-1.99.9-1.99 2L2 18c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V8c0-1.1-.9-2-2-2h-8l-2-2z"})])),Ae("span",{class:"dir-name"},r.name)]))])]),"æµè§ˆå¹¶é€‰æ‹©ç›®å½•",{confirmButtonText:"ä½¿ç”¨å½“å‰ç›®å½•",customClass:"directory-browser-dialog",callback:r=>{r==="confirm"&&(Ce.value=L.path)}})}async function Qe(L){try{Me.close(),setTimeout(async()=>{try{const N=await(await fetch("/api/browse_directory",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPath:L})})).json();N.success?Pe(N):N.error&&o.error(N.error)}catch(r){console.error("æµè§ˆç›®å½•å¤±è´¥:",r),o.error(`æµè§ˆç›®å½•å¤±è´¥: ${r.message}`)}},100)}catch(r){console.error("å¤„ç†ç›®å½•é€‰æ‹©æ—¶å‡ºé”™:",r),o.error(`å¤„ç†ç›®å½•é€‰æ‹©æ—¶å‡ºé”™: ${r.message}`)}}return(L,r)=>{const N=bt,H=Ge,$e=Rs,Re=fs,ke=Gs,_e=It,je=Nt,re=js,me=Jt,Ne=ds,He=Dt;return f(),$(be,null,[e("header",ur,[e("div",dr,[e("img",{src:l(cr),alt:"Zen GitSync Logo",class:"logo"},null,8,fr),r[14]||(r[14]=e("h1",null,"Zen GitSync UI",-1))]),e("div",pr,[l(y).userName&&l(y).userEmail?(f(),$("div",mr,[r[15]||(r[15]=e("span",{class:"user-label"},"ç”¨æˆ·:",-1)),e("span",vr,B(l(y).userName),1),e("span",gr,"<"+B(l(y).userEmail)+">",1),t(H,{type:"primary",size:"small",onClick:F,class:"user-settings-btn",circle:""},{default:a(()=>[t(N,null,{default:a(()=>[t(l(Cs))]),_:1})]),_:1})])):(f(),$("div",hr,[r[16]||(r[16]=e("span",{class:"user-label"},"ç”¨æˆ·: ",-1)),r[17]||(r[17]=e("span",{class:"user-warning"},"æœªé…ç½®",-1)),t(H,{type:"primary",size:"small",onClick:F,class:"user-settings-btn",circle:""},{default:a(()=>[t(N,null,{default:a(()=>[t(l(Cs))]),_:1})]),_:1})])),e("div",yr,[e("div",_r,[e("div",wr,[t(N,null,{default:a(()=>[t(l(Ss))]),_:1})]),e("div",{class:"directory-path",title:P.value},B(P.value),9,kr)]),e("div",$r,[t(H,{type:"primary",size:"small",onClick:pe,class:"dir-button",circle:"",title:"åˆ‡æ¢ç›®å½•"},{default:a(()=>[t(N,null,{default:a(()=>r[18]||(r[18]=[e("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"currentColor",d:"M128 192v640h768V320H485.76L357.504 192H128zm-32-64h287.872l128.384 128H928a32 32 0 0 1 32 32v576a32 32 0 0 1-32 32H96a32 32 0 0 1-32-32V160a32 32 0 0 1 32-32z"})],-1)])),_:1})]),_:1}),t(H,{type:"success",size:"small",onClick:Ke,class:"dir-button",circle:"",title:"åœ¨èµ„æºç®¡ç†å™¨ä¸­æ‰“å¼€"},{default:a(()=>[t(N,null,{default:a(()=>r[19]||(r[19]=[e("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"currentColor",d:"M928 444H820V330.4c0-17.7-14.3-32-32-32H473L355.7 186.2a8.15 8.15 0 0 0-5.5-2.2H96c-17.7 0-32 14.3-32 32v592c0 17.7 14.3 32 32 32h698c13 0 24.8-7.9 29.7-20l134-332c1.5-3.8 2.3-7.9 2.3-12 0-17.7-14.3-32-32-32zM136 256h188.5l119.6 114.4H748V444H238c-13 0-24.8 7.9-29.7 20L136 643.2V256zm635.3 512H159l103.3-256h612.4L771.3 768z"})],-1)])),_:1})]),_:1}),t(H,{type:"info",size:"small",onClick:_,class:"dir-button",circle:"",title:"å¤åˆ¶è·¯å¾„"},{default:a(()=>[t(N,null,{default:a(()=>r[20]||(r[20]=[e("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"currentColor",d:"M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64h64z"}),e("path",{fill:"currentColor",d:"M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64H384zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64z"})],-1)])),_:1})]),_:1})])]),l(y).isGitRepo?(f(),$("div",br,[t(rr)])):A("",!0)])]),e("main",Cr,[R.value?(f(),$("div",Vr,[e("div",xr,[t(no,{ref_key:"gitStatusRef",ref:p,"initial-directory":P.value},null,8,["initial-directory"])]),e("div",{class:"vertical-resizer",id:"v-resizer",onMousedown:Te},null,32),l(y).isGitRepo?(f(),$("div",Lr,[!l(y).userName||!l(y).userEmail?(f(),$("div",zr,[r[26]||(r[26]=e("h2",null,"Gitç”¨æˆ·æœªé…ç½®",-1)),r[27]||(r[27]=e("p",null,"è¯·å…ˆé…ç½®Gitç”¨æˆ·ä¿¡æ¯æ‰èƒ½è¿›è¡Œæäº¤æ“ä½œã€‚",-1)),e("div",Br,[r[24]||(r[24]=e("h3",null,"æ‚¨å¯ä»¥é€šè¿‡ä»¥ä¸‹æ–¹å¼é…ç½®ï¼š",-1)),r[25]||(r[25]=e("ol",null,[e("li",null,"ç‚¹å‡»å³ä¸Šè§’çš„è®¾ç½®æŒ‰é’®ï¼Œé…ç½®ç”¨æˆ·åå’Œé‚®ç®±"),e("li",null,"æˆ–è€…ä½¿ç”¨å‘½ä»¤è¡Œé…ç½®ï¼š"),e("div",{class:"code-block"},[w(' git config --global user.name "æ‚¨çš„ç”¨æˆ·å"'),e("br"),w(' git config --global user.email "æ‚¨çš„é‚®ç®±" ')])],-1)),t(H,{type:"primary",onClick:F},{default:a(()=>r[23]||(r[23]=[w(" ç«‹å³é…ç½® ")])),_:1})])])):(f(),Y(si,{key:1}))])):(f(),$("div",Fr,r[28]||(r[28]=[e("div",{class:"card",style:{padding:"20px"}},[e("h2",null,"Gitä»“åº“åˆå§‹åŒ–"),e("p",null,"å½“å‰ç›®å½•ä¸æ˜¯Gitä»“åº“ï¼Œè¯·å…ˆåˆå§‹åŒ–Gitä»“åº“æˆ–åˆ‡æ¢åˆ°Gitä»“åº“ç›®å½•ã€‚"),e("div",{class:"tips"},[e("h3",null,"å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤åˆå§‹åŒ–ä»“åº“ï¼š"),e("div",{class:"code-block"},"git init")])],-1)]))),e("div",{class:"horizontal-resizer",id:"h-resizer",onMousedown:ae},null,32),l(y).isGitRepo?(f(),$("div",Dr,[t(Ui,{ref_key:"logListRef",ref:m},null,512)])):A("",!0),t(me,{modelValue:U.value,"onUpdate:modelValue":r[3]||(r[3]=q=>U.value=q),title:"åˆ›å»ºæ–°åˆ†æ”¯",width:"30%","destroy-on-close":""},{footer:a(()=>[e("span",Rr,[t(H,{onClick:r[2]||(r[2]=q=>U.value=!1)},{default:a(()=>r[29]||(r[29]=[w("å–æ¶ˆ")])),_:1}),t(H,{type:"primary",onClick:O,loading:l(y).isCreatingBranch},{default:a(()=>r[30]||(r[30]=[w(" åˆ›å»º ")])),_:1},8,["loading"])])]),default:a(()=>[t(re,{model:{newBranchName:I.value,selectedBaseBranch:ie.value}},{default:a(()=>[t(ke,{label:"æ–°åˆ†æ”¯åç§°"},{default:a(()=>[t(Re,{modelValue:I.value,"onUpdate:modelValue":r[0]||(r[0]=q=>I.value=q),placeholder:"è¯·è¾“å…¥æ–°åˆ†æ”¯åç§°"},null,8,["modelValue"])]),_:1}),t(ke,{label:"åŸºäºåˆ†æ”¯"},{default:a(()=>[t(je,{modelValue:ie.value,"onUpdate:modelValue":r[1]||(r[1]=q=>ie.value=q),placeholder:"é€‰æ‹©åŸºç¡€åˆ†æ”¯",style:{width:"100%"}},{default:a(()=>[(f(!0),$(be,null,Be(l(y).allBranches,q=>(f(),Y(_e,{key:q,label:q,value:q},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])):(f(),$("div",Sr,[t($e,{class:"loading-card"},{default:a(()=>[e("div",Tr,[t(N,{class:"is-loading"},{default:a(()=>r[21]||(r[21]=[e("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})],-1)])),_:1})]),r[22]||(r[22]=e("div",{class:"loading-text"},"åŠ è½½ä¸­...",-1))]),_:1})]))]),e("footer",jr,[l(y).currentBranch?(f(),$("div",Gr,[e("div",Or,[r[32]||(r[32]=e("span",{class:"branch-label"},"å½“å‰åˆ†æ”¯:",-1)),t(je,{modelValue:l(y).currentBranch,"onUpdate:modelValue":r[4]||(r[4]=q=>l(y).currentBranch=q),size:"small",onChange:ue,loading:l(y).isChangingBranch,class:"branch-select"},{default:a(()=>[(f(!0),$(be,null,Be(l(y).allBranches,q=>(f(),Y(_e,{key:q,label:q,value:q},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),t(H,{type:"primary",size:"small",onClick:ne,class:"create-branch-btn"},{default:a(()=>[t(N,null,{default:a(()=>[t(l(Aa))]),_:1}),r[31]||(r[31]=w(" æ–°å»ºåˆ†æ”¯ "))]),_:1})])])):A("",!0),l(y).remoteUrl?(f(),$("div",Ur,[r[34]||(r[34]=e("span",{class:"repo-url-label"},"è¿œç¨‹ä»“åº“:",-1)),e("span",Ar,B(l(y).remoteUrl),1),t(H,{type:"primary",circle:"",size:"small",onClick:r[5]||(r[5]=q=>l(y).copyRemoteUrl()),class:"copy-url-btn",title:"å¤åˆ¶ä»“åº“åœ°å€"},{default:a(()=>[t(N,null,{default:a(()=>r[33]||(r[33]=[e("svg",{viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"currentColor",d:"M768 832a128 128 0 0 1-128 128H192A128 128 0 0 1 64 832V384a128 128 0 0 1 128-128v64a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64h64z"}),e("path",{fill:"currentColor",d:"M384 128a64 64 0 0 0-64 64v448a64 64 0 0 0 64 64h448a64 64 0 0 0 64-64V192a64 64 0 0 0-64-64H384zm0-64h448a128 128 0 0 1 128 128v448a128 128 0 0 1-128 128H384a128 128 0 0 1-128-128V192A128 128 0 0 1 384 64z"})],-1)])),_:1})]),_:1})])):A("",!0)]),t(me,{modelValue:ce.value,"onUpdate:modelValue":r[9]||(r[9]=q=>ce.value=q),title:"Gitç”¨æˆ·è®¾ç½®",width:"30%","destroy-on-close":""},{footer:a(()=>[e("span",Pr,[t(H,{type:"danger",onClick:j},{default:a(()=>r[36]||(r[36]=[w(" æ¸…é™¤é…ç½® ")])),_:1}),t(H,{onClick:r[8]||(r[8]=q=>ce.value=!1)},{default:a(()=>r[37]||(r[37]=[w("å–æ¶ˆ")])),_:1}),t(H,{type:"primary",onClick:X},{default:a(()=>r[38]||(r[38]=[w(" ä¿å­˜ ")])),_:1})])]),default:a(()=>[t(re,null,{default:a(()=>[t(ke,{label:"ç”¨æˆ·å"},{default:a(()=>[t(Re,{modelValue:S.value,"onUpdate:modelValue":r[6]||(r[6]=q=>S.value=q),placeholder:"è¯·è¾“å…¥Gitç”¨æˆ·å"},null,8,["modelValue"])]),_:1}),t(ke,{label:"é‚®ç®±"},{default:a(()=>[t(Re,{modelValue:D.value,"onUpdate:modelValue":r[7]||(r[7]=q=>D.value=q),placeholder:"è¯·è¾“å…¥Gité‚®ç®±"},null,8,["modelValue"])]),_:1}),t(ke,null,{default:a(()=>[t(Ne,{type:"info",closable:!1,"show-icon":""},{default:a(()=>r[35]||(r[35]=[w(" è¿™äº›è®¾ç½®å°†å½±å“å…¨å±€Gité…ç½®ï¼Œå¯¹æ‰€æœ‰Gitä»“åº“ç”Ÿæ•ˆã€‚ ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(me,{modelValue:ee.value,"onUpdate:modelValue":r[13]||(r[13]=q=>ee.value=q),title:"åˆ‡æ¢å·¥ä½œç›®å½•",width:"50%","destroy-on-close":""},{footer:a(()=>[e("span",Ir,[t(H,{onClick:r[11]||(r[11]=q=>ee.value=!1)},{default:a(()=>r[40]||(r[40]=[w("å–æ¶ˆ")])),_:1}),t(H,{type:"primary",onClick:r[12]||(r[12]=q=>Le()),loading:Fe.value},{default:a(()=>r[41]||(r[41]=[w(" åˆ‡æ¢ ")])),_:1},8,["loading"])])]),default:a(()=>[t(re,null,{default:a(()=>[t(ke,{label:"ç›®å½•è·¯å¾„"},{default:a(()=>[e("div",Er,[t(Re,{modelValue:Ce.value,"onUpdate:modelValue":r[10]||(r[10]=q=>Ce.value=q),placeholder:"è¯·è¾“å…¥ç›®å½•è·¯å¾„"},null,8,["modelValue"]),t(H,{type:"primary",onClick:Ze},{default:a(()=>[t(N,null,{default:a(()=>[t(l(Ss))]),_:1}),r[39]||(r[39]=w(" æµè§ˆ "))]),_:1})])]),_:1}),De.value.length>0?(f(),Y(ke,{key:0,label:"å¸¸ç”¨ç›®å½•"},{default:a(()=>[e("div",Mr,[(f(!0),$(be,null,Be(De.value,(q,Oe)=>(f(),Y(He,{key:Oe,class:"recent-dir-tag",onClick:vt=>Ce.value=q,effect:"plain"},{default:a(()=>[w(B(q),1)]),_:2},1032,["onClick"]))),128))])]),_:1})):A("",!0)]),_:1})]),_:1},8,["modelValue"])],64)}}}),Hr=mt(Nr,[["__scopeId","data-v-a5d01110"]]),Us=Pa(Hr);Us.use(Ea());Us.mount("#app");
