import{d as ee,r as o,o as te,c as _,a as m,b as l,e as G,f as s,E as q,u as B,g as je,t as k,F as H,h as J,i as re,w as d,j as he,v as ye,k as Be,l as Oe,m as i,n as Le,p as fe,q as Ne,s as Ae,x as Ee,y as _e,z as N,A as we,B as be,C as ve,D as F,G as Me,H as Pe,I as ze,J as Re,K as Z,L as De,M as Ie,N as Ue,O as Fe,P as Ge,Q as He,R as Je,S as We}from"./vendor-sACVc1mS.js";(function(){const E=document.createElement("link").relList;if(E&&E.supports&&E.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))g(a);new MutationObserver(a=>{for(const h of a)if(h.type==="childList")for(const S of h.addedNodes)S.tagName==="LINK"&&S.rel==="modulepreload"&&g(S)}).observe(document,{childList:!0,subtree:!0});function f(a){const h={};return a.integrity&&(h.integrity=a.integrity),a.referrerPolicy&&(h.referrerPolicy=a.referrerPolicy),a.crossOrigin==="use-credentials"?h.credentials="include":a.crossOrigin==="anonymous"?h.credentials="omit":h.credentials="same-origin",h}function g(a){if(a.ep)return;a.ep=!0;const h=f(a);fetch(a.href,h)}})();const qe={class:"card"},Ke={class:"status-header"},Ze={class:"status-box"},Qe={key:0,class:"file-list"},Xe=["onClick"],Ye={class:"file-type"},et={class:"file-path"},tt={class:"diff-content"},st=["innerHTML"],at={key:1,class:"no-diff"},lt={class:"file-navigation"},ot={class:"file-counter"};function nt(b){return b==="added"?"新增":b==="modified"?"修改":b==="deleted"?"删除":b==="untracked"?"未跟踪":"其它"}const it=ee({__name:"GitStatus",setup(b,{expose:E}){const f=o("加载中..."),g=o(!1),a=o([]),h=o(""),S=o(""),T=o(!1),O=o(!1),x=o(-1);function z(r){const u=r.split(`
`),w=[];for(const v of u){const c=v.match(/^([ MADRCU\?]{2})\s+(.+)$/);if(c){let t="";const $=c[1].trim();$==="M"||$==="MM"||$==="AM"||$==="RM"?t="modified":$==="A"||$==="AA"?t="added":$==="D"||$==="AD"||$==="DA"?t="deleted":$==="??"?t="untracked":t="other",w.push({path:c[2],type:t})}}a.value=w}async function D(){try{g.value=!0;const u=await(await fetch("/api/status")).json();f.value=u.status;const v=await(await fetch("/api/status_porcelain")).json();z(v.status),i({message:"Git 状态已刷新",type:"success"})}catch(r){f.value="加载状态失败: "+r.message,a.value=[],i({message:"刷新失败: "+r.message,type:"error"})}finally{g.value=!1}}function L(r){if(!r)return"";const u=r.split(`
`);function w(v){return v.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}return u.map(v=>{const c=w(v);return v.startsWith("diff --git")?`<div class="diff-header">${c}</div>`:v.startsWith("---")?`<div class="diff-old-file">${c}</div>`:v.startsWith("+++")?`<div class="diff-new-file">${c}</div>`:v.startsWith("@@")?`<div class="diff-hunk-header">${c}</div>`:v.startsWith("+")?`<div class="diff-added">${c}</div>`:v.startsWith("-")?`<div class="diff-removed">${c}</div>`:`<div class="diff-context">${c}</div>`}).join("")}async function R(r){try{O.value=!0,h.value=r,x.value=a.value.findIndex(v=>v.path===r);const w=await(await fetch(`/api/diff?file=${encodeURIComponent(r)}`)).json();S.value=w.diff||"没有变更",T.value=!0}catch(u){i({message:"获取文件差异失败: "+u.message,type:"error"}),S.value="获取差异失败: "+u.message}finally{O.value=!1}}async function A(){if(a.value.length===0||x.value<=0)return;const r=x.value-1,u=a.value[r];await R(u.path)}async function C(){if(a.value.length===0||x.value>=a.value.length-1)return;const r=x.value+1,u=a.value[r];await R(u.path)}function V(r){R(r.path)}async function y(){await D()}return te(()=>{D()}),E({refreshStatus:y}),(r,u)=>{const w=q,v=re,c=ye;return m(),_("div",qe,[l("div",Ke,[u[1]||(u[1]=l("h2",null,"Git 状态",-1)),s(w,{type:"primary",icon:B(je),circle:"",size:"small",onClick:y,loading:g.value},null,8,["icon","loading"])]),l("div",Ze,k(f.value),1),a.value.length?(m(),_("div",Qe,[(m(!0),_(H,null,J(a.value,t=>(m(),_("div",{key:t.path,class:Le(["file-item",t.type]),onClick:$=>V(t)},[l("span",Ye,k(nt(t.type)),1),l("span",et,k(t.path),1)],10,Xe))),128))])):G("",!0),s(v,{modelValue:T.value,"onUpdate:modelValue":u[0]||(u[0]=t=>T.value=t),title:`文件差异: ${h.value}`,width:"80%","destroy-on-close":""},{default:d(()=>[he((m(),_("div",tt,[S.value?(m(),_("div",{key:0,innerHTML:L(S.value),class:"diff-formatted"},null,8,st)):(m(),_("div",at,"该文件没有差异或是新文件"))])),[[c,O.value]]),l("div",lt,[s(w,{icon:B(Be),onClick:A,disabled:x.value<=0||a.value.length===0,circle:""},null,8,["icon","disabled"]),l("span",ot,k(x.value+1)+" / "+k(a.value.length),1),s(w,{icon:B(Oe),onClick:C,disabled:x.value>=a.value.length-1||a.value.length===0,circle:""},null,8,["icon","disabled"])])]),_:1},8,["modelValue","title"])])}}}),se=(b,E)=>{const f=b.__vccOpts||b;for(const[g,a]of E)f[g]=a;return f},rt=se(it,[["__scopeId","data-v-edcb39da"]]),ct={class:"card"},ut={class:"commit-options"},dt={class:"commit-mode-toggle"},pt={class:"no-verify-toggle"},mt={key:0,class:"commit-form"},ft={key:1,class:"standard-commit-form"},vt={class:"standard-commit-header"},gt={class:"scope-container"},ht={class:"description-container"},yt={class:"preview-section"},_t={class:"preview-content"},wt={class:"button-group"},bt={class:"template-container"},kt={class:"template-form"},Ct={class:"template-list"},$t={class:"template-content"},Vt={class:"template-actions"},St={class:"template-container"},Tt={class:"template-form"},xt={class:"template-list"},jt={class:"template-content"},Bt={class:"template-actions"},Ot=ee({__name:"CommitForm",emits:["commit-success","push-success"],setup(b,{emit:E}){const f=E,g=o(""),a=o("提交"),h=o("推送到远程"),S=o(!1),T=o(!1),O=o(!1),x=o("提交并推送"),z=o("输入提交信息..."),D=o(""),L=o(!1),R=o("feat"),A=o(""),C=o(""),V=o(""),y=o(""),r=o([]),u=o(!1),w=o(""),v=o([]),c=o(!1),t=o(""),$=o(!1),Q=[{value:"feat",label:"feat: 新功能"},{value:"fix",label:"fix: 修复bug"},{value:"docs",label:"docs: 文档修改"},{value:"style",label:"style: 样式修改"},{value:"refactor",label:"refactor: 代码重构"},{value:"test",label:"test: 测试代码"},{value:"chore",label:"chore: 构建/工具修改"}];fe(L,n=>{localStorage.setItem("zen-gitsync-standard-commit",n.toString())}),fe($,n=>{localStorage.setItem("zen-gitsync-skip-hooks",n.toString())});const W=Ne(()=>{if(!L.value)return g.value||D.value;let n=`${R.value||""}`;return A.value&&(n+=`(${A.value})`),n+=`: ${C.value}`,V.value&&(n+=`

${V.value}`),y.value&&(n+=`

${y.value}`),n});async function X(){try{const e=await(await fetch("/api/config/getConfig")).json();z.value=`输入提交信息 (默认: ${e.defaultCommitMessage})`,D.value=e.defaultCommitMessage||"",e.descriptionTemplates&&Array.isArray(e.descriptionTemplates)&&(r.value=e.descriptionTemplates),e.scopeTemplates&&Array.isArray(e.scopeTemplates)&&(v.value=e.scopeTemplates)}catch(n){console.error("加载配置失败:",n)}}async function ae(){if(!w.value.trim()){i({message:"请输入模板内容",type:"warning"});return}try{if(r.value.includes(w.value)){i({message:"该模板已存在",type:"warning"});return}r.value.push(w.value);const e=await(await fetch("/api/config/save-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:w.value,type:"description"})})).json();e.success?(i({message:"模板保存成功!",type:"success"}),w.value=""):i({message:"模板保存失败: "+e.error,type:"error"})}catch(n){i({message:"模板保存失败: "+n.message,type:"error"})}}async function K(){if(!t.value.trim()){i({message:"请输入模板内容",type:"warning"});return}try{if(v.value.includes(t.value)){i({message:"该模板已存在",type:"warning"});return}v.value.push(t.value);const e=await(await fetch("/api/config/save-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:t.value,type:"scope"})})).json();e.success?(i({message:"作用域模板保存成功!",type:"success"}),t.value=""):i({message:"作用域模板保存失败: "+e.error,type:"error"})}catch(n){i({message:"作用域模板保存失败: "+n.message,type:"error"})}}async function le(n){try{const e=r.value.indexOf(n);e!==-1&&r.value.splice(e,1);const U=await(await fetch("/api/config/delete-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:n,type:"description"})})).json();U.success?i({message:"模板删除成功!",type:"success"}):i({message:"模板删除失败: "+U.error,type:"error"})}catch(e){i({message:"模板删除失败: "+e.message,type:"error"})}}async function oe(n){try{const e=v.value.indexOf(n);e!==-1&&v.value.splice(e,1);const U=await(await fetch("/api/config/delete-template",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({template:n,type:"scope"})})).json();U.success?i({message:"作用域模板删除成功!",type:"success"}):i({message:"作用域模板删除失败: "+U.error,type:"error"})}catch(e){i({message:"作用域模板删除失败: "+e.message,type:"error"})}}function j(n){C.value=n,u.value=!1}function ke(n){A.value=n,c.value=!1}function Ce(){u.value=!0}function $e(){c.value=!0}function Ve(){const n=localStorage.getItem("zen-gitsync-standard-commit");n!==null&&(L.value=n==="true");const e=localStorage.getItem("zen-gitsync-skip-hooks");e!==null&&($.value=e==="true")}async function ce(){const n=W.value;if(!n&&L.value&&!C.value){i({message:"请输入提交描述",type:"warning"});return}try{S.value=!0,a.value="提交中...";const I=await(await fetch("/api/add",{method:"POST"})).json();if(!I.success){i({message:"添加文件失败: "+I.error,type:"error"});return}const M=await(await fetch("/api/commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n,hasNewlines:n.includes(`
`),noVerify:$.value})})).json();M.success?(L.value?(C.value="",V.value="",y.value=""):g.value="",i({message:"提交成功!",type:"success"}),f("commit-success")):i({message:"提交失败: "+M.error,type:"error"})}catch(e){i({message:"提交失败: "+e.message,type:"error"})}finally{S.value=!1,a.value="提交"}}async function Se(){try{T.value=!0,h.value="推送中...";const e=await(await fetch("/api/push",{method:"POST"})).json();e.success?(i({message:"推送成功!",type:"success"}),f("push-success")):i({message:"推送失败: "+e.error,type:"error"})}catch(n){i({message:"推送失败: "+n.message,type:"error"})}finally{T.value=!1,h.value="推送到远程"}}async function Te(){const n=W.value;if(!n&&L.value&&!C.value){i({message:"请输入提交描述",type:"warning"});return}try{O.value=!0,x.value="处理中...";const I=await(await fetch("/api/add",{method:"POST"})).json();if(!I.success){i({message:"添加文件失败: "+I.error,type:"error"});return}const M=await(await fetch("/api/commit",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:n,hasNewlines:n.includes(`
`),noVerify:$.value})})).json();if(!M.success){i({message:"提交失败: "+M.error,type:"error"});return}L.value?(C.value="",V.value="",y.value=""):g.value="";const Y=await(await fetch("/api/push",{method:"POST"})).json();Y.success?(g.value="",i({message:"提交并推送成功!",type:"success"}),f("commit-success"),f("push-success")):i({message:"推送失败: "+Y.error,type:"error"})}catch(e){i({message:"操作失败: "+e.message,type:"error"})}finally{O.value=!1,x.value="提交并推送"}}return te(()=>{X(),Ve()}),(n,e)=>{const I=Ae,U=Ee,M=_e,P=q,Y=be,xe=we,ue=Me,de=ze,pe=Pe,me=re;return m(),_("div",ct,[e[21]||(e[21]=l("h2",null,"提交更改",-1)),l("div",ut,[l("div",dt,[s(I,{modelValue:L.value,"onUpdate:modelValue":e[0]||(e[0]=p=>L.value=p),"active-text":"标准化提交","inactive-text":"普通提交"},null,8,["modelValue"])]),l("div",pt,[s(U,{content:"跳过 Git 钩子检查 (--no-verify)",placement:"top"},{default:d(()=>[s(I,{modelValue:$.value,"onUpdate:modelValue":e[1]||(e[1]=p=>$.value=p),"active-text":"跳过钩子 (--no-verify)"},null,8,["modelValue"])]),_:1})])]),L.value?(m(),_("div",ft,[l("div",vt,[s(xe,{modelValue:R.value,"onUpdate:modelValue":e[3]||(e[3]=p=>R.value=p),placeholder:"提交类型",class:"type-select",clearable:""},{default:d(()=>[(m(),_(H,null,J(Q,p=>s(Y,{key:p.value,label:p.label,value:p.value},null,8,["label","value"])),64))]),_:1},8,["modelValue"]),l("div",gt,[s(M,{modelValue:A.value,"onUpdate:modelValue":e[4]||(e[4]=p=>A.value=p),placeholder:"作用域（可选）",class:"scope-input",clearable:""},null,8,["modelValue"]),s(P,{type:"primary",icon:B(ve),circle:"",size:"small",class:"settings-button",onClick:$e},null,8,["icon"])]),l("div",ht,[s(M,{modelValue:C.value,"onUpdate:modelValue":e[5]||(e[5]=p=>C.value=p),placeholder:"简短描述（必填）",class:"description-input",clearable:""},null,8,["modelValue"]),s(P,{type:"primary",icon:B(ve),circle:"",size:"small",class:"settings-button",onClick:Ce},null,8,["icon"])])]),s(M,{modelValue:V.value,"onUpdate:modelValue":e[6]||(e[6]=p=>V.value=p),type:"textarea",rows:4,placeholder:"正文（可选）：详细描述本次提交的内容和原因",class:"body-input",clearable:""},null,8,["modelValue"]),s(M,{modelValue:y.value,"onUpdate:modelValue":e[7]||(e[7]=p=>y.value=p),placeholder:"页脚（可选）：如 Closes #123",class:"footer-input",clearable:""},null,8,["modelValue"]),l("div",yt,[e[12]||(e[12]=l("div",{class:"preview-title"},"预览：",-1)),l("pre",_t,k(W.value),1)]),s(P,{type:"primary",onClick:ce,loading:S.value},{default:d(()=>[N(k(a.value),1)]),_:1},8,["loading"])])):(m(),_("div",mt,[s(M,{modelValue:g.value,"onUpdate:modelValue":e[2]||(e[2]=p=>g.value=p),placeholder:z.value,clearable:""},null,8,["modelValue","placeholder"]),s(P,{type:"primary",onClick:ce,loading:S.value},{default:d(()=>[N(k(a.value),1)]),_:1},8,["loading"])])),l("div",wt,[s(P,{type:"success",onClick:Se,loading:T.value},{default:d(()=>[N(k(h.value),1)]),_:1},8,["loading"]),s(P,{type:"warning",onClick:Te,loading:O.value},{default:d(()=>[N(k(x.value),1)]),_:1},8,["loading"])]),s(me,{title:"简短描述模板设置",modelValue:u.value,"onUpdate:modelValue":e[9]||(e[9]=p=>u.value=p),width:"80vw",style:{height:"80vh"}},{default:d(()=>[l("div",bt,[l("div",kt,[s(M,{modelValue:w.value,"onUpdate:modelValue":e[8]||(e[8]=p=>w.value=p),placeholder:"输入新模板内容",class:"template-input",clearable:""},null,8,["modelValue"]),s(P,{type:"primary",onClick:ae,disabled:!w.value.trim()},{default:d(()=>e[13]||(e[13]=[N("添加模板")])),_:1},8,["disabled"])]),l("div",Ct,[e[16]||(e[16]=l("h3",null,"已保存模板",-1)),r.value.length===0?(m(),F(ue,{key:0,description:"暂无保存的模板"})):G("",!0),(m(!0),_(H,null,J(r.value,(p,ne)=>(m(),F(pe,{key:ne,class:"template-item"},{default:d(()=>[s(de,{justify:"space-between",align:"middle",style:{width:"100%"}},{default:d(()=>[l("div",$t,k(p),1),l("div",Vt,[s(P,{type:"primary",size:"small",onClick:ie=>j(p)},{default:d(()=>e[14]||(e[14]=[N("使用")])),_:2},1032,["onClick"]),s(P,{type:"danger",size:"small",onClick:ie=>le(p)},{default:d(()=>e[15]||(e[15]=[N("删除")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])])]),_:1},8,["modelValue"]),s(me,{title:"作用域模板设置",modelValue:c.value,"onUpdate:modelValue":e[11]||(e[11]=p=>c.value=p),width:"80%",style:{height:"80vh"}},{default:d(()=>[l("div",St,[l("div",Tt,[s(M,{modelValue:t.value,"onUpdate:modelValue":e[10]||(e[10]=p=>t.value=p),placeholder:"输入新作用域模板",class:"template-input",clearable:""},null,8,["modelValue"]),s(P,{type:"primary",onClick:K,disabled:!t.value.trim()},{default:d(()=>e[17]||(e[17]=[N("添加模板")])),_:1},8,["disabled"])]),l("div",xt,[e[20]||(e[20]=l("h3",null,"已保存作用域",-1)),v.value.length===0?(m(),F(ue,{key:0,description:"暂无保存的作用域"})):G("",!0),(m(!0),_(H,null,J(v.value,(p,ne)=>(m(),F(pe,{key:ne,class:"template-item"},{default:d(()=>[s(de,{justify:"space-between",align:"middle",style:{width:"100%"}},{default:d(()=>[l("div",jt,k(p),1),l("div",Bt,[s(P,{type:"primary",size:"small",onClick:ie=>ke(p)},{default:d(()=>e[18]||(e[18]=[N("使用")])),_:2},1032,["onClick"]),s(P,{type:"danger",size:"small",onClick:ie=>oe(p)},{default:d(()=>e[19]||(e[19]=[N("删除")])),_:2},1032,["onClick"])])]),_:2},1024)]),_:2},1024))),128))])])]),_:1},8,["modelValue"])])}}}),Lt=se(Ot,[["__scopeId","data-v-00e49634"]]),Nt={class:"card"},At={class:"log-header"},Et={class:"log-actions"},Mt={key:0},Pt={key:1},zt={key:0,class:"graph-view"},Rt={key:0,class:"commit-count"},Dt={key:1},It={key:0,class:"commit-count"},Ut={key:0,class:"branch-container"};function ge(b){return b=b.trim().replace(/^HEAD\s*->\s*/,""),b=b.replace(/^origin\//,""),b=b.replace(/^tag:\s*/,""),b.trim()}function Ft(b){return b.includes("HEAD")?"success":b.includes("tag:")?"warning":b.includes("origin/")?"info":"primary"}const Gt=ee({__name:"LogList",setup(b,{expose:E}){const f=o([]),g=o(""),a=o(!1),h=o(!1),S=o(0),T=o(!0),O=o(null);async function x(A=!1){try{a.value=!0,h.value=A;const V=await fetch(A?"/api/log?all=true&graph=true":"/api/log?graph=true");f.value=await V.json(),S.value=f.value.length,g.value="",T.value&&setTimeout(z,0)}catch(C){g.value="加载提交历史失败: "+C.message}finally{a.value=!1}}async function z(){if(!O.value||f.value.length===0)return;O.value.innerHTML="";const A=await fetch("/api/branch"),{branch:C}=await A.json(),V=Ue(O.value,{orientation:"vertical-reverse",template:"metro",author:"提交者 <committer@example.com>"}),y={},r=V.branch(C||"main");y[C||"main"]=r,f.value.forEach(u=>{let w=r;if(u.branch){const v=ge(u.branch.split(",")[0]);y[v]||(y[v]=V.branch(v)),w=y[v]}w.commit({hash:u.hash,subject:u.message,author:`${u.author} <${u.email}>`})})}function D(){T.value=!T.value,T.value&&f.value.length>0&&setTimeout(z,0)}function L(){x(!h.value)}te(()=>{x()});const R=()=>x(h.value);return E({refreshLog:R}),(A,C)=>{const V=ye;return m(),_("div",Nt,[l("div",At,[C[1]||(C[1]=l("h2",null,"提交历史",-1)),l("div",Et,[s(B(q),{type:"primary",size:"small",onClick:D},{default:d(()=>[N(k(T.value?"表格视图":"图表视图"),1)]),_:1}),s(B(q),{type:"primary",size:"small",onClick:L,loading:a.value},{default:d(()=>[N(k(h.value?"显示最近100条":"显示所有提交"),1)]),_:1},8,["loading"]),s(B(q),{icon:B(Re),circle:"",size:"small",onClick:C[0]||(C[0]=y=>R()),loading:a.value},null,8,["icon","loading"])])]),g.value?(m(),_("div",Mt,k(g.value),1)):(m(),_("div",Pt,[T.value?(m(),_("div",zt,[f.value.length>0?(m(),_("div",Rt," 显示 "+k(f.value.length)+" 条提交记录 "+k(h.value?"(全部)":"(最近100条)"),1)):G("",!0),l("div",{ref_key:"graphContainer",ref:O,class:"graph-container"},null,512)])):(m(),_("div",Dt,[f.value.length>0?(m(),_("div",It," 显示 "+k(f.value.length)+" 条提交记录 "+k(h.value?"(全部)":"(最近100条)"),1)):G("",!0),he((m(),F(B(Ie),{data:f.value,style:{width:"100%"},stripe:"",border:""},{default:d(()=>[s(B(Z),{prop:"hash",label:"提交哈希",width:"100",resizable:""}),s(B(Z),{prop:"date",label:"日期",width:"180",resizable:""}),s(B(Z),{label:"作者",width:"200",resizable:""},{default:d(y=>[N(k(y.row.author)+" <"+k(y.row.email)+"> ",1)]),_:1}),s(B(Z),{label:"分支",width:"180",resizable:""},{default:d(y=>[y.row.branch?(m(),_("div",Ut,[(m(!0),_(H,null,J(y.row.branch.split(","),(r,u)=>(m(),F(B(De),{key:u,size:"small",type:Ft(r),class:"branch-tag"},{default:d(()=>[N(k(ge(r)),1)]),_:2},1032,["type"]))),128))])):G("",!0)]),_:1}),s(B(Z),{prop:"message",label:"提交信息","min-width":"250"})]),_:1},8,["data"])),[[V,a.value]])]))]))])}}}),Ht=se(Gt,[["__scopeId","data-v-c6b721c7"]]),Jt="data:image/svg+xml,%3csvg%20width='200'%20height='200'%20viewBox='0%200%20200%20200'%20xmlns='http://www.w3.org/2000/svg'%3e%3c!--%20主分支%20--%3e%3cline%20x1='40'%20y1='40'%20x2='40'%20y2='160'%20stroke='%2334495e'%20stroke-width='8'%20stroke-linecap='round'%20/%3e%3c!--%20特性分支%20--%3e%3cpath%20d='M40,70%20C60,70%2080,90%2080,110%20L80,130'%20stroke='%233498db'%20stroke-width='8'%20stroke-linecap='round'%20stroke-linejoin='round'%20fill='none'%20/%3e%3c!--%20开发分支%20--%3e%3cpath%20d='M40,100%20C60,100%20100,110%20100,130%20L100,160'%20stroke='%232ecc71'%20stroke-width='8'%20stroke-linecap='round'%20stroke-linejoin='round'%20fill='none'%20/%3e%3c!--%20修复分支%20--%3e%3cpath%20d='M40,130%20C60,130%20120,140%20120,160'%20stroke='%23e74c3c'%20stroke-width='8'%20stroke-linecap='round'%20stroke-linejoin='round'%20fill='none'%20/%3e%3c!--%20合并点%20--%3e%3cpath%20d='M80,130%20C80,145%2060,145%2040,145'%20stroke='%233498db'%20stroke-width='8'%20stroke-linecap='round'%20stroke-linejoin='round'%20fill='none'%20/%3e%3c!--%20节点%20--%3e%3ccircle%20cx='40'%20cy='40'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='70'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='100'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='130'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='145'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='40'%20cy='160'%20r='10'%20fill='%2334495e'%20/%3e%3ccircle%20cx='80'%20cy='130'%20r='10'%20fill='%233498db'%20/%3e%3ccircle%20cx='100'%20cy='160'%20r='10'%20fill='%232ecc71'%20/%3e%3ccircle%20cx='120'%20cy='160'%20r='10'%20fill='%23e74c3c'%20/%3e%3c/svg%3e",Wt={class:"main-header"},qt={class:"header-left"},Kt=["src"],Zt={class:"header-info"},Qt={key:0,id:"user-info"},Xt={class:"user-name"},Yt={class:"user-email"},es={class:"container"},ts={class:"layout-container"},ss={class:"left-panel"},as={class:"right-panel"},ls={class:"dialog-footer"},os={class:"main-footer"},ns={key:0,class:"branch-info"},is=ee({__name:"App",setup(b){const E=o(""),f=o(null),g=o(null),a=o(""),h=o(""),S=o(""),T=o([]),O=o(!1);async function x(){try{const t=await(await fetch("/api/config/getConfig")).json();E.value=`默认提交信息: ${t.defaultCommitMessage}`}catch(c){console.error("加载配置失败:",c)}}async function z(){try{const t=await(await fetch("/api/branch")).json();t.branch&&(a.value=t.branch)}catch(c){console.error("获取分支信息失败:",c)}}async function D(){try{const t=await(await fetch("/api/branches")).json();t.branches&&Array.isArray(t.branches)&&(T.value=t.branches)}catch(c){console.error("获取所有分支信息失败:",c)}}async function L(c){console.log("切换到分支:",c);try{O.value=!0;const $=await(await fetch("/api/checkout",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({branch:c})})).json();$.success?(i({message:`已切换到分支: ${c}`,type:"success"}),z(),g.value&&g.value.refreshStatus(),f.value&&f.value.refreshLog()):(i({message:`切换分支失败: ${$.error}`,type:"error"}),a.value=a.value)}catch(t){i({message:`切换分支失败: ${t.message}`,type:"error"}),a.value=a.value}finally{O.value=!1}}async function R(){try{const t=await(await fetch("/api/user-info")).json();t.name&&t.email&&(h.value=t.name,S.value=t.email)}catch(c){console.error("获取用户信息失败:",c)}}te(()=>{x(),z(),D(),R()});function A(){f.value&&f.value.refreshLog(),g.value&&g.value.refreshStatus()}function C(){f.value&&f.value.refreshLog(),g.value&&g.value.refreshStatus(),z()}const V=o(!1),y=o(""),r=o(""),u=o(!1);async function w(){if(!y.value.trim()){i({message:"分支名称不能为空",type:"warning"});return}try{u.value=!0;const t=await(await fetch("/api/create-branch",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({newBranchName:y.value,baseBranch:r.value||a.value})})).json();t.success?(i({message:`已创建并切换到分支: ${y.value}`,type:"success"}),V.value=!1,y.value="",z(),D(),g.value&&g.value.refreshStatus(),f.value&&f.value.refreshLog()):i({message:`创建分支失败: ${t.error}`,type:"error"})}catch(c){i({message:`创建分支失败: ${c.message}`,type:"error"})}finally{u.value=!1}}function v(){r.value=a.value,V.value=!0}return(c,t)=>{const $=_e,Q=Ge,W=be,X=we,ae=Fe,K=q,le=re,oe=He;return m(),_(H,null,[l("header",Wt,[l("div",qt,[l("img",{src:B(Jt),alt:"Zen GitSync Logo",class:"logo"},null,8,Kt),t[5]||(t[5]=l("h1",null,"Zen GitSync UI",-1))]),l("div",Zt,[h.value&&S.value?(m(),_("div",Qt,[t[6]||(t[6]=l("span",{class:"user-label"},"用户:",-1)),l("span",Xt,k(h.value),1),l("span",Yt,"<"+k(S.value)+">",1)])):G("",!0)])]),l("div",es,[l("div",ts,[l("div",ss,[s(rt,{ref_key:"gitStatusRef",ref:g},null,512)]),l("div",as,[s(Lt,{onCommitSuccess:A,onPushSuccess:C}),s(Ht,{ref_key:"logListRef",ref:f},null,512)]),s(le,{modelValue:V.value,"onUpdate:modelValue":t[3]||(t[3]=j=>V.value=j),title:"创建新分支",width:"30%","destroy-on-close":""},{footer:d(()=>[l("span",ls,[s(K,{onClick:t[2]||(t[2]=j=>V.value=!1)},{default:d(()=>t[7]||(t[7]=[N("取消")])),_:1}),s(K,{type:"primary",onClick:w,loading:u.value},{default:d(()=>t[8]||(t[8]=[N(" 创建 ")])),_:1},8,["loading"])])]),default:d(()=>[s(ae,{model:{newBranchName:y.value,selectedBaseBranch:r.value}},{default:d(()=>[s(Q,{label:"新分支名称"},{default:d(()=>[s($,{modelValue:y.value,"onUpdate:modelValue":t[0]||(t[0]=j=>y.value=j),placeholder:"请输入新分支名称"},null,8,["modelValue"])]),_:1}),s(Q,{label:"基于分支"},{default:d(()=>[s(X,{modelValue:r.value,"onUpdate:modelValue":t[1]||(t[1]=j=>r.value=j),placeholder:"选择基础分支",style:{width:"100%"}},{default:d(()=>[(m(!0),_(H,null,J(T.value,j=>(m(),F(W,{key:j,label:j,value:j},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue"])])]),l("footer",os,[a.value?(m(),_("div",ns,[t[9]||(t[9]=l("span",{class:"branch-label"},"当前分支:",-1)),s(X,{modelValue:a.value,"onUpdate:modelValue":t[4]||(t[4]=j=>a.value=j),size:"small",onChange:L,loading:O.value,class:"branch-select"},{default:d(()=>[(m(!0),_(H,null,J(T.value,j=>(m(),F(W,{key:j,label:j,value:j},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"]),s(K,{type:"primary",size:"small",onClick:v,style:{"margin-left":"5px"}},{default:d(()=>[s(oe,null,{default:d(()=>[s(B(Je))]),_:1})]),_:1})])):G("",!0),t[10]||(t[10]=l("div",{class:"footer-right"},null,-1))])],64)}}}),rs=se(is,[["__scopeId","data-v-93cc73d5"]]),cs=We(rs);cs.mount("#app");
